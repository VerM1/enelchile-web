angular.module("appenel",["ionic","ngCordova","AccessModule","BillsModule","ContactModule","CoreModule","EmergencyModule","FeaturedModule","LocationsModule","ProfileModule","UsageModule","NotificationModule","AnalyticsModule","ManageAssetModule","ui.router","ngMessages","platanus.rut","chart.js","ngNotificationsBar","ngSanitize"]),angular.module("appenel").constant("translation_es",{HOME:"Inicio",LOGIN:"Ingresar",LOGIN_FACEBOOK:"Ingresar con Facebook",LOGOUT:"Cerrar Sesión",LOGOUT_DESCRIPTION:"¿Deseas cerrar tu sesión?",WELCOME:"Bienvenido",ACCEPT:"Aceptar",CANCEL:"Cancelar",NEXT:"Siguiente",CONTINUE:"Continuar",GO:"Ir",BACK:"Volver",SAVE:"Guardar",REGISTER:"Registro",CONTACT:"Contacto",THANKS:"Gracias",PROFILE:"Perfil",CURRENT:"Actual",PREVIOUS:"Anterior",PAYMENT:"Pagos",ATTENTION:"Atención",COMMUNITIES:"Comunidades",MAP:"Mapa",LIST:"Lista",ALERT:"Alerta",ALERTS:"Alertas",EMAIL:"Email",SEND:"Enviar",SEND_CODE_AGAIN:"Reenviarme el código",CONSULT:"Consultar",SEE_MORE:"Ver Más",CLOSE:"Cerrar",ADD:"Añadir",HELP:"Ayuda",DATE:"Fecha",TYPE:"Tipo",DOWNLOAD:"Descargar",INFO:"Información",ADDRESS:"Dirección",RETRY:"Reintentar",SUCCESS:"Éxito",ERROR:"Error",INFO:"Información",DAY:"Día",NIGHT:"Noche",PEAK:"Punta",PUSH:"Presionar",DEBT:"Deuda",FINISH:"Finalizar",PHONE_PRIMARY:"Teléfono Primario",PHONE_SECONDARY:"Teléfono Secundario",LOGIN_VIRTUAL_BRANCH:"Acceder a sucursal virtual",REGISTER_VIRTUAL_BRANCH:"Registrarse",KWH:"kWh",NO_INTERNET_CONNECTION:"Sin conexión a Internet. Verifica tu equipo e intenta nuevamente.",TIMEOUT_ERROR:"En estos momentos no es posible procesar la solicitud, por favor inténtalo más tarde.",VERSION_APP:"1.0.0",CHANGE_VERSION:"Actualización disponible",MSG_CHANGE_VERSION_1:"Hay una nueva versión en el Store.",MSG_CHANGE_VERSION_2:"Recomendamos actualizar.",GO_STORE:"Ir a la Tienda",LABEL_NUM_CLIENT:"Ingresar N° de cliente",PLACEHOLDER_NUM_CLIENT:"Ej. 33663355-K",SEARCH_NUM_CLIENT:"Buscar N° cliente",CHECK_OR_PAY_ACCOUNT:"Pagar cuenta",REPORT_COURT:"Reportar corte",WITHOUT_LIGHT:"Reportar corte de luz",GET_DEBT:"Obtener deuda",PAYMENT_STATUS:"Estado del Pago",FORGOT_PASS:"Olvidé mi contraseña",LOGOUT_PROCEED:"Se procederá a cerrar la sesión",SEE_YOU_SOON:"Hasta pronto",THANKS_YOR_VISITING_US:"Gracias por visitarnos",CREATE_ACCOUNT:"Crear Cuenta",LABEL_RUT:"Ingresar Rut",LABEL_NAME:"Ingresar Nombre",LABEL_NAMES:"Ingresar Nombres",LABEL_LASTNAME:"Ingresar Apellido Paterno",LABEL_MOTHER_LASTNAME:"Ingresar Apellido Materno",LABEL_LASTNAMES:"Ingresar Apellidos",LABEL_PHONE:"Ingresar Teléfono Principal",LABEL_CELLPHONE:"Ingresar Teléfono Secundario",LABEL_EMAIL:"Ingresar Email",LABEL_ALIAS:"Ingresar Alias",LABEL_ALIAS_ASSET:"Ingresar Alias Suministro",LABEL_NUM_LAST_SERVICE:"Ingresar N° de última boleta emitida",LABEL_PASSWORD:"Ingresar Contraseña",LABEL_PASSWORD_CONFIRM:"Favor confirmar contraseña",LABEL_RELATIONSHIP_WITH_ASSET:"Relación con el suministro",PLACEHOLDER_SELECT:"Seleccionar",PLACEHOLDER_RUT:"Ej: 12345678-9",PLACEHOLDER_NAME:"Nombre",PLACEHOLDER_NAMES:"Nombres",PLACEHOLDER_LASTNAME:"Apellido Paterno",PLACEHOLDER_MOTHER_LASTNAME:"Apellido Materno",PLACEHOLDER_LASTNAMES:"Apellidos",PLACEHOLDER_PHONE:"Ej: 912345678",PLACEHOLDER_CELLPHONE:"Ej: 287654321",PLACEHOLDER_EMAIL:"Ej: usuario@correo.com",PLACEHOLDER_ALIAS:"Alias",PLACEHOLDER_ALIAS_ASSET:"Alias Suministro",PLACEHOLDER_NUM_LAST_SERVICE:"Ej: 1234567890",PLACEHOLDER_PASSWORD:"Contraseña",PLACEHOLDER_PASSWORD_CONFIRM:"Confirmar contraseña",PLACEHOLDER_RELATIONSHIP_WITH_ASSET:"Propietario o Arrendatario",ACCEPT_TERMS:"Acepto términos y condiciones",REQUIRED_FORM_TEXT:"(*) Estos campos son obligatorios",VALIDATION:"Validación",VALIDATE_USER:"Validación de Usuario",VALIDATE_ACCOUNT:"Validar Cuenta",ACTIVATE_ACCOUNT:"Activar Cuenta",LABEL_INSERT_CODE:"Ingresar código",PLACEHOLDER_INSERT_CODE:"Código",LABEL_DESCRIBE_INSERT_CODE:"En unos instantes llegará a tu correo electrónico un código de validación, por favor ingrésalo",VERIFICATION:"Verificación",PASSWORD_RECOVERY:"Recuperar Clave",RECOVERY_PASS_TEXT:"Para recuperar tu clave, primero debes validar tu cuenta con un código de seguridad, luego podrás cambiar tu clave.",SEND_ME_CODE:"Recuperar clave",GENERATE_NEW_CODE:"Generar un nuevo código",LABEL_ENTER_USER:"Ingresar usuario (rut)",LABEL_ENTER_CODE:"Ingresar código",PLACEHOLDER_ENTER_USER:"Usuario",PLACEHOLDER_ENTER_CODE:"Código",VALIDATE_CODE:"Validar código",VERIFICATION_PASS:"Pasar Verificación",MY_CURRENT_PASS:"Mi contraseña actual",CHANGE_YOUR_PASS:"Cambiar clave",LABEL_ENTER_NEW_PASS:"Ingresar nueva clave",LABEL_REPEAT_NEW_PASS:"Repetir nueva clave",PLACEHOLDER_ENTER_NEW_PASS:"Nueva clave",PLACEHOLDER_REPEAT_NEW_PASS:"Repetir nueva clave",REGENERATE_CODE:"Regenerar Código",OVERVIEW:"Resumen",USAGE:"Consumo",USAGES:"Consumos",BILLS:"Boletas",PAYMENTS:"Pagos",PAY_ACCOUNT:"Pagar cuenta",SEND_READING:"Enviar lectura",OUTSTADING_DEBT:"Deuda Vigente",EXPIRATION:"Vencimiento",RATE:"Tarifa",TYPE_USAGE:"Tipo consumo",CUTOFF_DATE:"Fecha de Corte",LAST_PAYMENT_AMOUNT:"Monto último pago",LAST_PAYMENT_DATE:"Fecha último pago",NEXT_READING_DATE:"Fecha próxima lectura",ACTUAL_READING:"Lectura actual",USAGE_MONTH:"Consumo mes",GET_ASSETS_LIST:"Obtener listado de suministros",GET_ASSET_DETAIL:"Obtener detalle suministro",GET_USAGES_LIST:"Obtener listado histórico de consumos",GET_BILLS_LIST:"Obtener listado histórico de boletas",GET_PAYMENTS_LIST:"Obtener listado histórico de pagos",DOWNLOAD_BILL:"Descargar Boleta",PAY_BILL:"Pagar boleta",SEND_ELECTRONIC_DOCUMENT:"Envío de documento electrónico",SUBSCRIBE:"Suscribirse",SUBSCRIBE_TEXT:"Presione aquí para suscribirse a envio de documento electronico",SEND_READING_TEXT:"Presione aquí para enviar su lectura",SEND_ELECTRONIC_DOC_CONDITIONS:"Ver condiciones",ENTER_READING:"Ingresar Lectura",ENTER_READING_DISCLAIMER:"Si nuestro lector no pudo realizar el registro de tu medidor por problemas de acceso al equipo de medida, podrás ingresar la lectura de tu medidor hasta las 12 horas del día siguiente a la fecha de entregar el servicio.",LABEL_ENTER_READING:"Ingresar Lectura",LABEL_READING:"Lectura",LABEL_READING_DAY:"Ingresar lectura día",LABEL_READING_NIGHT:"Ingresar lectura noche",LABEL_READING_PEAK:"Ingresar lectura punta",PLACEHOLDER_ENTER_READING:"Ingresar lectura",PLACEHOLDER_READING:"Lectura",PLACEHOLDER_READING_DAY:"Consumo día",PLACEHOLDER_READING_NIGHT:"Consumo noche",PLACEHOLDER_READING_PEAK:"Consumo punta",READING:"Lectura",READING_DAY:"Consumo día",READING_NIGHT:"Consumo noche",READING_PEAK:"Consumo punta",PAY_ACCOUNT_DISCLAIMER:"Una vez realizado el pago, enviaremos un comprobante de tu transacción al correo electrónico indicado.",PAY_YOUR_BILL:"Paga tu cuenta",PAY:"Pagar",TYPE_OF_DEBT:"Tipo de Deuda",AMOUNT:"Monto",PREVIOUS_DEBT:"Deuda Anterior",LAST_BILL:"Última Boleta Emitida",PAYMENTTYPE_1:"Deuda Vigente",PAYMENTTYPE_2:"Último Documento",PAYMENTTYPE_3:"Documento Anterior",PAYMENT_VOUCHER:"Comprobante de Pago",DEAR_USER:"Estimado usuario",TRANSACTION_ID:"Número de Transacción",PAYMENT_CHANNEL:"Canal de Pago",PAYMENT_SUCCESS_CONFIRMATION_TEXT:"Confirmamos la realización del pago electrónico",PAYMENT_SUCCESS_KEPT_BILL:"Recomendamos conservar una copia de este comprobante",PAYMENT_SUCCESS_ALL_CHANNELS_TEXT:"Ponemos todos los canales de atención a su disposición",LABEL_PAYMENT_NUM_CLIENT:"N° de cliente",LABEL_PAYMENT_MESSAGE:"Observaciones",INCOMPLETE_PAYMENT:"En estos momentos no es posible procesar la solicitud, por favor inténtalo más tarde.",PAYMENT_IN_PROGRESS:"El suministro presenta un pago en proceso",GENERATE_XML_PAYMENT:"Generar XML de Pago",GENERATE_TEMPLATE_BILL:"Generar Plantilla de Pago",EMERGENCIES:"Emergencias",BLACKOUT:"Corte de Luz",BLACKOUT_DESCRIPTION:"Para informar si en tu domicilio o barrio están sin luz, presiona aquí.",BLACKOUT_DISCLAIMER:"En caso de que la falla sea en la instalación interior, la visita de los técnicos de emergencia podría tener un costo asociado.",LIGHTING_PROBLEMS:"Alumbrado público",LIGHTING_PROBLEMS_DESCRIPTION:"Si deseas reportar algúna anormalidad de alumnado público de tu barrio (por ejemplo, una o más luminarias apagadas) presiona aquí.",LIGHTING_PROBLEMS_DISCLAIMER:"Si tu comuna no aparezca en la lista disponible, debes reportar el problema de alumbrado directamente al municipio.",RISK_OR_ACCIDENT:"Riesgo o Accidente",RISK_OR_ACCIDENT_DESCRIPTION:"Para reportar situaciones riesgo eléctico como: domicilio electrizado, cables cortados, poste chocado o inclinado. Presiona aquí.",RISK_OR_ACCIDENT_DISCLAIMER:"En caso de que la falla sea en la instalación interior, la visita de los técnicos de emergencia podría tener un costo asociado.",REPORT_EMERGENCY:"Reportar Emergencia",GET_STATES:"Obtener listado de comunas",GET_GEO_ADDRESS_SERVICES:"Obtener servicio de dirección por geolocalización",BLACKOUT_TYPE_PROBLEM_LABEL_1:"Sin Luz - Mi barrio (mi domicilio y el de mis vecinos)",BLACKOUT_TYPE_PROBLEM_LABEL_2:"Sin Luz - Solo mi domicilio",LABEL_DESCRIBE_THE_INCIDENT:"Observaciones",PLACEHOLDER_DESCRIBE_THE_INCIDENT:"Ingresar observaciones...",LABEL_TYPE_OF_PROBLEM:"Tipo de anormalidad",LABEL_STREET:"Calle",LABEL_NUMBER:"Número",LABEL_DEPARTAMENT:"Departamento",LABEL_STATE:"Comuna",PLACEHOLDER_TYPE_OF_PROBLEM:"Tipo de anormalidad",PLACEHOLDER_STREET:"Calle",PLACEHOLDER_NUMBER:"Número",PLACEHOLDER_DEPARTAMENT:"Departamento",PLACEHOLDER_STATE:"Comuna",GET_LIGHTING_PROBLEMS_LIST:"Obtener listado de problemas de alumbrado",GET_ACCIDENT_RISK_LIST:"Obtener listado de riesgo y accidentes",SET_LIGHTING_PROBLEMS:"Enviar formulario de problemas alumbrado público",SET_ACCIDENT_RISK:"Enviar formulario de riesgo y accidentes",CONTACT:"Contacto",INFORMATION_SERVICES:"Fonoservicio",INFORMATION_SERVICES_DESCRIPTION:"Nuestro servicio de atención telefónica 24x7, para contactarnos presiona llamar.",CALL:"Llamar",CONTACT_FORM:"Formulario de contacto",CONTACT_FORM_DESCRIPTION:"Atención escrita a un click.",WRITE_US:"Contactar",NEARBY_BRANCHES:"Sucursales y lugares de pago",NEARBY_BRANCHES_DESCRIPTION:"Si desea acceder a la información de nuestras sucursales y lugares donde puedes pagar tu cuenta.",SEE_LOCATION:"Ver información",LABEL_TOPIC:"Seleccionar asunto",PLACEHOLDER_TOPIC:"Asunto",LABEL_MESSAGE:"Ingresar mensaje",PLACEHOLDER_MESSAGE:"Mensaje...",SET_CONTACT_FORM:"Envío formulario de contacto",GET_SUBJECT_LIST:"Obtener listado de tipos de contacto",BRANCHES:"Sucursales",GET_BRANCHES:"Obtener Sucursales",SERVICE_CENTERS:"Centros de Servicios",POINTS_OF_ATTENTION_AND_PAYMENT:"Puntos de Atención y Pagos",PLACES_OF_PAYMENT:"Lugares de Pago",SEARCH_PLACE:"Buscar...",ALSO_PAY_IN:"También paga en",OTHER_MEANS_OF_PAYMENT:"Otros medios de Pago",COMMERCIAL_ATTENTION:"Atención Comercial",MAP_WITH_GPS:"Mapa con Geolocalización",PAYMENT_HOURS:"Horarios de Pago",OPENING_HOURS:"Horarios de Apertura",SPECIAL_HOURS:"Horarios Especiales",ERROR_FIND_GEOCODE:"No fue posible encontrar la ubicacion por la siguiente razón: ",MUST_NOT_EMPTY:"El campo no puede estar vacio",PAYMENT_OPTIONS_01_BRAND:"Sitio web www.eneldistribucion.cl",PAYMENT_OPTIONS_01_TEXT:"Donde podrás pagar desde botones bancarios o con tarjetas de crédito/débito mediante WebPay.",PAYMENT_OPTIONS_02_BRAND:"Pago",PAYMENT_OPTIONS_02_TEXT:"Enviando por nuestras redes sociales #pago podrás pagar en sencillos pasos.",PAYMENT_OPTIONS_03_BRAND:"Portales de pago",PAYMENT_OPTIONS_03_TEXT:"Accediendo a los portales bancarios y de pago de cuentas.",PAYMENT_OPTIONS_04_BRAND:"Pago automático",PAYMENT_OPTIONS_04_TEXT:"Con pago automático PAC o PAT Tarjetas de crédito bancarias (Transbank).",PAYMENT_OPTIONS_05_BRAND:"Pago presencial",PAYMENT_OPTIONS_05_TEXT:"A través de nuestra red de recaudadores o En todas nuestras Oficinas Comerciales.",ACTIVATE_NOTIFICATIONS:"Activar Notificaciones",ALIAS_EDITION:"Editar Alias",EDIT_ALIAS:"Editar Alias",NEW_ALIAS_EDITION_PLACEHOLDER:"Ingresar nuevo alias para el suministro",UPDATE_PROFILE:"Actualizar Perfil",ADD_ASSET:"Añadir suministro",GET_RELATIONSHIP_WITH_ASSET:"Obtener relación con suministro",RELATIONSHIP_WITH_ASSET_LABEL_1:"Propietario",RELATIONSHIP_WITH_ASSET_LABEL_2:"Arrendatario",NOTIFICATIONS:"Notificaciones",ASK_DELETE_NOTIFICATION:"¿Desea eliminar esta notificación?",SWIPE_TO_UPDATE:"Deslice para actualizar",UPDATING_NOTIFICATIONS:"Actualizando notificaciones",GET_NOTIFICATION_LIST:"Obtener listado de Notificaciones",DELETE_NOTIFICATION:"Eliminar Notificación",MARK_AS_READ_NOTIFICATION:"Marcar notificación como leído",NO_DATA_NOTIFICATION:"No existen notificaciones para mostrar",FEATURED:"Destacados",GET_FEATURED_LIST:"Obtener listado de destacados",ERROR_FEATURED_DETAIL:"Error al obtener detalle destacado",TUTORIAL_01_TEXT:" A un click, podrás reportar un corte de luz o pagar tu cuenta.",TUTORIAL_02_TEXT:"Con tu usuario y contraseña, tendrás acceso al detalle de tus cuentas, consumos de energía y pagos.",TUTORIAL_03_TEXT:"Te notificaremos cuando tengas una nueva boleta disponible, o cuando haya algún hecho que afecte tu suministro.",TUTORIAL_04_TEXT:"Tendrás acceso a datos de contacto con la compañía, tales como sucursales.",TUTORIAL_05_TEXT:"Y podrás ver información destacada que la compañía tiene para ti.",KNOW_YOUR_PRODUCTS:"Conoce los productos que tienes asociados a tu cuenta",SKIP_INTRO:"Saltar Intro",EASY_ACCESS_APP_TEXT:"Accede facilmente a lo más importante de la aplicación",KNOW_CUSTOMER_SERVICE_TEXT:"Podrás conocer los puntos de pagos más cercanos a ti",BRANCH_OFFICES_INFORMATION_TEXT:"Y saber información de las sucursales",SELECT_APP:"Seleccionar aplicación",SELECT_APP_TEXT:"Selecciona una aplicación para dirigirte al punto seleccionado.",NAMEAPP_001:"Google Maps",NAMEAPP_002:"Waze",ELECTRIC_LIGHTING:"Alumbrado",EMERGENCY:"Emergencia",ELECTRIC_LIGHTING_TITLE:"Declarar alerta",ERROR:"Error",SERVICES_ERROR:"En estos momentos no es posible procesar la solicitud, por favor inténtalo más tarde.",OTHER_ERROR:"No fue posible procesar la solicitud, por favor intenta más tarde.",NO_DATA:"No hay datos",NO_ACTIVE_DEBT:"El suministro no tiene una deuda activa",SEARCH_USER_ERROR:"Error al buscar usuario. Verifica e intenta nuevamente.",NOT_POSSIBLE_GET_USER:"No es posible obtener el usuario",NOT_POSSIBLE_GET_USER_ID:"No es posible obtener el ID del usuario",NOT_POSSIBLE_GET_USER_RUT:"No es posible obtener el RUT del usuario",NOT_POSSIBLE_FIND_OBJECT:"No es posible encontrar el objeto",LOREM_IPSUM_TEXT:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.",VALIDATION_REQUIRED:"Este campo es requerido",VALIDATION_MIN_LENGTH:"El campo ingresado es demasiado corto",VALIDATION_MAX_LENGTH:"El campo ingresado es demasiado largo",VALIDATION_EMAIL:"Formato de email incorrecto",VALIDATION_NUMBER:"Ingresar sólo números",VALIDATION_RUT:"Formato del campo no es válido",VALIDATION_PASS_MATCH:"Las contraseñas no coinciden",VALIDATION_TWO_NUMBERS:"Debe tener al menos dos números",VALIDATION_START_NUMBERS:"Debe comenzar con un número",VALIDATION_PASSWORD_FORMAT:"Debe tener números, letras mayúsculas y minúsculas",LOADING:"Cargando...",ERROR_MODAL_TITLE:"Error",ATTENTION_MODAL_TITLE:"Atención",HELPER_MODAL_TITLE:"Ayuda",INFO_MODAL_TITLE:"Información",VALIDATION_MODAL_TITLE:"Validación",SUCCESS_MODAL_TITLE:"Éxito",ADD_ASSET_MODAL_TITLE:"Añadir suministro",SUCCESS_CASE_ENTERED_WITH_NUMBER:"Su caso ha sido ingresado con el número ",ERROR_CASE_ENTERED_WITH_NUMBER:"Su caso no ha podido ser ingresado.",SUCCESS_PROFILE_CHANGE:"Su perfil ha sido modificado correctamente",ERROR_VALIDATION_CODE:"Su código es incorrecto.",ERROR_RUT:"Rut incorrecto",SUCCESS_CODE_SENT:"Un código de validación ha sido enviado a su correo electrónico",SUCCESS_USER_VALIDATED:"Su cuenta ha sido validada. Ya puede ingresar a la aplicación",YOUR_READING_CODE_IS:"El código de su lectura es el ",SUCCESS_CONTACT_ENTERED_WITH_NUMBER:"Su contacto ha sido ingresado con el numero",ERROR_CONTACT_ENTERED_WITH_NUMBER:"Su contacto no ha podido ser ingresado",ADD_ASSETS_CONDITIONS_TEXT_01:"1. Este servicio reemplaza el envío físico de la boleta y el despacho por correo postal de todas las comunicaciones relacionadas con el servicio.",ADD_ASSETS_CONDITIONS_TEXT_02:"2. Este servicio reemplaza la actual notificación de nueva boleta disponible por correo electrónico.",ADD_ASSETS_CONDITIONS_TEXT_03:"3. La desactivación del envío electrónico o modificación del destinatario se podrá realizar en cualquier momento, contactando a Enel por medio de sus canales de atención, sin requisito adicional. Puedes ver nuestros canales ",ADD_ASSETS_CONDITIONS_TEXT_04:"4. Una vez suscrito al envío de boleta electrónica, a contar de la emisión de tu próxima boleta (o subsiguiente según tu sector de facturación), ésta te llegará por email, indicando que se encuentra bajo la modalidad electrónica.",ADD_ASSETS_CONDITIONS_TEXT_05:"5. Este servicio está disponible para el propietario o arrendatario de la propiedad donde se encuentre el suministro. La persona que suscribe el envío electrónico de boleta, ya sea propietario o arrendatario, asume la responsabilidad de que la información entregada es fidedigna.&nbsp;",ADD_ASSETS_CONDITIONS_TEXT_06:"6. Como método de validación, se exige durante el proceso de registro el correlativo de la última boleta emitida.",ADD_ASSETS_CONDITIONS_TEXT_07:"7. Si quien suscribe el envío electrónico es arrendatario, deberá indicar como correo adicional la dirección de correo electrónico del propietario del suministro, a quien se le dará aviso de dicha suscripción y se le enviará simultáneamente todos los meses, una copia de la boleta. El arrendatario es el responsable de que esta información sea fidedigna.",ADD_ASSETS_CONDITIONS_TEXT_08:"8. El propietario del suministro tendrá la facultad de restringir/inhibir la suscripción de envío electrónico de boleta. Esta acción bloquea el que alguien pueda suscribir el envío electrónico.",FACEBOOK_TITLE:"Facebook",FACEBOOK_TEXT:"Estamos donde tú estás",FACEBOOK_BUTTON:"Ir a Enel Chile",TWITTER_TITLE:"Twitter",TWITTER_TEXT:"Información de Incidencias y atención en línea, las 24 horas al dia",TWITTER_BUTTON:"Acceder a @EnelClientesCL",WITH_SESSION:"Autenticado",WITHOUT_SESSION:"Sin autenticación",HEADER:"Header",FOOTER:"Footer",PAGE_HOME:"Página Inicio",PAGE_LOGIN:"Página Login",PAGE_REGISTER:"Página Registro",PAGE_EMERGENCY:"Página Menú Emergencia",PAGE_BLACKOUT:"Página Corte de Luz",PAGE_PRE_BLACKOUT:"Página Pre-Corte de luz",PAGE_ACCIDENT_RISK:"Página Riesgo o Accidente",PAGE_LIGHTING_PROBLEMS:"Página Problemas de Alumbrado Público",PAGE_CONTACT:"Página Menú Contacto",PAGE_CONTACT_FORM:"Página Formulario de Contacto",PAGE_BRANCHES:"Página Sucursales",PAGE_BRANCHES_LIST:"Página Listado Sucursales",PAGE_BRANCHES_MAP:"Página Mapa Sucursales",PAGE_BRANCHES_DESCRIPTION:"Página Detalle Sucursales",PAGE_BRANCHES_PAYMENT_OPTIONS:"Página Otros Medios de Pago",PAGE_FEATURED:"Página Destacados",PAGE_FEATURED_DESCRIPTION:"Página Detalle Destacado",PAGE_VALIDATION:"Página Validacion",PAGE_VERIFICATION:"Página Verificación",PAGE_VERIFICATION_PASS:"Página Paso Verificación",PAGE_PAYMENT:"Página Pago",PAGE_ENTER_READING:"Página Ingreso Lectura",PAGE_PROFILE:"Página de Perfil",PAGE_NOTIFICATION:"Página de Notificaciones",PAGE_USAGE:"Página Resumen",PAGE_SEND_ELECTRONIC_DOCUMENT:"Página Envío Documento Electrónico",GA_SWIPE_LEFT:"Swipe Left",GA_SWIPE_RIGHT:"Swipe Right",GA_SWIPE_UP:"Swipe Up",GA_SWIPE_DOWN:"Swipe Down",GA_ROTATION_LEFT:"Rotación hacia la izquierda",GA_ROTATION_RIGHT:"Rotación hacia la derecha",GA_PUSH_FOOTER:"Presiona Footer",GA_PUSH_HEADER:"Presiona Header",GA_PUSH_PROFILE_ICON:"Presiona ícono de Perfil",GA_PUSH_LOGO_ICON:"Presiona ícono de Logo",GA_PUSH_HOME:"Presionar Inicio",GA_PUSH_REGISTER:"Presionar Registro",GA_PUSH_LOGIN:"Presionar Login",GA_PUSH_EMERGENCY:"Presionar Emergencia",GA_PUSH_BLACKOUT:"Presionar Corte de Luz",GA_PUSH_ACCIDENT_RISK:"Presionar Riesgo o Accidente",GA_PUSH_LIGHTING_PROBLEMS:"Presionar Alumbrado Público",GA_PUSH_CONTACT:"Presionar Contacto",GA_PUSH_MAKE_CALL:"Presionar Realizar Llamada",GA_PUSH_CONTACT_FORM:"Presionar Formulario Contacto",GA_PUSH_BRANCHES:"Presionar Sucursales",GA_PUSH_FEATURED:"Presionar Destacados",GA_PUSH_PROFILE:"Presionar Perfil",GA_PUSH_USAGE:"Presionar Resumen",GA_PUSH_NOTIFICATIONS:"Presionar Notificaciones",GA_STEP_01:"Paso uno",GA_STEP_02:"Paso dos",GA_PUSH_BACK_BUTTON:"Presionar botón volver",GA_SKIP_INTRO:"Saltar Intro",GA_TUTORIAL_SLIDE:"Tutorial Splash",GA_TUTORIAL_SLIDE_1:"Tutorial Splash 1",GA_TUTORIAL_SLIDE_2:"Tutorial Splash 2",GA_TUTORIAL_SLIDE_3:"Tutorial Splash 3",GA_TUTORIAL_SLIDE_4:"Tutorial Splash 4",GA_TUTORIAL_SLIDE_5:"Tutorial Splash 5",GA_TUTORIAL_SLIDE_6:"Tutorial Splash 6",GA_WRITE_CLIENT_NUMBER:"Escribir número de cliente",GA_PUSH_BLACKOUT_REPORT:"Presionar Reportar Corte de Luz",GA_PUSH_SEARCH_CLIENT:"Presionar Buscar Cliente",GA_PUSH_HELP_CLIENT_NUMBER:"Presionar Ayuda Número de Cliente",GA_PUSH_PASSWORD_RECOVERY:"Presionar Olvide mi Contraseña",GA_PUSH_ENTER:"Presionar Ingresar",GA_WRITE_USER_ID:"Presionar ingresar rut",GA_WRITE_PASSWORD:"Presionar ingresar contraseña",GA_WRITE_RUT:"Escribir RUT",GA_WRITE_NAMES:"Escribir nombres",GA_WRITE_LASTNAMES:"Escribir apellidos",GA_WRITE_LASTNAME:"Escribir apellido paterno",GA_WRITE_MOTHER_LASTNAME:"Escribir apellido materno",GA_WRITE_PHONE:"Escribir teléfono primario",GA_WRITE_CELLPHONE:"Escribir teléfono secundario",GA_WRITE_EMAIL:"Escribir email",GA_WRITE_NUM_CLIENT:"Escribir número cliente",GA_WRITE_NUM_LAST_SERVICE:"Escribir última boleta",GA_WRITE_PASSWORD:"Escribir contraseña",GA_WRITE_CONFIRM_PASSWORD:"Escribir confirmación contraseña",GA_PUSH_CREATE_ACCOUNT:"Presionar crear cuenta",GA_WRITE_INSERT_CODE:"Escribir insertar código",GA_PUSH_REGENERATE_CODE:"Presionar regenerar código",GA_PUSH_VALIDATE_USER:"Presionar validar usuario",GA_PUSH_SEND_CODE:"Presionar envío de código",GA_PUSH_CHANGE_YOUR_PASS:"Presionar cambiar tu clave",GA_WRITE_CODE:"Escribir código",GA_WRITE_NEW_PASS:"Escribir nueva contraseña",GA_WRITE_REPEAT_NEW_PASS:"Escribir repetir nueva contraseña",GA_PUSH_PAY_BILL:"Presionar pagar cuenta",GA_PUSH_OPEN_EXTERNAL_BRANCHES:"Presionar abrir sucursal/cajero externamente",GA_PUSH_OPEN_MAP:"Presionar abrir mapa",GA_PUSH_OPEN_LIST:"Presionar abrir lista sucursales",GA_PUSH_VIEW_DESCRIPTION:"Presionar ver detalle sucursal",GA_PUSH_BRANCHES:"Presionar sucursales",GA_PUSH_PLACES_OF_PAYMENT:"Presionar lugares de pagos",GA_PUSH_OTHER_MEANS_OF_PAYMENT:"Presionar otros medios de pago",GA_PUSH_SEARCH_BRANCHES:"Presionar buscar sucursal",GA_PUSH_WRITE_BRANCHES_ADDRESS:"Escribir dirección sucursal",GA_PUSH_MARKER:"Presionar marcador de mapa",GA_SELECT_TOPIC:"Seleccionar tópico",GA_WRITE_REQUIREMENT_DETAIL:"Escribir detalle del requerimiento",GA_PUSH_SEND_FORM:"Presionar enviar formulario",GA_PUSH_TELEPHONE_ATTENTION:"Presionar atención telefónica",GA_PUSH_CONTACT_FORM:"Presionar formulario de contacto",GA_PUSH_OPEN_EXTERNAL_LINKS:"Presionar abrir enlace externo",GA_SELECT_TYPE_OF_PROBLEM:"Seleccionar tipo de problema",GA_WRITE_STREET:"Escribir calle",GA_WRITE_NUMBER:"Escribir número",GA_WRITE_DEPARTAMENT:"Escribir departamento",GA_SELECT_STATE:"Seleccionar comuna",GA_WRITE_DESCRIBE_THE_INCIDENT:"Escribir descripción de incidencia",GA_SELECT_TYPE_OF_INCIDENT:"Seleccionar tipo de incidencia",GA_PUSH_OPEN_EXTERNAL_FEATURED:"Presionar abrir destacados externamente",GA_SELECT_RELATIONSHIP_WITH_OWNER:"Seleccionar relación con el propietario",GA_WRITE_SECONDARY_EMAIL:"Escribir email secundario",GA_PUSH_OPEN_CONDITIONS:"Presionar abrir condiciones",GA_PUSH_OPEN_NOTIFICATION:"Presionar abrir notificación",GA_PUSH_DELETE_NOTIFICATION:"Presionar eliminar notificación",GA_PUSH_MARK_AS_READ_NOTIFICATION:"Presionar marcar notificación como leida",PAGE_USAGE_OVERVIEW:"Pestaña Resumen",PAGE_USAGE_USAGES:"Pestaña Histórico de Consumos",PAGE_USAGE_BILLS:"Pestaña Histórico de Boletas",PAGE_USAGE_PAYMENTS:"Pestaña Histórico de Pagos",GA_PUSH_PAGE_USAGE_OVERVIEW:"Presionar pestaña Resumen",GA_PUSH_PAGE_USAGE_USAGES:"Presionar pestaña Histórico de Consumos",GA_PUSH_PAGE_USAGE_BILLS:"Presionar pestaña Histórico de Boletas",GA_PUSH_PAGE_USAGE_PAYMENTS:"Presionar pestaña Histórico de Pagos",GA_PUSH_INSERT_READING:"Presionar ingresar lectura",GA_PUSH_SEND_ELECTRONIC_DOCUMENT:"Presionar envío documento electronico",GA_PUSH_DOWNLOAD_BILL_DOCUMENT:"Presionar descargar boleta documento",GA_PUSH_RETRY_GET_DETAIL_ASSET:"Presionar reintentar obtener detalle suministro",GA_PUSH_RETRY_GET_DEBT_ASSET:"Presionar reintentar obtener DEUDA suministro",GA_WRITE_READING:"Escribir Lectura BT1",GA_WRITE_READING_DAY:"Escribir Lectura Dia",GA_WRITE_READING_NIGHT:"Escribir Lectura Noche",GA_WRITE_READING_PEAK:"Escribir Lectura Punta",GA_PUSH_SEND_READING:"Presionar Envío Lectura",GA_SELECT_RELATIONSHIP_WITH_ASSET:"Seleccionar relación con el suministro",GA_PUSH_SAVE_USER_DATA:"Presionar guardar datos de usuario",GA_PUSH_ADD_ASSET:"Presionar añadir suministro",GA_SUCCESS_SERVICES_RESPONSE:"Respuesta Servicio OK",GA_ERROR_SERVICES_RESPONSE:"Error en Respuesta Servicio",GA_ERROR_NO_DATA:"No hay datos"}),angular.module("UsageModule",["CoreModule","ngRoute"]),angular.module("UsageModule").factory("UsageService",["$q","ConnectionProvider","SalesforceProvider","LocalStorageProvider","$log","ENDPOINTS","AccessService","UTILS_CONFIG",function(e,a,t,o,n,s,r,i){return pub={},pub.getAssetList=function(){var a=e.defer();if(o.getLocalStorageItem("asset_list"))a.resolve(o.getLocalStorageItem("asset_list")),o.setLocalStorageItem("asset_list_is_new_request","false");else{var r={};r.path=s.ENDPOINTS_ASSESTS_LIST,r.method="GET",r.contentType="application/json",r.params={},r.data="",t.request(r).then(function(e){if("200"==e.code.toString()){n.debug("getAssetList ",e.data);var t=[];null!=e.data&&e.data.length>0&&angular.forEach(e.data,function(e,a){n.debug(a+" : ",e);var o={};o.index=a,o.direccion=e.direccion.direccion,e.direccion.comuna&&null!=e.direccion.comuna&&""!=e.direccion.comuna&&(o.direccion=o.direccion+" "+e.direccion.comuna,o.comuna=e.direccion.comuna),o.numeroSuministro=e.numeroSuministro,o.numeroSuministroDv=e.numeroSuministro+"-"+e.digitoVerificador,t.push(o)}),o.setLocalStorageItem("asset_list",t),o.setLocalStorageItem("asset_list_is_new_request","true");var s="";try{s=moment().format("MM/DD/YYYY")}catch(e){var r=new Date,i=r.getDate(),c=r.getMonth()+1,l=r.getFullYear();i<10&&(i="0"+i),c<10&&(c="0"+c),r=c+"/"+i+"/"+l,s=r}o.setLocalStorageItem("last_request_sf_time_user_data",s),a.resolve(t)}else{n.error("Error AssetList: ",e.message);var d={};d.code=e.code,d.message=e.message,e.analyticsCode?d.analyticsCode=e.analyticsCode:d.analyticsCode="ERR999",a.reject(d)}},function(e){n.error("Error AssetList: ",e);var t={};e[0]?(t.code=e[0].errorCode,t.message=e[0].message,e[0].analyticsCode?t.analyticsCode=e[0].analyticsCode:t.analyticsCode="ERR999"):e.code?(t.code=e.code,t.message=e.message,e.analyticsCode?t.analyticsCode=e.analyticsCode:t.analyticsCode="ERR999"):e.data?(t.code=e.data.status,t.message=e.data.msg,e.data.analyticsCode?t.analyticsCode=e.data.analyticsCode:t.analyticsCode="ERR999"):(t.code="400",t.message=e,t.analyticsCode="ERR999"),a.reject(t)})}return a.promise},pub.getAssetDebt=function(a,r){var i=e.defer();if(o.getLocalStorageItem("asset_debt_"+r))i.resolve(o.getLocalStorageItem("asset_debt_"+r));else{var c={};c.path=s.ENDPOINTS_ASSET_DEBT,c.method="GET",c.contentType="application/json",c.params={numeroSuministro:a},c.data="",t.request(c).then(function(e){if("200"==e.code.toString()){var a=[];null!=e.data&&e.data.length>0&&angular.forEach(e.data,function(e,t){if(null!=e.nroDocumento&&"0"!=e.nroDocumento.toString()&&"-1"!=e.nroDocumento.toString()){n.debug(t+" : ",e);var o={};o.index=t,o.trxId=e.trxId,o.tipoDocumento=e.tipoDocumento,o.tipoDeuda=e.tipoDeuda,o.publicidad=e.publicidad,o.nroDocumento=e.nroDocumento,o.nombre=e.nombre,o.monto=e.monto,o.mensaje=e.mensaje,o.fechaVencimiento=e.fechaVencimiento,o.fechaEmision=e.fechaEmision,o.estado=e.estado,o.direccion=e.direccion,e.comuna&&null!=e.comuna&&""!=e.comuna&&(o.direccion=o.direccion+" "+e.comuna,o.comuna=e.comuna),o.consumo=e.consumo,o.codigoBarra=e.codigoBarra,a.push(o)}else n.debug("el elemento ya fue pagado, no se incluira en la lista")}),a.length>0&&o.setLocalStorageItem("asset_debt_"+r,a),i.resolve(a)}else{n.error("Error AssetDebt: ",e.message);var t={};t.code=e.code,t.message=e.message,e.analyticsCode?t.analyticsCode=e.analyticsCode:t.analyticsCode="ERR999",i.reject(t)}},function(e){n.error("Error AssetList: ",e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),i.reject(a)})}return i.promise},pub.getAssetDetail=function(a,r,i,c){var l=e.defer();if(o.getLocalStorageItem("asset_detail_"+r))l.resolve(o.getLocalStorageItem("asset_detail_"+r));else{var d={};d.path=s.ENDPOINTS_ASSET_DETAIL,d.method="GET",d.contentType="application/json",d.params={numeroSuministro:a},d.data="",t.request(d).then(function(e){if("200"==e.code.toString()){var t={};null!=e.data&&""!=e.data&&(t.tarifa=e.data.tarifa,t.montoUltimoPago=e.data.montoUltimoPago,t.fechaUltimoPago=e.data.fechaUltimoPago,t.fechaProximaLectura=e.data.fechaProximaLectura,t.fechaCorte=e.data.fechaCorte,t.billingPeriod=e.data.billingPeriod,t.numeroSuministro=a,t.numeroSuministroDv=i,t.direccion=c),o.setLocalStorageItem("asset_detail_"+r,t),l.resolve(t)}else{n.error("Error AssetDetail: ",e.message);var s={};s.code=e.code,s.message=e.message,e.analyticsCode?s.analyticsCode=e.analyticsCode:s.analyticsCode="ERR999",l.reject(s)}},function(e){n.error("Error AssetList: ",e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),l.reject(a)})}return l.promise},pub.getAssetUsage=function(a,r){var c=e.defer();if(o.getLocalStorageItem("asset_usages_"+r))c.resolve(o.getLocalStorageItem("asset_usages_"+r));else{var l={};l.path=s.ENDPOINTS_CONSUMPTION,l.method="GET",l.contentType="application/json",l.params={numeroSuministro:a},l.data="",t.request(l).then(function(e){if("200"==e.code.toString()){n.debug("getAssetUsage ",e.data);var a={},t=[],s=[],l=[],d={},m=[],u=[],E=[],_=[],g=0;if(null!=e.data&&e.data.length>0)for(var S=0;S<e.data.length;S++){n.debug(S+" : ",e.data[S]);var A={},T="";A.index=S;var f=e.data[S];if(A.fechaFacturacion=f.fecha,null!=f.totalConsumo&&""!=f.totalConsumo.toString()&&"0"!=f.totalConsumo.toString()&&"-"!=f.totalConsumo.toString()?(A.lecturaActual=f.totalConsumo,f.totalConsumo):(A.lecturaActual="-","0"),null!=f.consumoMes&&""!=f.consumoMes.toString()&&"0"!=f.consumoMes.toString()&&"-"!=f.consumoMes.toString()?(A.consumoEnergia=f.consumoMes,T=f.consumoMes):(A.consumoEnergia="-",T="0"),f.tipoConsumo&&null!=f.tipoConsumo&&""!=f.tipoConsumo.toString()&&"0"!=f.tipoConsumo.toString()&&"-"!=f.tipoConsumo.toString()?A.tipoConsumo=f.tipoConsumo:A.tipoConsumo="-",t.push(A),A.tipoConsumo===i.USAGE_TYPE_RATE_TYPE_CODE_3?u.push(T):A.tipoConsumo===i.USAGE_TYPE_RATE_TYPE_CODE_4?E.push(T):A.tipoConsumo===i.USAGE_TYPE_RATE_TYPE_CODE_5?_.push(T):m.push(T),A.tipoConsumo===i.USAGE_TYPE_RATE_TYPE_CODE_3||A.tipoConsumo===i.USAGE_TYPE_RATE_TYPE_CODE_4||A.tipoConsumo===i.USAGE_TYPE_RATE_TYPE_CODE_5){var C=f.fecha.split("/"),p=C[1]
;g==p?S+1===e.data.length&&s.push(f.fecha):g!=p&&0!=S?(s.push(e.data[S-1].fecha),g=p,f.fecha,S+1===e.data.length&&s.push(f.fecha)):(g=p,f.fecha)}else s.push(f.fecha)}a.items=t,a.typeUsage="",a.items.length>0&&a.items[0].tipoConsumo===i.USAGE_TYPE_RATE_TYPE_CODE_1?(a.typeUsage=i.USAGE_TYPE_RATE_TYPE_CODE_1,l.push(m.reverse())):(l.push(u.reverse()),l.push(E.reverse()),l.push(_.reverse())),a.graphdata=l,a.graphlabels=s.reverse(),a.options=d,o.setLocalStorageItem("asset_usages_"+r,a),c.resolve(a)}else{n.error("Error AssetUsage: ",e.message);var I={};I.code=e.code,I.message=e.message,e.analyticsCode?I.analyticsCode=e.analyticsCode:I.analyticsCode="ERR999",c.reject(I)}},function(e){n.error("Error AssetUsage: ",e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),c.reject(a)})}return c.promise},pub.getAssetBills=function(a,r){var i=e.defer();if(o.getLocalStorageItem("asset_bills_"+r))i.resolve(o.getLocalStorageItem("asset_bills_"+r));else{var c={};c.path=s.ENDPOINTS_GET_BILLS,c.method="GET",c.contentType="application/json",c.params={numeroSuministro:a},c.data="",t.request(c).then(function(e){if("200"==e.code.toString()){n.debug("getAssetBills ",e.data);var a={},t=[],s=[],c=[],l=[],d={};null!=e.data&&e.data.length>0&&angular.forEach(e.data,function(e,a){n.debug(a+" : ",e);var o={};o.index=a;var r="";null!=e.monto&&""!=e.monto.toString()&&"0"!=e.monto.toString()&&"-"!=e.monto.toString()?(o.monto=e.monto,r=e.monto):(o.monto="-",r="0"),o.fecha=e.fecha,e.boleta&&null!=e.boleta&&""!=e.boleta.toString()?o.boleta=e.boleta:o.boleta=0,t.push(o),s.push(o.fecha),l.push(r)}),a.items=t,a.graphlabels=s.reverse(),c.push(l.reverse()),a.graphdata=c,a.options=d,o.setLocalStorageItem("asset_bills_"+r,a),i.resolve(a)}else{n.error("Error AssetBills: ",e.message);var m={};m.code=e.code,m.message=e.message,e.analyticsCode?m.analyticsCode=e.analyticsCode:m.analyticsCode="ERR999",i.reject(m)}},function(e){n.error("Error AssetBills: ",e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),i.reject(a)})}return i.promise},pub.getAssetPayments=function(a,r){var i=e.defer();if(o.getLocalStorageItem("asset_payments_"+r))i.resolve(o.getLocalStorageItem("asset_payments_"+r));else{var c={};c.path=s.ENDPOINTS_GET_PAYMENTS,c.method="GET",c.contentType="application/json",c.params={numeroSuministro:a},c.data="",t.request(c).then(function(e){if("200"==e.code.toString()){n.debug("getAssetBills ",e.data);var a={},t=[],s=[],c=[],l=[],d={};null!=e.data&&e.data.length>0&&angular.forEach(e.data,function(e,a){n.debug(a+" : ",e);var o={};o.index=a,null!=e.tipoPago&&""!=e.tipoPago.toString()&&"0"!=e.tipoPago.toString()&&"-"!=e.tipoPago.toString()?o.tipoPago=e.tipoPago:o.tipoPago="-";null!=e.monto&&""!=e.monto.toString()&&"0"!=e.monto.toString()&&"-"!=e.monto.toString()?o.monto=e.monto:o.monto="-",o.fechaPago=e.fechaPago,t.push(o),s.push(o.fechaPago),l.push(o.monto)}),a.items=t,a.graphlabels=s.reverse(),c.push(l.reverse()),a.graphdata=c,a.options=d,o.setLocalStorageItem("asset_payments_"+r,a),i.resolve(a)}else{n.error("Error AssetPayments: ",e.message);var m={};m.code=e.code,m.message=e.message,e.analyticsCode?m.analyticsCode=e.analyticsCode:m.analyticsCode="ERR999",i.reject(m)}},function(e){n.error("Error AssetPayments: ",e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),i.reject(a)})}return i.promise},pub.getBillByDate=function(a,o,r,i){var c=e.defer(),l={};return l.path=s.ENDPOINTS_GET_BILL_BY_DATE,l.method="GET",l.contentType="application/json",l.params={numeroSuministro:a,boleta:o,email:r,mes:i},l.data="",t.request(l).then(function(e){if("200"==e.code.toString()){var a={};null!=e.data&&""!=e.data&&(a.url=e.data.URLBoleta,a.numeroSuministroDv=e.data.numero,a.email=e.data.email,a.detalle=e.data.descripcionResultado,a.codigo=e.data.codigoResultado,a.boleta=e.data.boleta),c.resolve(a)}else{n.error("Error Get Bill By Date: ",e.message);var t={};t.code=e.code,t.message=e.message,e.analyticsCode?t.analyticsCode=e.analyticsCode:t.analyticsCode="ERR999",c.reject(t)}},function(e){n.error("Error Get Bill By Date: ",e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),c.reject(a)}),c.promise},pub.setEnterReading=function(a,o,r,i,c){var l=e.defer(),d={};return d.path=s.ENDPOINTS_ENTER_READING,d.method="GET",d.contentType="application/json",d.params=null==o||""==o||null!=r&&""!=r&&null!=i&&""!=i&&null!=c&&""!=c?null!=o&&""!=o||null==r||""==r||null==i||""==i||null==c||""==c?{numeroSuministro:a}:{numeroSuministro:a,lecturaDia:r,lecturaNoche:i,lecturaPunta:c}:{numeroSuministro:a,lectura:o},d.data="",t.request(d).then(function(e){if("200"==e.code.toString()){n.debug("setEnterReading ",e.data);var a={};null!=e.data&&e.data.length>0&&(a.caseId=e.data.caseId),l.resolve(a)}else{n.error("Error AssetDetail: ",e.message);var t={};t.code=e.code,t.message=e.message,e.analyticsCode?t.analyticsCode=e.analyticsCode:t.analyticsCode="ERR999",l.reject(t)}},function(e){n.error("Error AssetDetail: ",e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),l.reject(a)}),l.promise},pub.removeUsageData=function(){try{var e=[];e.push("SALESFORCE_CONFIG"),e.push("branches"),e.push("contact_id"),e.push("login_url"),e.push("no_session_client_number"),o.removeLocalStorageItemExcept(e)}catch(e){n.error("err: ",e)}},pub}]),angular.module("NotificationModule",["CoreModule"]),angular.module("NotificationModule").factory("NotificationService",["$q","ConnectionProvider","SalesforceProvider","LocalStorageProvider","$log","ENDPOINTS","UTILS_CONFIG","UtilsService","$rootScope",function(e,a,t,o,n,s,r,i,c){pub={},pub.getNotificationList=function(){var a=e.defer(),r={};return r.path=s.ENDPOINTS_NOTIFICATION_LIST,r.method="GET",r.contentType="application/json",r.params={},r.data="",t.request(r).then(function(e){if("200"==e.code.toString()){n.debug("getNotificationList ",e.data);var t=[],s=!0;if(null!=e.data&&e.data.length>0)for(var r=0;r<e.data.length;r++){if(o.getLocalStorageItem("notification_list")){t=o.getLocalStorageItem("notification_list");for(var i=!1,c=0;c<t.length;c++){var d=e.data[r].pushDate.split("/"),m=t[c].fecha.split("/"),u=d[1]+"/"+d[0]+"/"+d[2],E=m[1]+"/"+m[0]+"/"+m[2],_=Date.parse(u),g=Date.parse(E);if(!(_>=g)){s=!1,i=!0;break}if(t[c].taskId==e.data[r].taskId){i=!0;break}}if(!i){n.debug(r+" : ",e.data[r]);var S={};S.taskId=e.data[r].taskId,S.titulo=e.data[r].title,S.mensaje=e.data[r].body,S.fecha=e.data[r].pushDate,S.status=e.data[r].status,t.unshift(S),o.setLocalStorageItem("notification_list",t),l()}}else{n.debug(r+" : ",e.data[r]);var S={};S.taskId=e.data[r].taskId,S.titulo=e.data[r].title,S.mensaje=e.data[r].body,S.fecha=e.data[r].pushDate,S.status=e.data[r].status,t.push(S)}if(!s)break}else o.getLocalStorageItem("notification_list")&&(t=o.getLocalStorageItem("notification_list")),n.error("no hay elementos de notificaciones");o.setLocalStorageItem("notification_list",t),l(),a.resolve(o.getLocalStorageItem("notification_list"))}else if(o.getLocalStorageItem("notification_list"))a.resolve(o.getLocalStorageItem("notification_list")),l();else{n.error("Error NotificationList: ",e.message);var A={};A.code=e.code,A.message=e.message,e.analyticsCode?A.analyticsCode=e.analyticsCode:A.analyticsCode="ERR999",a.reject(A)}},function(e){if(o.getLocalStorageItem("notification_list")&&o.getLocalStorageItem("notification_list").length>0)a.resolve(o.getLocalStorageItem("notification_list")),l();else{n.error("Error NotificationList: ",e);var t={};e[0]?(t.code=e[0].errorCode,t.message=e[0].message,e[0].analyticsCode?t.analyticsCode=e[0].analyticsCode:t.analyticsCode="ERR999"):e.code?(t.code=e.code,t.message=e.message,e.analyticsCode?t.analyticsCode=e.analyticsCode:t.analyticsCode="ERR999"):e.data?(t.code=e.data.status,t.message=e.data.msg,e.data.analyticsCode?t.analyticsCode=e.data.analyticsCode:t.analyticsCode="ERR999"):(t.code="400",t.message=e,t.analyticsCode="ERR999"),a.reject(t)}}),a.promise},pub.updateNotification=function(a,i){var c=a.taskId,d=e.defer(),m={};return m.path=s.ENDPOINTS_UPDATE_NOTIFICATION,m.method="POST",m.contentType="application/json",m.params={},m.data={bean:{taskId:c,action:i}},t.request(m).then(function(e){if("200"==e.code.toString()){n.debug("updateNotification",e);var t={};if(o.getLocalStorageItem("notification_list")){if(t=o.getLocalStorageItem("notification_list"),i===r.NOTIFICATION_UPDATE_TYPE_01){for(var s=0;s<t.length;s++)if(a.taskId==t[s].taskId){t[s].status=r.NOTIFICATION_STATUS_NOTIFICATION_01;break}}else if(i===r.NOTIFICATION_UPDATE_TYPE_02)for(var s=0;s<t.length;s++)if(a.taskId==t[s].taskId){t.splice(s,1);break}o.removeLocalStorageItem("notification_list"),o.setLocalStorageItem("notification_list",t),l()}var c=o.getLocalStorageItem("notification_list");d.resolve(c)}else{n.error("Error updateNotification: ",e.message);var m={};m.code=e.code,m.message=e.message,e.analyticsCode?m.analyticsCode=e.analyticsCode:m.analyticsCode="ERR999",d.reject(m)}},function(e){n.error("Error updateNotification: ",e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),d.reject(a)}),d.promise};var l=function(){if(o.getLocalStorageItem("notification_list")){var e=o.getLocalStorageItem("notification_list"),a=0;return e.forEach(function(e){e.status!=r.NOTIFICATION_STATUS_NOTIFICATION_01&&a++}),c.countNotification=a,i.setBadgeNumber(a),a}return i.setBadgeNumber(0),c.countNotification=0,0};return pub}]),angular.module("ManageAssetModule",["CoreModule","ngRoute"]),angular.module("ManageAssetModule").factory("ManageAssetService",["$q","ConnectionProvider","SalesforceProvider","LocalStorageProvider","$log","ENDPOINTS","UTILS_CONFIG",function(e,a,t,o,n,s,r){return pub={},pub.addAsset=function(a,o,r){var i=e.defer(),c={};return c.path=s.ENDPOINTS_ADD_ASSET,c.method="POST",c.contentType="application/json",c.data={bean:{numeroSuministro:a,numberTicket:o,rol:r}},c.params="",t.request(c).then(function(e){if("200"==e.code.toString()){n.debug("RESPONSE ADD ASSET",e);var a={};a.numeroSuministro=e.data.numeroSuministro,a.numeroSuministroDv=e.data.numeroSuministro,a.direccion=e.data.direccion,a.comuna=e.data.comuna,i.resolve(a)}else{n.error("Error Add Asset: ",e.message);var t={};t.code=e.code,t.message=e.message,e.analyticsCode?t.analyticsCode=e.analyticsCode:t.analyticsCode="ERR999",i.reject(t)}},function(e){n.error("Error Add Asset: ",e.message);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),i.reject(a)}),i.promise},pub}]),angular.module("FeaturedModule",["CoreModule"]),angular.module("FeaturedModule").factory("FeaturedService",["ConnectionProvider","$q","ENDPOINTS","$log","LocalStorageProvider",function(e,a,t,o,n){return{getFeaturedItems:function(){var s=a.defer(),r=t.ENDPOINTS_BASE_EXTERNAL+t.ENDPOINTS_FEATURED,i={},c={},l={"Content-type":"application/json"};return n.getLocalStorageItem("featured_list")?s.resolve(n.getLocalStorageItem("featured_list")):e.sendGet(r,i,c,l,function(e){if("200"==e.code.toString()){o.debug("Get Data: ",e);var a=[];angular.forEach(e.data,function(e,t){var o={index:t,titulo:e.titulo,subtitulo:e.subTitulo,detalle:e.detalle,url:e.url,imagen:e.imagen};a.push(o)}),n.setLocalStorageItem("featured_list",a);var t="";try{t=moment().format("MM/DD/YYYY")}catch(e){var r=new Date,i=r.getDate(),c=r.getMonth()+1,l=r.getFullYear();i<10&&(i="0"+i),c<10&&(c="0"+c),r=c+"/"+i+"/"+l,t=r}n.setLocalStorageItem("last_request_sf_time_featured",t),s.resolve(a)}else{o.error("Error Get Data: "+e.message);var d={};d.code=e.code,d.message=e.message,e.analyticsCode?d.analyticsCode=e.analyticsCode:d.analyticsCode="ERR999",s.reject(d)}},function(e){o.error("Error Get Data: "+e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),s.reject(a)}),s.promise}}}]),angular.module("EmergencyModule",[]),angular.module("EmergencyModule").factory("EmergencyService",["$q","ConnectionProvider","SalesforceProvider","$log","ENDPOINTS","LocalStorageProvider",function(e,a,t,o,n,s){return pub={},pub.emergencyLightCut=function(t,s,r,i,c,l,d,m){var u=e.defer(),E=n.ENDPOINTS_BASE_EXTERNAL+n.ENDPOINTS_EXTERNAL_EMERGENCY_BLACKOUT,_={bean:{numeroSuministro:t,tipoDeProblema:r,descripcion:s,nombre:i,apellidos:c,email:l,telefonoPrimario:d,telefonoSecundario:m}},g={},S={"Content-type":"application/json"};return a.sendPost(E,g,_,S,function(e){if("200"==e.code.toString())o.debug("Get Data: ",e),u.resolve(e);else{o.error("Error Get Data: "+e.message);var a={};a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999",u.reject(a)}},function(e){o.error("Error Get Data: "+e.message);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),u.reject(a)}),u.promise},pub.emergencyLightingProblem=function(t,s,r,i,c,l,d,m,u,E,_){var g=e.defer(),S=n.ENDPOINTS_BASE_EXTERNAL+n.ENDPOINTS_EXTERNAL_EMERGENCY_LIGHTING_PROBLEM,A={bean:{tipoDeProblema:t,calle:s,numero:r,departamento:i,comuna:c,nombre:l,apellidos:d,email:m,telefonoPrimario:u,telefonoSecundario:E,siniestro:_}},T={},f={"Content-type":"application/json"};return a.sendPost(S,T,A,f,function(e){if("200"==e.code.toString())o.debug("Get Data: ",e),g.resolve(e);else{o.error("Error Get Data: "+e.message);var a={};a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999",g.reject(a)}},function(e){o.error("Error Get Data: "+e.message);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),g.reject(a)}),g.promise},pub.emergencyRiskAccident=function(t,s,r,i,c,l,d,m,u,E,_){var g=e.defer(),S=n.ENDPOINTS_BASE_EXTERNAL+n.ENDPOINTS_EXTERNAL_EMERGENCY_RISK_ACCIDENT,A={bean:{tipoDeProblema:t,calle:s,numero:r,departamento:i,comuna:c,nombre:l,apellidos:d,email:m,telefonoPrimario:u,telefonoSecundario:E,siniestro:_}},T={},f={"Content-type":"application/json"};return a.sendPost(S,T,A,f,function(e){if("200"==e.code.toString())o.debug("Get Data: ",e),g.resolve(e);else{o.error("Error Get Data: "+e.message);var a={};a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999",g.reject(a)}},function(e){o.error("Error Get Data: "+e.message);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),g.reject(a)}),g.promise},pub.getBlackoutProblemsList=function(){var t=e.defer();if(s.getLocalStorageItem("blackout_list")&&s.getLocalStorageItem("blackout_list").length>0)t.resolve(s.getLocalStorageItem("blackout_list")),o.debug("getBlakcoutList: ",s.getLocalStorageItem("blackout_list"));else{var r=n.ENDPOINTS_BASE_EXTERNAL+n.ENDPOINTS_BLACKOUT_PROBLEMS_LIST,i={},c={},l={"Content-type":"application/json"};a.sendGet(r,i,c,l,function(e){if(200==e.code){o.debug("Get getBlackoutList: ",e.data);var a=[];o.debug("largo: ",e.data.length);for(var n=0;n<e.data.length;n++)a.push(e.data[n]);s.setLocalStorageItem("blackout_list",a);var r="";try{r=moment().format("MM/DD/YYYY")}catch(e){var i=new Date,c=i.getDate(),l=i.getMonth()+1,d=i.getFullYear();c<10&&(c="0"+c),l<10&&(l="0"+l),i=l+"/"+c+"/"+d,r=i}s.setLocalStorageItem("last_request_sf_time_blackout_problems",r),t.resolve(a)}else{o.error("Error getBlackoutList: "+e.message);var a={};a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999",t.reject(a)}},function(e){o.error("Error getBlackoutList: "+e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),t.reject(a)})}return t.promise},pub.getLightingProblemsList=function(){var t=e.defer();if(s.getLocalStorageItem("lighting_list")&&s.getLocalStorageItem("lighting_list").length>0)t.resolve(s.getLocalStorageItem("lighting_list")),o.debug("getLightingList: ",s.getLocalStorageItem("lighting_list"));else{var r=n.ENDPOINTS_BASE_EXTERNAL+n.ENDPOINTS_LIGHTING_PROBLEMS_LIST,i={},c={},l={"Content-type":"application/json"};a.sendGet(r,i,c,l,function(e){if(200==e.code){o.debug("Get getLightingList: ",e.data);var a=[];o.debug("largo: ",e.data.length);for(var n=0;n<e.data.length;n++)a.push(e.data[n]);s.setLocalStorageItem("lighting_list",a);var r="";try{r=moment().format("MM/DD/YYYY")}catch(e){var i=new Date,c=i.getDate(),l=i.getMonth()+1,d=i.getFullYear();c<10&&(c="0"+c),l<10&&(l="0"+l),i=l+"/"+c+"/"+d,r=i}s.setLocalStorageItem("last_request_sf_time_lighting_problems",r),t.resolve(a)}else{o.error("Error getLightingList: "+e.message);var a={};a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999",t.reject(a)}},function(e){o.error("Error getLightingList: "+e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),t.reject(a)})}return t.promise},pub.getRiskAccidentProblemsList=function(){var t=e.defer();if(s.getLocalStorageItem("risk_accident_list")&&s.getLocalStorageItem("risk_accident_list").length>0)t.resolve(s.getLocalStorageItem("risk_accident_list")),o.debug("getRiskAccidentList: ",s.getLocalStorageItem("risk_accident_list"));else{var r=n.ENDPOINTS_BASE_EXTERNAL+n.ENDPOINTS_RISK_ACCIDENT_PROBLEMS_LIST,i={},c={},l={"Content-type":"application/json"};a.sendGet(r,i,c,l,function(e){if(200==e.code){o.debug("Get getRiskAccidentList: ",e.data);var a=[];o.debug("largo: ",e.data.length);for(var n=0;n<e.data.length;n++)a.push(e.data[n]);s.setLocalStorageItem("risk_accident_list",a);var r="";try{r=moment().format("MM/DD/YYYY")}catch(e){var i=new Date,c=i.getDate(),l=i.getMonth()+1,d=i.getFullYear();c<10&&(c="0"+c),l<10&&(l="0"+l),i=l+"/"+c+"/"+d,r=i}s.setLocalStorageItem("last_request_sf_time_accident_risk_problems",r),t.resolve(a)}else{o.error("Error getRiskAccidentList: "+e.message);var a={};a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999",t.reject(a)}},function(e){o.error("Error getRiskAccidentList: "+e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),t.reject(a)})}return t.promise},pub.emergencyLightCutAuth=function(a,s,r){var i=e.defer(),c={};return c.path=n.ENDPOINTS_EMERGENCY_BLACKOUT,c.method="POST",c.contentType="application/json",c.data={bean:{numeroSuministro:a,descripcion:s,tipoDeProblema:r}},c.params="",t.request(c).then(function(e){if("200"==e.code.toString())o.debug("RESPONSE EMERGENCY ",e),i.resolve(e);else{o.error("Error AssetList: ",e.message);var a={};a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999",i.reject(a)}},function(e){o.error("Error AssetList: ",e.message);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),i.reject(a)}),i.promise},pub.emergencyLightingProblemAuth=function(a,s,r,i,c,l){var d=e.defer(),m={};return m.path=n.ENDPOINTS_EMERGENCY_LIGHTING_PROBLEM,m.method="POST",m.contentType="application/json",m.data={bean:{tipoDeProblema:a,siniestro:l,calle:s,numero:r,departamento:i,comuna:c}},m.param="",t.request(m).then(function(e){if("200"==e.code.toString())o.debug("RESPONSE EMERGENCY ",e),d.resolve(e);else{o.error("Error AssetList: ",e.message);var a={};a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999",d.reject(a)}},function(e){o.error("Error AssetList: ",e.message);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),d.reject(a)}),d.promise},pub.emergencyRiskAccidentAuth=function(a,s,r,i,c,l){var d=e.defer(),m={};return m.path=n.ENDPOINTS_EMERGENCY_RISK_ACCIDENT,m.method="POST",m.contentType="application/json",m.data={bean:{tipoDeProblema:a,siniestro:l,calle:s,numero:r,departamento:i,comuna:c}},m.params="",t.request(m).then(function(e){if("200"==e.code.toString())o.debug("RESPONSE EMERGENCY ",e),d.resolve(e);else{o.error("Error AssetList: ",e.message);var a={};a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999",d.reject(a)}},function(e){o.error("Error AssetList: ",e.message);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),d.reject(a)}),d.promise},pub}]),angular.module("CoreModule",[]),angular.module("CoreModule").factory("UtilsService",["SalesforceProvider","$q","ENDPOINTS","$log","SALESFORCE_CONFIG","LocalStorageProvider","ConnectionProvider","$rootScope","AccessService","$state","$route","$ionicLoading","$window",function(e,a,t,o,n,s,r,i,c,l,d,m,u){return pub={},pub.getStates=function(){var e=a.defer();if(s.getLocalStorageItem("states")&&s.getLocalStorageItem("states").length>0)e.resolve(s.getLocalStorageItem("states")),o.debug("getStates: ",s.getLocalStorageItem("states"));else{var n=t.ENDPOINTS_BASE_EXTERNAL+t.ENDPOINTS_GET_STATES,i={},c={},l={"Content-type":"application/json"};r.sendGet(n,i,c,l,function(a){if(200==a.code){o.debug("Get getStates: ",a.data);var t=[];o.debug("largo: ",a.data.length);for(var n=0;n<a.data.length;n++)t.push(a.data[n]);s.setLocalStorageItem("states",t);var r="";try{r=moment().format("MM/DD/YYYY")}catch(e){var i=new Date,c=i.getDate(),l=i.getMonth()+1,d=i.getFullYear();c<10&&(c="0"+c),l<10&&(l="0"+l),i=l+"/"+c+"/"+d,r=i}s.setLocalStorageItem("last_request_sf_time_states",r),e.resolve(t)}else{o.error("Error getStates: "+a.message);var t={};t.code=a.code,t.message=a.message,a.analyticsCode?t.analyticsCode=respuesta.analyticsCode:t.analyticsCode="ERR999",e.reject(t)}},function(a){o.error("Error getStates: "+a);var t={};a[0]?(t.code=a[0].errorCode,t.message=a[0].message,a[0].analyticsCode?t.analyticsCode=a[0].analyticsCode:t.analyticsCode="ERR999"):a.code?(t.code=a.code,t.message=a.message,a.analyticsCode?t.analyticsCode=a.analyticsCode:t.analyticsCode="ERR999"):a.data?(t.code=a.data.status,t.message=a.data.msg,a.data.analyticsCode?t.analyticsCode=a.data.analyticsCode:t.analyticsCode="ERR999"):(t.code="400",t.message=a,t.analyticsCode="ERR999"),e.reject(t)})}return e.promise},pub.getAssetList=function(){var n=a.defer();if(s.getLocalStorageItem("asset_list"))n.resolve(s.getLocalStorageItem("asset_list")),s.setLocalStorageItem("asset_list_is_new_request","false");else{var r={};r.path=t.ENDPOINTS_ASSESTS_LIST,r.method="GET",r.contentType="application/json",r.params={},r.data="",e.request(r).then(function(e){if("200"==e.code.toString()){o.debug("getAssetList ",e.data);var a=[];null!=e.data&&e.data.length>0&&angular.forEach(e.data,function(e,t){o.debug(t+" : ",e);var n={};n.index=t,n.direccion=e.direccion.direccion,e.direccion.comuna&&null!=e.direccion.comuna&&""!=e.direccion.comuna&&(n.direccion=n.direccion+" "+e.direccion.comuna,n.comuna=e.direccion.comuna),n.numeroSuministro=e.numeroSuministro,n.numeroSuministroDv=e.numeroSuministro+"-"+e.digitoVerificador,a.push(n)}),s.setLocalStorageItem("asset_list",a),s.setLocalStorageItem("asset_list_is_new_request","true");var t="";try{t=moment().format("MM/DD/YYYY")}catch(e){var r=new Date,i=r.getDate(),c=r.getMonth()+1,l=r.getFullYear();i<10&&(i="0"+i),c<10&&(c="0"+c),r=c+"/"+i+"/"+l,t=r}s.setLocalStorageItem("last_request_sf_time_user_data",t),n.resolve(a)}else{o.error("Error AssetList: ",e.message);var d={};d.code=e.code,d.message=e.message,e.analyticsCode?d.analyticsCode=e.analyticsCode:d.analyticsCode="ERR999",n.reject(d)}},function(e){o.error("Error AssetList: ",e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),n.reject(a)})}return n.promise},pub.getAssetDebt=function(e){var n=a.defer();if(s.getLocalStorageItem("asset_debt_"))n.resolve(s.getLocalStorageItem("asset_debt_"));else{var i=t.ENDPOINTS_BASE_EXTERNAL+t.ENDPOINTS_GET_ASSET_DEBT,c={numeroSuministro:e},l={},d={"Content-type":"application/json"};r.sendGet(i,c,l,d,function(e){if("200"==e.code.toString()){o.debug("getAssetList ",e.data);var a={};s.setLocalStorageItem("asset_debt_",e.data),n.resolve(e.data)}else{o.error("Error AssetList: ",e.message);var a={};a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999",n.reject(a)}},function(e){o.error("Error AssetList: ",e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),n.reject(a)})}return n.promise},pub.getSubjectList=function(){var e=a.defer();if(s.getLocalStorageItem("subject_list"))e.resolve(s.getLocalStorageItem("subject_list"));else{var n=t.ENDPOINTS_BASE_EXTERNAL+t.ENDPOINTS_EXTERNAL_SUBJECT,i={},c={},l={"Content-type":"application/json"};r.sendGet(n,i,c,l,function(a){if("200"==a.code.toString()){o.debug("getAssetList ",a.data),s.setLocalStorageItem("subject_list",a.data);var t="";try{t=moment().format("MM/DD/YYYY")}catch(e){var n=new Date,r=n.getDate(),i=n.getMonth()+1,c=n.getFullYear();r<10&&(r="0"+r),i<10&&(i="0"+i),n=i+"/"+r+"/"+c,t=n}s.setLocalStorageItem("last_request_sf_time_subject_list",t),e.resolve(a.data)}else{o.error("Error AssetList: ",a.message);var l={};l.code=a.code,l.message=a.message,a.analyticsCode?l.analyticsCode=a.analyticsCode:l.analyticsCode="ERR999",e.reject(l)}},function(a){o.error("Error AssetList: ",a);var t={};a[0]?(t.code=a[0].errorCode,t.message=a[0].message,a[0].analyticsCode?t.analyticsCode=a[0].analyticsCode:t.analyticsCode="ERR999"):a.code?(t.code=a.code,t.message=a.message,
a.analyticsCode?t.analyticsCode=a.analyticsCode:t.analyticsCode="ERR999"):a.data?(t.code=a.data.status,t.message=a.data.msg,a.data.analyticsCode?t.analyticsCode=a.data.analyticsCode:t.analyticsCode="ERR999"):(t.code="400",t.message=a,t.analyticsCode="ERR999"),e.reject(t)})}return e.promise},pub.setXID=function(n,s){var r=a.defer(),i={};return i.path=t.ENDPOINTS_REGISTER_XID_DEVICE,i.method="POST",i.contentType="application/json",i.data={bean:{xid:n,so:s}},i.params="",e.request(i).then(function(e){if("200"==e.code.toString())o.debug("Set XID ",e),r.resolve(e);else{o.error("Error Set XID: ",e.message);var a={};a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999",r.reject(a)}},function(e){o.error("Error Set XID: ",e.message);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),r.reject(a)}),r.promise},pub.setBadgeNumber=function(e){try{o.info("COUNT: "+e),i.push&&i.push.setApplicationIconBadgeNumber(function(){},function(){},e)}catch(e){o.error("Error al set BadgeNumber: ",e)}},pub.manageLocalStorageWhenRunApp=function(){var e="";try{e=moment().format("MM/DD/YYYY")}catch(s){var a=new Date,t=a.getDate(),o=a.getMonth()+1,n=a.getFullYear();t<10&&(t="0"+t),o<10&&(o="0"+o),a=o+"/"+t+"/"+n,e=a}if(s.getLocalStorageItem("last_request_sf_time_branches")){var r=new Date(e).getTime(),c=new Date(s.getLocalStorageItem("last_request_sf_time_branches")).getTime(),l=2592e6;r-c>l&&(s.removeLocalStorageItem("branches"),s.removeLocalStorageItem("last_request_sf_time_branches"))}if(s.getLocalStorageItem("last_request_sf_time_featured")){var r=new Date(e).getTime(),c=new Date(s.getLocalStorageItem("last_request_sf_time_featured")).getTime();r!=c&&(s.removeLocalStorageItem("featured_list"),s.removeLocalStorageItem("last_request_sf_time_featured"))}if(s.getLocalStorageItem("last_request_sf_time_blackout_problems")){var r=new Date(e).getTime(),c=new Date(s.getLocalStorageItem("last_request_sf_time_blackout_problems")).getTime(),l=2592e6;r-c>l&&(s.removeLocalStorageItem("blackout_list"),s.removeLocalStorageItem("last_request_sf_time_blackout_problems"))}if(s.getLocalStorageItem("last_request_sf_time_lighting_problems")){var r=new Date(e).getTime(),c=new Date(s.getLocalStorageItem("last_request_sf_time_lighting_problems")).getTime(),l=2592e6;r-c>l&&(s.removeLocalStorageItem("lighting_list"),s.removeLocalStorageItem("last_request_sf_time_lighting_problems"))}if(s.getLocalStorageItem("last_request_sf_time_accident_risk_problems")){var r=new Date(e).getTime(),c=new Date(s.getLocalStorageItem("last_request_sf_time_accident_risk_problems")).getTime(),l=2592e6;r-c>l&&(s.removeLocalStorageItem("risk_accident_list"),s.removeLocalStorageItem("last_request_sf_time_accident_risk_problems"))}if(s.getLocalStorageItem("last_request_sf_time_subject_list")){var r=new Date(e).getTime(),c=new Date(s.getLocalStorageItem("last_request_sf_time_subject_list")).getTime(),l=2592e6;r-c>=l&&(s.removeLocalStorageItem("subject_list"),s.removeLocalStorageItem("last_request_sf_time_subject_list"))}if(s.getLocalStorageItem("last_request_sf_time_states")){var r=new Date(e).getTime(),c=new Date(s.getLocalStorageItem("last_request_sf_time_states")).getTime(),l=2592e6;r-c>=l&&(s.removeLocalStorageItem("states"),s.removeLocalStorageItem("last_request_sf_time_states"))}if(s.getLocalStorageItem("show_rotate_icon")&&(i.showRotateIcon=!1),s.getLocalStorageItem("last_request_sf_time_user_data")){var r=new Date(e).getTime(),c=new Date(s.getLocalStorageItem("last_request_sf_time_user_data")).getTime();r!=c&&(s.removeLocalStorageIfStartWith("asset_"),s.removeLocalStorageItem("last_request_sf_time_user_data"))}},pub.manageLocalStorageWhenPauseApp=function(){var e="";try{e=moment().format("MM/DD/YYYY")}catch(s){var a=new Date,t=a.getDate(),o=a.getMonth()+1,n=a.getFullYear();t<10&&(t="0"+t),o<10&&(o="0"+o),a=o+"/"+t+"/"+n,e=a}if(s.getLocalStorageItem("last_request_sf_time_branches")){var r=new Date(e).getTime(),c=new Date(s.getLocalStorageItem("last_request_sf_time_branches")).getTime(),l=2592e6;r-c>l&&(s.removeLocalStorageItem("branches"),s.removeLocalStorageItem("last_request_sf_time_branches"))}if(s.getLocalStorageItem("last_request_sf_time_featured")){var r=new Date(e).getTime(),c=new Date(s.getLocalStorageItem("last_request_sf_time_featured")).getTime();r!=c&&(s.removeLocalStorageItem("featured_list"),s.removeLocalStorageItem("last_request_sf_time_featured"))}if(s.getLocalStorageItem("last_request_sf_time_blackout_problems")){var r=new Date(e).getTime(),c=new Date(s.getLocalStorageItem("last_request_sf_time_blackout_problems")).getTime(),l=2592e6;r-c>l&&(s.removeLocalStorageItem("blackout_list"),s.removeLocalStorageItem("last_request_sf_time_blackout_problems"))}if(s.getLocalStorageItem("last_request_sf_time_lighting_problems")){var r=new Date(e).getTime(),c=new Date(s.getLocalStorageItem("last_request_sf_time_lighting_problems")).getTime(),l=2592e6;r-c>l&&(s.removeLocalStorageItem("lighting_list"),s.removeLocalStorageItem("last_request_sf_time_lighting_problems"))}if(s.getLocalStorageItem("last_request_sf_time_accident_risk_problems")){var r=new Date(e).getTime(),c=new Date(s.getLocalStorageItem("last_request_sf_time_accident_risk_problems")).getTime(),l=2592e6;r-c>l&&(s.removeLocalStorageItem("risk_accident_list"),s.removeLocalStorageItem("last_request_sf_time_accident_risk_problems"))}if(s.getLocalStorageItem("last_request_sf_time_subject_list")){var r=new Date(e).getTime(),c=new Date(s.getLocalStorageItem("last_request_sf_time_subject_list")).getTime(),l=2592e6;r-c>=l&&(s.removeLocalStorageItem("subject_list"),s.removeLocalStorageItem("last_request_sf_time_subject_list"))}if(s.getLocalStorageItem("last_request_sf_time_states")){var r=new Date(e).getTime(),c=new Date(s.getLocalStorageItem("last_request_sf_time_states")).getTime(),l=2592e6;r-c>=l&&(s.removeLocalStorageItem("states"),s.removeLocalStorageItem("last_request_sf_time_states"))}if(s.getLocalStorageItem("show_rotate_icon")&&(i.showRotateIcon=!1),s.getLocalStorageItem("last_request_sf_time_user_data")){var r=new Date(e).getTime(),c=new Date(s.getLocalStorageItem("last_request_sf_time_user_data")).getTime();r!=c&&(s.removeLocalStorageIfStartWith("asset_"),s.removeLocalStorageItem("last_request_sf_time_user_data"))}},pub.manageLocalStorageWhenUpdateApp=function(e){s.getLocalStorageItem("app_version")?e!==s.getLocalStorageItem("app_version")&&(s.getLocalStorageItem("last_request_sf_time_branches")&&(s.removeLocalStorageItem("last_request_sf_time_branches"),s.removeLocalStorageItem("branches")),s.getLocalStorageItem("last_request_sf_time_featured")&&(s.removeLocalStorageItem("last_request_sf_time_featured"),s.removeLocalStorageItem("featured_list")),s.getLocalStorageItem("last_request_sf_time_blackout_problems")&&(s.removeLocalStorageItem("last_request_sf_time_blackout_problems"),s.removeLocalStorageItem("blackout_list")),s.getLocalStorageItem("last_request_sf_time_lighting_problems")&&(s.removeLocalStorageItem("last_request_sf_time_lighting_problems"),s.removeLocalStorageItem("lighting_list")),s.getLocalStorageItem("last_request_sf_time_accident_risk_problems")&&(s.removeLocalStorageItem("last_request_sf_time_accident_risk_problems"),s.removeLocalStorageItem("risk_accident_list")),s.getLocalStorageItem("last_request_sf_time_subject_list")&&(s.removeLocalStorageItem("last_request_sf_time_subject_list"),s.removeLocalStorageItem("subject_list")),s.getLocalStorageItem("last_request_sf_time_states")&&(s.removeLocalStorageItem("last_request_sf_time_states"),s.removeLocalStorageItem("states")),s.getLocalStorageItem("pass_tuto")&&s.removeLocalStorageItem("pass_tuto"),s.getLocalStorageItem("show_rotate_icon")&&s.removeLocalStorageItem("show_rotate_icon"),s.setLocalStorageItem("app_version",e)):s.setLocalStorageItem("app_version",e)},pub.PagerService=function(e,a,t){a=a||1,t=t||10;var o,n,s=window.Math.ceil(e/t);s<=10?(o=1,n=s):a<=6?(o=1,n=10):a+4>=s?(o=s-9,n=s):(o=a-5,n=a+4);var r=(a-1)*t,i=window.Math.min(r+t-1,e-1),c="";return c=s>=5?_.range(o,n+1):_.range(s),{totalItems:e,currentPage:a,pageSize:t,totalPages:s,startPage:o,endPage:n,startIndex:r,endIndex:i,pages:c}},pub}]),angular.module("CoreModule").factory("ProfileService",["ConnectionProvider","SalesforceProvider","$q","ENDPOINTS","$log","$ionicLoading","LocalStorageProvider","UTILS_CONFIG",function(e,a,t,o,n,s,r,i){return pub.updateUserData=function(e,c,l,d){var m=t.defer(),u={};return u.path=o.ENDPOINTS_EDIT_USER,u.method="POST",u.contentType="application/json",u.params={},u.data={bean:{checkNotifications:e,email:c,mobilePhone:l,homePhone:d}},s.show({template:i.STYLE_IONICLOADING_TEMPLATE}),a.request(u).then(function(a){if(s.hide(),"200"==a.code.toString()){n.debug("updateUserData: ",a.message);var t=r.getLocalStorageItem("USER_DATA");t.email=c,t.telefonoMovil=l,t.telefonoFijo=d,t.activarNotificaciones=e,r.setLocalStorageItem("USER_DATA",t),m.resolve(a)}else{n.error("Error changePassword: ",a.message);var o={};o.code=a.code,o.message=a.message,a.analyticsCode?o.analyticsCode=a.analyticsCode:o.analyticsCode="ERR999",m.reject(o)}},function(e){s.hide(),n.error("Error updateuserData: ",e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),m.reject(a)}),m.promise},pub.changePassword=function(e,r){var c=t.defer(),l={};return l.path=o.ENDPOINTS_PASSWORD_CHANGE,l.method="POST",l.contentType="application/json",l.params={},l.data={bean:{newPassword:e,verifyNewPassword:r}},s.show({template:i.STYLE_IONICLOADING_TEMPLATE}),a.request(l).then(function(e){if(s.hide(),"200"==e.code.toString())n.debug("changePassword:: ",e.message),c.resolve(e);else{n.error("Error changePassword: ",e.message);var a={};a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999",c.reject(a)}},function(e){s.hide(),n.error("Error changePassword: ",e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),c.reject(a)}),c.promise},pub.getRelationshipWithAsset=function(){var a=t.defer(),s=o.ENDPOINTS_BASE_EXTERNAL+o.ENDPOINTS_EXTERNAL_RELATIONSHIP_WITH_ASSET,r={},i={},c={"Content-type":"application/json"};return e.sendGet(s,r,i,c,function(e){if(200==e.code){n.debug("Get getRelationshipWithAsset: ",e.data);var t=[];n.debug("largo: ",e.data.length);for(var o=0;o<e.data.length;o++)t.push(e.data[o]);a.resolve(t)}else{n.error("Error getRelationshipWithAsset: "+e.message);var t={};t.code=e.code,t.message=e.message,e.analyticsCode?t.analyticsCode=e.analyticsCode:t.analyticsCode="ERR999",a.reject(t)}},function(e){n.error("Error getRelationshipWithAsset: "+e);var t={};e[0]?(t.code=e[0].errorCode,t.message=e[0].message,e[0].analyticsCode?t.analyticsCode=e[0].analyticsCode:t.analyticsCode="ERR999"):e.code?(t.code=e.code,t.message=e.message,e.analyticsCode?t.analyticsCode=e.analyticsCode:t.analyticsCode="ERR999"):e.data?(t.code=e.data.status,t.message=e.data.msg,e.data.analyticsCode?t.analyticsCode=e.data.analyticsCode:t.analyticsCode="ERR999"):(t.code="400",t.message=e,t.analyticsCode="ERR999"),a.reject(t)}),a.promise},pub}]),angular.module("CoreModule").service("PopupService",["$ionicModal","$ionicLoading","$route","UTILS_CONFIG","ENDPOINTS",function(e,a,t,o,n){return{openModal:function(n,s,r,i,c){var l="views/Modals/"+n+"Modal.html";c&&(i.closeModal=c),e.fromTemplateUrl(l,{scope:i,animation:"help"==n?"slide-in-up":"fade"}).then(function(e){a.hide(),i.modal=e,i.modal.title=s,i.modal.content=r,"iframe"===n?(a.show({template:o.STYLE_IONICLOADING_TEMPLATE}),i.modal.show()):"payment"===n?(a.show({template:o.STYLE_IONICLOADING_TEMPLATE}),i.modal.show()):(i.modal.show(),a.hide(),t.reload())})}}}]),angular.module("CoreModule").service("DataMapService",function(){var e=[];return{setItem:function(a,t){if(a)return e[a]=t,t;throw"setItem: key and value is needed"},getItem:function(a,t){if(!a)throw"getItem: key is needed";if(void 0!==e[a])return e[a];if(t)return null;throw"Item not found"},deleteItem:function(a){if(!a)throw"deleteItem: key is needed";void 0!==e[a]&&delete e[a]}}}),angular.module("ContactModule",["CoreModule"]),angular.module("ContactModule").factory("ContactService",["ConnectionProvider","SalesforceProvider","$q","ENDPOINTS","$log","LocalStorageProvider",function(e,a,t,o,n,s){return{getBranchesItems:function(){var a=t.defer();if(s.getLocalStorageItem("branches"))a.resolve(s.getLocalStorageItem("branches"));else{var r=o.ENDPOINTS_BASE_EXTERNAL+o.ENDPOINTS_BRACNHES,i={},c={},l={"Content-type":"application/json"},d={},m=[],u=[];e.sendGet(r,i,c,l,function(e){if(200==e.code){n.debug("Get Data: ",e);for(var t=0;t<e.data.length;t++){var o={index:t,titulo:e.data[t].titulo,tipo:e.data[t].tipo,latitud:e.data[t].latitud,longitud:e.data[t].longitud,direccion:e.data[t].direccion,detalle:e.data[t].detalle,horario_apertura:e.data[t].horaApertura,horario_pago:e.data[t].horaPago,horario_especial:e.data[t].horaEspecial,imagen:e.data[t].imagen};n.debug("obj: ",o),"01"==o.tipo?m.push(o):u.push(o)}d.branches=m,d.paymentPlaces=u,s.setLocalStorageItem("branches",d);var r="";try{r=moment().format("MM/DD/YYYY")}catch(e){var i=new Date,c=i.getDate(),l=i.getMonth()+1,E=i.getFullYear();c<10&&(c="0"+c),l<10&&(l="0"+l),i=l+"/"+c+"/"+E,r=i}s.setLocalStorageItem("last_request_sf_time_branches",r),a.resolve(d)}else{n.error("Get Data: "+e.message);var o={};o.code=e.code,o.message=e.message,e.analyticsCode?o.analyticsCode=e.analyticsCode:o.analyticsCode="ERR999",a.reject(o)}},function(e){n.error("Get Data: "+e);var t={};e[0]?(t.code=e[0].errorCode,t.message=e[0].message,e[0].analyticsCode?t.analyticsCode=e[0].analyticsCode:t.analyticsCode="ERR999"):e.code?(t.code=e.code,t.message=e.message,e.analyticsCode?t.analyticsCode=e.analyticsCode:t.analyticsCode="ERR999"):e.data?(t.code=e.data.status,t.message=e.data.msg,e.data.analyticsCode?t.analyticsCode=e.data.analyticsCode:t.analyticsCode="ERR999"):(t.code="400",t.message=e,t.analyticsCode="ERR999"),a.reject(t)})}return a.promise},setContactForm:function(a,s,r,i,c,l,d,m,u){var E=t.defer(),_=o.ENDPOINTS_BASE_EXTERNAL+o.ENDPOINTS_EXTERNAL_SETCONTACT,g={bean:{numeroSuministro:a,asunto:s,rut:r,nombres:i,apellidoPaterno:c,email:l,telefonoPrimario:d,telefonoSecundario:m,descripcion:u}},S={},A={"Content-type":"application/json"};return e.sendPost(_,S,g,A,function(e){if(200==e.code)n.debug("Set Contact: ",e),E.resolve(e);else{n.error("Get Data: "+e.message);var a={};a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999",E.reject(a)}},function(e){n.error("Set Contact: "+e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),E.reject(a)}),E.promise},setContactFormAuth:function(e,s,r){var i=t.defer(),c={};return c.path=o.ENDPOINTS_SETCONTACT,c.method="POST",c.contentType="application/json",c.data={bean:{numeroSuministro:e,asunto:s,descripcion:r}},c.params="",a.request(c).then(function(e){if("200"==e.code.toString())n.debug("Set Contact Auth ",e),i.resolve(e);else{n.error("Error Set Contact Auth: ",e.message);var a={};a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999",i.reject(a)}},function(e){n.error("Error Set Contact Auth: ",e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),i.reject(a)}),i.promise},geocodeLatLng:function(e,a){var o=t.defer(),s=new google.maps.Geocoder,r={lat:parseFloat(e),lng:parseFloat(a)};return s.geocode({location:r},function(e,a){"OK"===a?e[1]?o.resolve(e[0].formatted_address):n.error("No results found"):(n.error("Geocoder failed due to: "+a),o.reject(a))}),o.promise}}}]),angular.module("BillsModule",["CoreModule"]),angular.module("BillsModule").factory("BillsService",["$q","SalesforceProvider","ConnectionProvider","$log","ENDPOINTS","UTILS_CONFIG",function(e,a,t,o,n,s){return{setEnterReading:function(t,s,r,i,c){var l=e.defer(),d={};return d.path=n.ENDPOINTS_ENTER_READING,d.method="POST",d.contentType="application/json",d.data=null==s||""==s||null!=r&&""!=r&&null!=i&&""!=i&&null!=c&&""!=c?null!=s&&""!=s||null==r||""==r||null==i||""==i||null==c||""==c?{bean:{numeroSuministro:t}}:{bean:{numeroSuministro:t,lecturaDia:r,lecturaNoche:i,lecturaPunta:c}}:{bean:{numeroSuministro:t,lectura:s}},d.params="",a.request(d).then(function(e){if("200"==e.code.toString())o.debug("setEnterReading ",e.data),l.resolve(e);else{o.error("Error AssetDetail: ",e.message);var a={};a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999",l.reject(a)}},function(e){o.error("Error AssetDetail: ",e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),l.reject(a)}),l.promise},generateXmlPayment:function(a){var t=e.defer();try{var n=s.PAYMENT_TEMPLATE;o.debug("template previo: ",n),n=n.replace("</banco>",s.PAYMENT_ID_BANK+"</banco>"),n=n.replace("</tipoPago>",a.paymentType+"</tipoPago>"),n=n.replace("</monto>",a.amount+"</monto>"),n=n.replace("</fechaVencimiento>",a.expirationDate+"</fechaVencimiento>"),n=n.replace("</fechaEmision>",a.issueDate+"</fechaEmision>"),n=n.replace("</fechaOnClick>",a.onClickDate+"</fechaOnClick>"),n=n.replace("</codigoBarra>",a.barcode+"</codigoBarra>"),n=n.replace("</empresa>",s.PAYMENT_ENTERPRISE+"</empresa>"),n=n.replace("</nombre>",a.name+"</nombre>"),n=n.replace("</rut>",a.rut+"</rut>"),n=n.replace("</mail>",a.email+"</mail>"),o.debug("template post: ",n);var r=CryptoJS.enc.Utf8.parse(n),i=CryptoJS.enc.Base64.stringify(r);o.debug("val: ",i);var c=CryptoJS.enc.Base64.parse(i),l=CryptoJS.enc.Utf8.stringify(c);o.debug("valDecode: ",l),t.resolve(i)}catch(e){var d={};d.code="-1",d.message=e,d.analyticsCode="ERR999",t.reject(d)}return t.promise},generateTemplateBill:function(a,s,r,i){var c=e.defer(),l=n.ENDPOINTS_BASE_EXTERNAL+n.ENDPOINTS_EXTERNAL_ASSET_PROOF_OF_DEBT,d={trxId:a,numeroSuministro:s,email:r,successCode:i},m={},u={"Content-type":"application/json"};return t.sendGet(l,d,m,u,function(e){if(o.debug("Get TemplateBill: ",e),"200"==e.code.toString()){var a={};a.nombreBanco=e.data.nombreBanco,a.numComprobante=e.data.numComprobante,a.codigoBarra=e.data.codigoBarra,a.nombreCliente=e.data.nombreCliente,a.fechaOnClick=e.data.fechaOnClick,a.monto=e.data.monto,a.codigoResultado=e.data.codigoResultado,a.IdTransaccionComercial=e.data.idTransaccionComercial,a.IdTransaccion=e.data.idTransaccion,a.mensaje=e.data.mensaje,o.debug("obj: ",a),c.resolve(a)}else{o.error("Error TemplateBill: "+e.message);var a={};a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999",c.reject(a)}},function(e){o.error("Error TemplateBill: "+e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),c.reject(a)}),c.promise},paymentStatus:function(a){var s=e.defer(),r=n.ENDPOINTS_BASE_EXTERNAL+n.ENDPOINTS_EXTERNAL_ASSET_PAYMENT_STATUS,i={numeroSuministro:a},c={},l={"Content-type":"application/json"};return t.sendGet(r,i,c,l,function(e){if(o.debug("Get PaymentStatus: ",e),"200"==e.code.toString())s.resolve(e.data);else{var a={};a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999",s.reject(a)}},function(e){o.error("Error PaymentStatus: "+e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),s.reject(a)}),s.promise},paymentStatusAuth:function(t){var s=e.defer(),r={};return r.path=n.ENDPOINTS_ASSET_PAYMENT_STATUS,r.method="GET",r.contentType="application/json",r.params={numeroSuministro:t},r.data="",a.request(r).then(function(e){if("200"==e.code.toString())o.debug("PaymentStatus",e),s.resolve(e.data);else{o.error("Error PaymentStatus: ",e.message);var a={};a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999",s.reject(a)}},function(e){o.error("Error PaymentStatus: ",e.message);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),s.reject(a)}),s.promise}}}]);var AnalyticsModule=angular.module("AnalyticsModule",[]);angular.module("AnalyticsModule").value("googleAnalyticsId","UA-73813005-1"),angular.module("AnalyticsModule").factory("GoogleAnalytics",["$log",function(e){function a(t){void 0!==window.analytics?(window.analytics.trackView(t),e.log("Tracked pageview")):setTimeout(function(){a(t)},250)}function t(e,a,o){void 0!==window.analytics?window.analytics.trackEvent(e,a,o):setTimeout(function(){t(e,a,o)},250)}var o={};return o.analyticsRunning=!1,o.isMobile=function(){return!("Macintosh"===navigator.userAgent.match(/Macintosh/i)||"Windows"===navigator.userAgent.match(/Windows/i)||"Unix"===navigator.userAgent.match(/Unix/i))},o.startAnalytics=function(){o.isMobile()&&(void 0!==window.analytics?(window.analytics.startTrackerWithId("UA-73813005-1"),window.analytics.debugMode(),o.analyticsRunning=!0):e.log("Analytics no inicializado"))},o.trackView=function(e){o.isMobile()?a(e):ga("send","screenview",{screenName:e})},o.trackEvent=function(a,n,s){s=s||"",o.isMobile()?t(a,n,s):(ga("send",{hitType:"event",eventCategory:a,eventAction:n,eventLabel:s}),e.log("Tracked event"))},o}]),angular.module("AnalyticsModule").factory("AnalyticsService",["AnalyticsProvider",function(e){return{evento:function(a,t){e.evento(a,t)},pantalla:function(a){e.pantalla(a)}}}]),angular.module("AccessModule",["CoreModule","ngPassword"]),angular.module("AccessModule").factory("AccessService",["ConnectionProvider","SalesforceProvider","$q","ENDPOINTS","$log","SALESFORCE_CONFIG","LocalStorageProvider","$rootScope",function(e,a,t,o,n,s,r,i){return pub={},pub.getDebtData=function(a){var s=t.defer(),r=o.ENDPOINTS_BASE_EXTERNAL+o.ENDPOINTS_DEBT_DATA,i={numeroSuministro:a},c={},l={"Content-type":"application/json"};return e.sendGet(r,i,c,l,function(e){if(n.debug("Get CommercialData: ",e),"200"==e.code.toString()){var a=[];null!=e.data&&e.data.length>0&&angular.forEach(e.data,function(e,t){if(null!=e.nroDocumento&&"0"!=e.nroDocumento.toString()&&"-1"!=e.nroDocumento.toString()){n.debug(t+" : ",e);var o={};o.index=t,o.trxId=e.trxId,o.tipoDocumento=e.tipoDocumento,o.tipoDeuda=e.tipoDeuda,o.publicidad=e.publicidad,o.nroDocumento=e.nroDocumento,o.nombre=e.nombre,o.monto=e.monto,o.mensaje=e.mensaje,o.fechaVencimiento=e.fechaVencimiento,o.fechaEmision=e.fechaEmision,o.estado=e.estado,o.direccion=e.direccion,e.comuna&&(o.comuna=e.comuna,o.direccion=o.direccion+" "+e.comuna),o.consumo=e.consumo,o.codigoBarra=e.codigoBarra,a.push(o)}else n.debug("el elemento ya fue pagado, no se incluira en la lista")}),s.resolve(a)}else{n.error("Error CommercialData: "+e.message);var t={};t.code=e.code,t.message=e.message,e.analyticsCode?t.analyticsCode=e.analyticsCode:t.analyticsCode="ERR999",s.reject(t)}},function(e){n.error("Error CommercialData: "+e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),s.reject(a)}),s.promise},pub.getCommercialData=function(a){var s=t.defer(),r=o.ENDPOINTS_BASE_EXTERNAL+o.ENDPOINTS_COMMERCIAL_DATA,i={numeroSuministro:a},c={},l={"Content-type":"application/json"};return e.sendGet(r,i,c,l,function(e){if(n.debug("Get CommercialData: ",e),"200"==e.code.toString()){var a={};a.codigoBarra=e.data.codigoBarra,a.consumo=e.data.consumo,a.digitoVerificador=e.data.digitoVerificador,a.direccion=e.data.direccion.calle,e.data.direccion.casa&&null!=e.data.direccion.casa&&""!=e.data.direccion.casa&&(a.direccion=a.direccion+" "+e.data.direccion.casa),e.data.direccion.departamento&&null!=e.data.direccion.departamento&&""!=e.data.direccion.departamento&&(a.direccion=a.direccion+" "+e.data.direccion.departamento),e.data.direccion.comuna&&null!=e.data.direccion.comuna&&""!=e.data.direccion.comuna&&(a.comuna=e.data.direccion.comuna,a.direccion=a.direccion+" "+e.data.direccion.comuna),a.estado=e.data.estado,a.fechaEmision=e.data.fechaEmision,a.fechaVencimiento=e.data.fechaVencimiento,a.idSuministro=e.data.idSuministro,a.mensaje=e.data.mensaje,a.monto=e.data.monto,a.nombre=e.data.nombre,a.nroDocumento=e.data.nroDocumento,a.numeroSuministro=e.data.numeroSuministro,a.publicidad=e.data.publicidad,a.tipoDeuda=e.data.tipoDeuda,a.tipoDocumento=e.data.tipoDocumento,a.trxId=e.data.trxId,n.debug("obj: ",a),s.resolve(a)}else{n.error("Error CommercialData: "+e.message);var a={};a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999",s.reject(a)}},function(e){n.error("Error CommercialData: "+e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),s.reject(a)}),s.promise},pub.getLoginServices=function(a,i,c){var l=t.defer(),d=o.ENDPOINTS_BASE_EXTERNAL+o.ENDPOINTS_GET_USER_SESSION,m={},u={bean:{rut:a,password:i}},E={"Content-type":"application/json"};return e.sendPost(d,m,u,E,function(e){if(n.debug("Get User Session: ",e),"200"==e.code.toString()){var t={};t.rut=a,t.password=i,t.userId=e.data.userId,t.telefonoMovil=e.data.telefonoMovil,t.telefonoFijo=e.data.telefonoFijo,t.sessionId=e.data.sessionId,t.notificaciones=e.data.notificaciones,t.activarNotificaciones=e.data.activarNotificaciones,t.nombre=e.data.nombre,t.email=e.data.email,t.contactId=e.data.contactId,t.apellidoPaterno=e.data.apellidoPaterno,t.apellidoMaterno=e.data.apellidoMaterno,r.setLocalStorageItem("USER_DATA",t),s.accessToken=t.sessionId,s.loginURL=o.ENDPOINTS_SALESFORCE,s.proxyURL=o.ENDPOINTS_SALESFORCE,r.setLocalStorageItem("SALESFORCE_CONFIG",s),force.init(s),l.resolve(t)}else{n.error("Error CommercialData: "+e.message);var t={};t.code=e.code,t.message=e.message,e.analyticsCode?t.analyticsCode=e.analyticsCode:t.analyticsCode="ERR999",l.reject(t)}},function(e){n.error("Error CommercialData: "+e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),l.reject(a)}),l.promise},pub.getLogout=function(){try{force.discardToken();var e=[];e.push("branches"),e.push("no_session_client_number"),e.push("no_session_form_data"),e.push("pass_tuto"),e.push("show_rotate_icon"),e.push("app_version"),r.removeLocalStorageItemExcept(e),s.accessToken="",i.isLogged=!1}catch(e){n.error("err: ",e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),defer.reject(a)}},pub.changePasswordNoAuth=function(a,s,r,i){var c=t.defer(),l=o.ENDPOINTS_BASE_EXTERNAL+o.ENDPOINTS_EXTERNAL_CHANGE_PASS,d={bean:{rut:a,newPassword:s,verifyNewPassword:r,code:i.toString()}},m={},u={"Content-type":"application/json"};return e.sendPost(l,m,d,u,function(e){if(n.debug("Get User Session: ",e),"200"==e.code.toString())c.resolve(e);else{n.error("Error changePasswordNoAuth: ",e.message);var a={};a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999",c.reject(a)}},function(e){n.error("Error changePasswordNoAuth: "+e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),c.reject(a)}),c.promise},pub.requestPasswordChangeCode=function(a){
var s=t.defer(),r=o.ENDPOINTS_BASE_EXTERNAL+o.ENDPOINTS_EXTERNAL_CODE_REQUEST,i={rut:a},c={},l={"Content-type":"application/json"};return e.sendGet(r,i,c,l,function(e){if(n.debug("Get User Session: ",e),"200"==e.code.toString())s.resolve(e.data);else{n.error("Error requestPasswordChangeCode: ",e.message);var a={};a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999",s.reject(a)}},function(e){n.error("Error requestPasswordChangeCode: ",e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),s.reject(a)}),s.promise},pub.registerUser=function(a){var s=t.defer(),r=o.ENDPOINTS_BASE_EXTERNAL+o.ENDPOINTS_EXTERNAL_REGISTRY_USER,i={bean:a},c={},l={"Content-type":"application/json"};return e.sendPost(r,c,i,l,function(e){if(n.debug("Get User Session: ",e),"200"==e.code.toString())s.resolve(e.data);else{n.error("Error registerUser: ",e.message);var a={};a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999",s.reject(a)}},function(e){n.error("Error changePasswordNoAuth: "+e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),s.reject(a)}),s.promise},pub.validateUser=function(a,s){var r=t.defer(),i=o.ENDPOINTS_BASE_EXTERNAL+o.ENDPOINTS_EXTERNAL_ACTIVATE_ACCOUNT,c={bean:{verificationCode:s.toString(),userId:a}},l={},d={"Content-type":"application/json"};return e.sendPost(i,l,c,d,function(e){if(n.debug("Get User Session: ",e),"200"==e.code.toString())r.resolve(e.data);else{n.error("Error registerUser: ",e.message);var a={};a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999",r.reject(a)}},function(e){n.error("Error changePasswordNoAuth: "+e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message,e[0].analyticsCode?a.analyticsCode=e[0].analyticsCode:a.analyticsCode="ERR999"):e.code?(a.code=e.code,a.message=e.message,e.analyticsCode?a.analyticsCode=e.analyticsCode:a.analyticsCode="ERR999"):e.data?(a.code=e.data.status,a.message=e.data.msg,e.data.analyticsCode?a.analyticsCode=e.data.analyticsCode:a.analyticsCode="ERR999"):(a.code="400",a.message=e,a.analyticsCode="ERR999"),r.reject(a)}),r.promise},pub}]),angular.module("AnalyticsModule").factory("AnalyticsProvider",["$http","$cordovaDevice","$rootScope","ENDPOINTS","ANALYTICS_CONFIG",function(e,a,t,o,n,s){function r(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var t=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===a?t:3&t|8).toString(16)})}var i=r();return{evento:function(s,c){s=force.isAuthenticated()?t.translation.WITH_SESSION+" - "+s:t.translation.WITHOUT_SESSION+" - "+s;var l;try{l=a.getPlatform()}catch(e){l="Web"}i||(i=r());var d={method:"GET",url:o.ENDPOINTS_ANALYTICS,params:{cid:i,v:1,tid:n.ID_ANALYTICS,t:"event",an:n.APP_NAME,av:t.appVersion,aid:n.APP_ID,aiid:l,ec:s,ea:c}};e(d)},pantalla:function(s){var c;try{c=a.getPlatform()}catch(e){c="Web"}i||(i=r());var l={method:"GET",url:o.ENDPOINTS_ANALYTICS,params:{cid:i,v:1,tid:n.ID_ANALYTICS,t:"screenview",an:n.APP_NAME,av:t.appVersion,aid:n.APP_ID,aiid:c,cd:s}};e(l)}}}]),angular.module("CoreModule").provider("SalesforceProvider",function(){return{$get:["$log","$q","ConnectionProvider","SALESFORCE_CONFIG","$rootScope","$cordovaNetwork","$ionicPlatform",function(e,a,t,o,n,s,r){var i=function(t){var o=a.defer(),n=_.uniqueId();return e.debug("Salesforce apexrest id::",n),force.apexrest(t,function(a){e.debug("Success in Salesforce apexrest id::",n),o.resolve(a)},function(a){err[0]&&"INVALID_SESSION_ID"==err[0].errorCode||(e.error("Error in salesforce apexrest id::",n),e.error("error::",a),o.reject(a))}),o.promise},c=function(o){var n=a.defer(),i=_.uniqueId();return e.debug("Salesforce request id::",i),force.request(o,function(a){e.debug("Success in Salesforce request id::",i),n.resolve(a)},function(a){a[0]&&"INVALID_SESSION_ID"==a[0].errorCode?t._recoverySessionId().then(function(a){force.request(o,function(a){e.debug("Success in Salesforce request id::",i),n.resolve(a)},function(a){a=window.cordova&&r.is("android")&&s.getNetwork()&&"none"==s.getNetwork()?l(a):window.cordova&&r.is("ios")&&s.getNetwork()&&"none"==s.getNetwork()?l(a):d(a),e.error("Error in salesforce request id::",i),e.error("error::",a),n.reject(a)})},function(a){a=window.cordova&&r.is("android")&&s.getNetwork()&&"none"==s.getNetwork()?l(a):window.cordova&&r.is("ios")&&s.getNetwork()&&"none"==s.getNetwork()?l(a):d(a),e.error("Error in salesforce request id::",i),e.error("error::",a),n.reject(a)}):(a=window.cordova&&r.is("android")&&s.getNetwork()&&"none"==s.getNetwork()?l(a):window.cordova&&r.is("ios")&&s.getNetwork()&&"none"==s.getNetwork()?l(a):d(a),e.error("Error in salesforce request id::",i),e.error("error::",a),n.reject(a))}),n.promise},l=function(e){return m},d=function(e){return null==e.data?e=u:null==e.data.data&&null==e.data.code&&null==e.data.message&&(e=u),e},m={data:{status:"-1",msg:"Sin conexión a Internet. Verifica tu equipo e intenta nuevamente.",message:"Sin conexión a Internet. Verifica tu equipo e intenta nuevamente.",code:-1},status:-1,code:-1,msg:"Sin conexión a Internet. Verifica tu equipo e intenta nuevamente.",message:"Sin conexión a Internet. Verifica tu equipo e intenta nuevamente."},u={data:{status:"408",msg:"En estos momentos no es posible procesar la solicitud, por favor inténtalo más tarde.",message:"En estos momentos no es posible procesar la solicitud, por favor inténtalo más tarde.",code:408},status:408,code:408,msg:"En estos momentos no es posible procesar la solicitud, por favor inténtalo más tarde.",message:"En estos momentos no es posible procesar la solicitud, por favor inténtalo más tarde."};return{apexrest:i,request:c}}]}}),angular.module("CoreModule").provider("LocalStorageProvider",function(){return{$get:["$rootScope","$window","$log","UTILS_CONFIG",function(e,a,t,o){var n=function(e){var t=a.localStorage.getItem(e);if(t){var n;if(o.ENABLE_ENCRYPTION_LOCALSTORAGE)var s=CryptoJS.AES.decrypt(t,o.SECRET_KEY_ENCRYPTION),n=s.toString(CryptoJS.enc.Utf8);else n=t;return m(n)?JSON.parse(n):n}return null},s=function(e,n){if(e){var s;m(n)?(s=o.ENABLE_ENCRYPTION_LOCALSTORAGE?CryptoJS.AES.encrypt(JSON.stringify(n),o.SECRET_KEY_ENCRYPTION):JSON.stringify(n),a.localStorage.setItem(e,s)):(s=o.ENABLE_ENCRYPTION_LOCALSTORAGE?CryptoJS.AES.encrypt(n,o.SECRET_KEY_ENCRYPTION):n,a.localStorage.setItem(e,s))}else t.error("Key not found: ",e)},r=function(e){e?a.localStorage.getItem(e)?a.localStorage.removeItem(e):t.error("Key not found. ",e):t.error("Key not found: ",e)},i=function(e){if(e)for(var o in a.localStorage)-1==e.indexOf(o)?a.localStorage.removeItem(o):t.debug("no elimina la llave: ",o)},c=function(e){if(e)for(var o in a.localStorage)_.startsWith(o.toString(),e.toString())?a.localStorage.removeItem(o):t.debug("no elimina la llave: ",o)},l=function(){for(var e in a.localStorage)t.debug("localstorage: ",e)},d=function(e){!0===e&&a.localStorage.clear()},m=function(e){if("object"==typeof e)return!0;try{var a=JSON.parse(e);if(a&&"object"==typeof a)return!0}catch(e){}return!1};return{getLocalStorageItem:n,getAllLocalStorageItems:l,setLocalStorageItem:s,removeLocalStorageItem:r,removeLocalStorageItemExcept:i,removeLocalStorageIfStartWith:c,clearLocalStorage:d}}]}}),angular.module("CoreModule").provider("ConnectionProvider",function(){var e=[];return Object.toparams=function(e){var a=[];for(var t in e)a.push(t+"="+encodeURIComponent(e[t]));return a.join("&")},{$get:["$rootScope","$http","$log","$q","ENDPOINTS","LocalStorageProvider","SALESFORCE_CONFIG","$state","PopupService","$cordovaNetwork","$ionicPlatform",function(a,t,o,n,s,r,i,c,l,d,m){function u(){var e=n.defer(),t={};if(r.getLocalStorageItem("USER_DATA")){var s=r.getLocalStorageItem("USER_DATA");E(s.rut,s.password).then(function(a){e.resolve()},function(n){if(n.code&&"400"===n.code){t.error=n.code,t.message=n.message,e.reject(t);var s=a.translation.ERROR_MODAL_TITLE,d=n.message+". "+a.translation.LOGOUT_PROCEED;l.openModal("error",s,d,a,function(){a.modal.remove().then(function(){a.modal=null;try{force.discardToken();var e=[];e.push("branches"),e.push("no_session_client_number"),e.push("no_session_form_data"),e.push("pass_tuto"),e.push("show_rotate_icon"),e.push("app_version"),r.removeLocalStorageItemExcept(e),i.accessToken="",a.isLogged=!1,c.go("guest.home")}catch(e){o.error("err: ",e),c.go("guest.home")}})})}})}else{var t={};t.code="-1",t.message="NO SESSION ID",e.reject(t)}return e.promise}function E(e,a){var t=n.defer(),c=s.ENDPOINTS_BASE_EXTERNAL+s.ENDPOINTS_GET_USER_SESSION,l={},d={bean:{rut:e,password:a}},m={"Content-type":"application/json"},u={};return f(c,l,d,m,function(e){o.debug("Get User Session: ",e),"200"==e.code.toString()?(r.getLocalStorageItem("USER_DATA")&&(u=r.getLocalStorageItem("USER_DATA")),u.sessionId=e.data.sessionId,r.setLocalStorageItem("USER_DATA",u),i.accessToken=u.sessionId,i.loginURL=s.ENDPOINTS_SALESFORCE,i.proxyURL=s.ENDPOINTS_SALESFORCE,r.setLocalStorageItem("SALESFORCE_CONFIG",i),force.init(i),t.resolve(u)):(o.error("Error CommercialData: "+e.message),u.code=e.code,u.message=e.message,t.reject(u))},function(e){o.error("Error CommercialData: "+e);var a={};e[0]?(a.code=e[0].errorCode,a.message=e[0].message):e.code?(a.code=e.code,a.message=e.message):e.data?(a.code=e.data.status,a.message=e.data.msg):(a.code="400",a.message=e),t.reject(a)}),t.promise}var g=function(a,r,i,c,l,E,g){var T=_.uniqueId();o.debug("["+T+"] REQUEST "+g,a);var f=n.defer();f.promise.then(function(e){l(e)},function(e){E(e)}),c={"Content-type":"application/json","Accept-Language":"es-ES,en-ES"};var C={method:g,responseType:"json",url:a,headers:c,params:r,data:JSON.stringify(i),timeout:s.SETUP.TIMEOUT};if(_.findIndex(e,C),!1)return!1;try{e.push(C),t(C).then(function(t){e=_.drop(e,C),o.groupCollapsed("["+T+"] RESULT REQUEST "+g.toUpperCase()+"["+a+"]"),o.debug("Params: ",r),o.debug("Data: ",i),o.debug("Response: ",t),o.groupEnd(),t=window.cordova&&m.is("android")&&d.getNetwork()&&"none"==d.getNetwork()?S(t):window.cordova&&m.is("ios")&&d.getNetwork()&&"none"==d.getNetwork()?S(t):A(t),f.resolve(t.data)},function(n){e=_.drop(e,C),o.groupCollapsed("["+T+"] ERROR REQUEST "+g.toUpperCase()+" ["+a+"]"),o.error("Params: ",r),o.error("Data: ",i),o.error("Response: ",n),o.groupEnd(),n=window.cordova&&m.is("android")&&d.getNetwork()&&"none"==d.getNetwork()?S(n):window.cordova&&m.is("ios")&&d.getNetwork()&&"none"==d.getNetwork()?S(n):A(n),n[0]&&"INVALID_SESSION_ID"==n[0].errorCode?u().then(function(n){t(C).then(function(t){e=_.drop(e,C),o.groupCollapsed("["+T+"] RESULT REQUEST "+g.toUpperCase()+"["+a+"]"),o.debug("Params: ",r),o.debug("Data: ",i),o.debug("Response: ",t),o.groupEnd(),t=window.cordova&&m.is("android")&&d.getNetwork()&&"none"==d.getNetwork()?S(t):window.cordova&&m.is("ios")&&d.getNetwork()&&"none"==d.getNetwork()?S(t):A(t),f.resolve(t.data)},function(t){e=_.drop(e,C),o.groupCollapsed("["+T+"] ERROR REQUEST "+g.toUpperCase()+" ["+a+"]"),o.error("Params: ",r),o.error("Data: ",i),o.error("Response: ",t),o.groupEnd(),t=window.cordova&&m.is("android")&&d.getNetwork()&&"none"==d.getNetwork()?S(t):window.cordova&&m.is("ios")&&d.getNetwork()&&"none"==d.getNetwork()?S(t):A(t),f.reject(t)})},function(e){f.reject(e)}):f.reject(n),f.reject(n)})}catch(e){f.reject(e)}return f.promise},S=function(e){return R},A=function(e){return null==e.data?e=O:null==e.data.data&&null==e.data.code&&null==e.data.message&&(e=O),e},T=function(a,r,i,c,l,u,E){var g=_.uniqueId();o.debug("["+g+"] REQUEST "+E,a);var T=n.defer();T.promise.then(function(e){l(e)},function(e){u(e)});var f={method:E,url:a,headers:c,params:r,data:Object.toparams(i),timeout:s.SETUP.TIMEOUT};if(_.findIndex(e,f),!1)return!1;try{e.push(f),t(f).then(function(t){e=_.drop(e,f),o.groupCollapsed("["+g+"] RESULT REQUEST "+E.toUpperCase()+"["+a+"]"),o.debug("Params: ",r),o.debug("Data: ",i),o.debug("Response: ",t),o.groupEnd(),t=window.cordova&&m.is("android")&&d.getNetwork()&&"none"==d.getNetwork()?S(t):window.cordova&&m.is("ios")&&d.getNetwork()&&"none"==d.getNetwork()?S(t):A(t),T.resolve(t.data)},function(t){e=_.drop(e,f),o.groupCollapsed("["+g+"] ERROR REQUEST "+E.toUpperCase()+" ["+a+"]"),o.error("Params: ",r),o.error("Data: ",i),o.error("Response: ",t),o.groupEnd(),t=window.cordova&&m.is("android")&&d.getNetwork()&&"none"==d.getNetwork()?S(t):window.cordova&&m.is("ios")&&d.getNetwork()&&"none"==d.getNetwork()?S(t):A(t),T.reject(t)})}catch(e){T.reject(e)}return T.promise},f=function(e,a,t,o,n,s){g(e,a,t,o,n,s,"POST")},C=function(e,a,t,o,n,s){g(e,a,t,o,n,s,"GET")},p=function(e,a,t,o,n,s){g(e,a,t,o,n,s,"PUT")},I=function(e,a,t,o,n,s){g(e,a,t,o,n,s,"DELETE")},N=function(e,a,t,o,n,s){T(e,a,t,o,n,s,"POST")},R={data:{status:"-1",msg:"Sin conexión a Internet. Verifica tu equipo e intenta nuevamente.",message:"Sin conexión a Internet. Verifica tu equipo e intenta nuevamente.",code:-1},status:-1,code:-1,msg:"Sin conexión a Internet. Verifica tu equipo e intenta nuevamente.",message:"Sin conexión a Internet. Verifica tu equipo e intenta nuevamente."},O={data:{status:"408",msg:"En estos momentos no es posible procesar la solicitud, por favor inténtalo más tarde.",message:"En estos momentos no es posible procesar la solicitud, por favor inténtalo más tarde.",code:408},status:408,code:408,msg:"En estos momentos no es posible procesar la solicitud, por favor inténtalo más tarde.",message:"En estos momentos no es posible procesar la solicitud, por favor inténtalo más tarde."};return{sendPost:f,sendPut:p,sendDelete:I,sendGet:C,sendPostForm:N,_recoverySessionId:u}}]}}),angular.module("ProfileModule",["CoreModule"]),angular.module("LocationsModule",["CoreModule"]),angular.module("appenel").directive("validateFormFocus",["$timeout",function(e){return{restrict:"A",link:function(e,a){a.on("submit",function(){var e=a[0].querySelector(".ng-invalid");e&&e.focus()})}}}]),angular.module("appenel").directive("paymenturlload",["ENDPOINTS","$ionicLoading",function(e,a){return{restrict:"A",link:function(t,o,n){o.bind("load",function(){if(a.hide(),o[0].contentDocument){var n=o[0].contentDocument.URL;_.includes(n,e.ENDPOINTS_PAYMENT_SUCCESS)&&t.generateTemplateBill("successPayment",n),_.includes(n,e.ENDPOINTS_PAYMENT_ERROR)&&t.generateTemplateBill("info",n)}})}}}]),angular.module("appenel").directive("passwordValidator",function(){return{require:"ngModel",restrict:"A",link:function(e,a,t,o){function n(e){return/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).+$/.test(e)?o.$setValidity("passwordFormat",!0):o.$setValidity("passwordFormat",!1),e}o.$parsers.push(n)}}}),angular.module("appenel").directive("onLongPress",["$timeout",function(e){return{restrict:"A",link:function(a,t,o){t.bind("touchstart",function(t){a.longPress=!0,e(function(){a.longPress&&a.$apply(function(){a.$eval(o.onLongPress)})},600)}),t.bind("touchend",function(e){a.longPress=!1,o.onTouchEnd&&a.$apply(function(){a.$eval(o.onTouchEnd)})})}}}]),angular.module("appenel").directive("notification",["$state",function(e){return{restrict:"A",link:function(a,t,o){t.on("click",function(){e.go("session.notification")})}}}]),angular.module("appenel").directive("iframeurlload",["ENDPOINTS","$ionicLoading",function(e,a){return{restrict:"A",link:function(e,t,o){t.bind("load",function(){a.hide(),t[0]&&t[0].contentDocument&&t[0].contentDocument.getElementById("buscador")&&(t[0].contentDocument.getElementById("buscador").style.width="100%",t[0].contentDocument.getElementById("buscador").style.height="100%")})}}}]),angular.module("appenel").directive("hideKeyboardOnSubmit",["$timeout",function(e){return{restrict:"A",link:function(e,a){a.on("submit",function(){a[0].querySelector("input").blur()})}}}]),angular.module("appenel").directive("onloadSubmitForm",["$timeout",function(e){return{scope:{callBack:"&iframeOnload"},link:function(a,t,o){t.bind("load",function(e){}),e(function(){t[0].submit()},500)}}}]),angular.module("appenel").directive("buttonId",function(){return{restrict:"A",link:function(e,a,t){a.bind("click",function(){e.buttons.chosen=t.buttonId})}}}),angular.module("appenel").directive("assetValidator",function(){return{require:"ngModel",restrict:"A",link:function(e,a,t,o){function n(e){return/^(?=(?:\D*\d){2})[a-zA-Z0-9]*$/.test(e)?o.$setValidity("twoNumbersValidator",!0):o.$setValidity("twoNumbersValidator",!1),/^\d+/.test(e)?o.$setValidity("startWithNumberValidator",!0):o.$setValidity("startWithNumberValidator",!1),e}o.$parsers.push(n)}}}),angular.module("appenel").directive("assetFormat",["$log",function(e){return{require:"ngModel",restrict:"A",link:function(a,t,o,n){t.bind("blur",function(){null!=n.$viewValue&&""!=n.$viewValue&&"undefined"!=n.$viewValue&&(n.$viewValue.indexOf("-")<0?n.$viewValue=n.$viewValue.substring(0,n.$viewValue.length-1)+"-"+n.$viewValue.substring(n.$viewValue.length-1,n.$viewValue.length):(e.debug("se eliminaran todos los guiones y se reemplazaran por uno nuevo al final del texto"),n.$viewValue=n.$viewValue.split("-").join(""),n.$viewValue=n.$viewValue.substring(0,n.$viewValue.length-1)+"-"+n.$viewValue.substring(n.$viewValue.length-1,n.$viewValue.length)),n.$render())})}}}]),angular.module("UsageModule").controller("usageCtrl",["$scope","$state","$stateParams","$route","$window","$ionicSlideBoxDelegate","UsageService","$rootScope","$log","$ionicModal","$ionicLoading","DataMapService","PopupService","AccessService","PopupService","$q","AnalyticsService","UtilsService","LocalStorageProvider","UTILS_CONFIG","BillsService","$ionicScrollDelegate",function(e,a,t,o,n,s,r,i,c,l,d,m,u,E,u,g,S,A,T,f,C,p){function I(){c.debug("ancho de pantalla: ",n.innerWidth),c.debug("alto de pantalla: ",n.innerHeight),n.innerWidth<n.innerHeight?e.innerHeightDevice=n.innerWidth:e.innerHeightDevice=n.innerHeight,c.debug("alto de grafico: ",e.innerHeightDevice),e.innerHeightDevice=e.innerHeightDevice-160,c.debug("nuevo alto de grafico: ",e.innerHeightDevice)}e.forms={},e.orientation,e.selectedTab=0,e.tab0selected=!0,e.tab1selected=!1,e.tab2selected=!1,e.tab3selected=!1,e.selectedIdex=0,e.selectedAssetNumber=0,e.selectedAssetNumberDv="",e.selectedAssetAddress="",e.selectedAssetState="",e.actualIndex=0,e.flagChangeTab=0,e.orientaAnt=0,e.showRotateIcon=i.showRotateIcon,e.UTILS_CONFIG=f,e.showAssetDebt=!1,e.showLoadingDebt=!0,e.showRetryDebt=!1,e.activeSlide=0,e.innerHeightDevice=0,e.sendAnalytics=function(e,a){S.evento(e,a)},e.changeTab=function(a){switch(c.debug("changetab"),e.tab0selected=!1,e.tab1selected=!1,e.tab2selected=!1,e.tab3selected=!1,a){case 0:D(),S.evento(i.translation.PAGE_USAGE,i.translation.GA_PUSH_PAGE_USAGE_OVERVIEW),S.pantalla(i.translation.PAGE_USAGE_OVERVIEW),p.scrollTop(),i.tabActualAnalytics=i.translation.PAGE_USAGE_OVERVIEW,e.tab0selected=!0,R(e.selectedIdex),O(e.selectedIdex);break;case 1:D(),S.evento(i.translation.PAGE_USAGE,i.translation.GA_PUSH_PAGE_USAGE_USAGES),S.pantalla(i.translation.PAGE_USAGE_USAGES),p.scrollTop(),i.tabActualAnalytics=i.translation.PAGE_USAGE_USAGES,e.tab1selected=!0,L(e.selectedIdex);break;case 2:D(),S.evento(i.translation.PAGE_USAGE,i.translation.GA_PUSH_PAGE_USAGE_BILLS),S.pantalla(i.translation.PAGE_USAGE_BILLS),p.scrollTop(),i.tabActualAnalytics=i.translation.PAGE_USAGE_BILLS,e.tab2selected=!0,v(e.selectedIdex);break;case 3:D(),S.evento(i.translation.PAGE_USAGE,i.translation.GA_PUSH_PAGE_USAGE_PAYMENTS),S.pantalla(i.translation.PAGE_USAGE_PAYMENTS),p.scrollTop(),i.tabActualAnalytics=i.translation.PAGE_USAGE_PAYMENTS,e.tab3selected=!0,P(e.selectedIdex);break;default:S.evento(i.translation.PAGE_USAGE,i.translation.GA_PUSH_PAGE_USAGE_OVERVIEW),S.pantalla(i.translation.PAGE_USAGE_OVERVIEW),i.tabActualAnalytics=i.translation.PAGE_USAGE_OVERVIEW,p.scrollTop(),e.tab0selected=!0,e.selectedIdex=0,O(e.selectedIdex)}e.selectedTab=a},e.dataUsageAssetList={},e.dataUsageAssetList.items=[];var N=function(){g.defer();d.show({template:f.STYLE_IONICLOADING_TEMPLATE}),r.getAssetList().then(function(a){if(a.length>0)T.getLocalStorageItem("asset_list_is_new_request")&&"true"===T.getLocalStorageItem("asset_list_is_new_request")&&(e.activeSlide=0),s.slide(e.activeSlide),e.dataUsageAssetList.items=a,s.update(),d.hide(),e.changeTab(0);else{c.error("No data"),d.hide(),S.evento(i.translation.PAGE_USAGE_OVERVIEW,i.translation.GA_ERROR_SERVICES_RESPONSE+"-"+i.translation.GET_ASSETS_LIST+"-"+i.translation.NO_DATA);var t=i.translation.ATTENTION_MODAL_TITLE,o=i.translation.NO_DATA;u.openModal("info",t,o,e)}},function(a){c.error("Error AssetList: ",a),d.hide(),S.evento(i.translation.PAGE_USAGE_OVERVIEW,i.translation.GA_ERROR_SERVICES_RESPONSE+"-"+i.translation.GET_ASSETS_LIST+"-"+a.message+"-"+a.analyticsCode);var t="error";a.code&&a.code.toString()==f.ERROR_INFO_CODE&&(t="info");var o=i.translation.ATTENTION_MODAL_TITLE,n=a.message;u.openModal(t,o,n,e)})};e.dataUsageAssetDebt={},e.dataUsageAssetDebt.items=[],e.dataUsageAssetDebtToShow={};var R=function(a){if(e.showAssetDebt=!1,e.showLoadingDebt=!0,e.showRetryDebt=!1,e.dataUsageAssetList.items.length>0){var t=e.dataUsageAssetList.items[a].numeroSuministro;e.selectedAssetNumber=t,e.selectedAssetNumberDv=e.dataUsageAssetList.items[a].numeroSuministroDv,e.selectedAssetAddress=e.dataUsageAssetList.items[a].direccion,e.dataUsageAssetList.items[a].comuna&&(e.selectedAssetState=e.dataUsageAssetList.items[a].comuna),r.getAssetDebt(t,a).then(function(a){c.debug("reponse debt: ",a),e.dataUsageAssetDebt.items=a;var t={},o={};t=_.find(a,function(e){return e.tipoDeuda===f.PAYMENT_PAYMENTTYPE_1}),_.isEmpty(t)||(o=t),t=_.find(a,function(e){return e.tipoDeuda===f.PAYMENT_PAYMENTTYPE_2}),_.isEmpty(t)||(o=t),t=_.find(a,function(e){return e.tipoDeuda===f.PAYMENT_PAYMENTTYPE_3}),_.isEmpty(t)||(o=t),e.showAssetDebt=!0,e.dataUsageAssetDebtToShow=o,c.debug("dataUsageAssetDebtToShow: ",e.dataUsageAssetDebtToShow),e.showLoadingDebt=!1,e.showRetryDebt=!1,s.update()},function(a){e.showAssetDebt=!1,e.showLoadingDebt=!1,e.showRetryDebt=!0,c.error("Error AssetDebt: ",a),S.evento(i.translation.PAGE_USAGE_OVERVIEW,i.translation.GA_ERROR_SERVICES_RESPONSE+"-"+i.translation.GET_DEBT+"-"+a.message+"-"+a.analyticsCode)})}else{c.error("No data debt with that AssetId");var o=i.translation.ATTENTION_MODAL_TITLE,n=i.translation.NO_DATA;u.openModal("info",o,n,e)}};e.dataUsageAssetDetail={};var O=function(a){if(e.showAssetDetail=!1,e.showLoadingDetail=!0,e.showRetryDetail=!1,e.dataUsageAssetList.items.length>0){var t=e.dataUsageAssetList.items[a].numeroSuministro;e.selectedAssetNumber=t,e.selectedAssetNumberDv=e.dataUsageAssetList.items[a].numeroSuministroDv,e.selectedAssetAddress=e.dataUsageAssetList.items[a].direccion,e.dataUsageAssetList.items[a].comuna&&(e.selectedAssetState=e.dataUsageAssetList.items[a].comuna),r.getAssetDetail(t,a,e.selectedAssetNumberDv,e.selectedAssetAddress).then(function(a){c.debug("reponse detalle: ",a),e.dataUsageAssetDetail=a,e.showAssetDetail=!0,e.showLoadingDetail=!1,e.showRetryDetail=!1,s.update()},function(a){c.error("Error AssetDetail: ",a.message),e.showAssetDetail=!1,e.showLoadingDetail=!1,e.showRetryDetail=!0,S.evento(i.translation.PAGE_USAGE_OVERVIEW,i.translation.GA_ERROR_SERVICES_RESPONSE+"-"+i.translation.GET_ASSET_DETAIL+"-"+a.message+"-"+a.analyticsCode)})}else{c.error("No data details with that AssetId");var o=i.translation.ATTENTION_MODAL_TITLE,n=i.translation.NO_DATA;u.openModal("info",o,n,e)}};e.dataUsageAssetUsage={},e.dataUsageAssetUsage.items=[],e.dataUsageAssetUsage.graphlabels=[],e.dataUsageAssetUsage.graphdata=[],e.dataUsageAssetUsage.graphseries=[];var L=function(a){if(e.dataUsageAssetList.items.length>0){var t=e.dataUsageAssetList.items[a].numeroSuministro;e.selectedAssetNumber=t,e.selectedAssetNumberDv=e.dataUsageAssetList.items[a].numeroSuministroDv,e.selectedAssetAddress=e.dataUsageAssetList.items[a].direccion,e.dataUsageAssetList.items[a].comuna&&(e.selectedAssetState=e.dataUsageAssetList.items[a].comuna),d.show({template:f.STYLE_IONICLOADING_TEMPLATE}),r.getAssetUsage(t,a).then(function(a){e.dataUsageAssetUsage.items=a.items,e.dataUsageAssetUsage.typeUsage=a.typeUsage,e.dataUsageAssetUsage.graphlabels=a.graphlabels,e.dataUsageAssetUsage.graphdata=a.graphdata,e.dataUsageAssetUsage.options=a.options;var t=[];a.typeUsage!=f.USAGE_TYPE_RATE_TYPE_CODE_1?(t.push(i.translation.DAY+"("+i.translation.KWH+")"),t.push(i.translation.NIGHT+"("+i.translation.KWH+")"),t.push(i.translation.PEAK+"("+i.translation.KWH+")")):t.push(i.translation.KWH),e.dataUsageAssetUsage.graphseries=t,s.update(),d.hide()},function(a){c.error("Error AssetUsage: ",a),d.hide(),S.evento(i.translation.PAGE_USAGE_USAGES,i.translation.GA_ERROR_SERVICES_RESPONSE+"-"+i.translation.GET_USAGES_LIST+"-"+a.message+"-"+a.analyticsCode);var t="error";a.code&&a.code.toString()==f.ERROR_INFO_CODE&&(t="info");var o=i.translation.ATTENTION_MODAL_TITLE,n=a.message;u.openModal(t,o,n,e)})}else{c.error("No data usage with that AssetId"),d.hide();var o=i.translation.ATTENTION_MODAL_TITLE,n=i.translation.NO_DATA;u.openModal("info",o,n,e)}};e.dataUsageAssetBills={},e.dataUsageAssetBills.items=[],e.dataUsageAssetBills.graphlabels=[],e.dataUsageAssetBills.graphdata=[],e.dataUsageAssetBills.graphseries=[];var v=function(a){if(e.dataUsageAssetList.items.length>0){var t=e.dataUsageAssetList.items[a].numeroSuministro;e.selectedAssetNumber=t,e.selectedAssetNumberDv=e.dataUsageAssetList.items[a].numeroSuministroDv,e.selectedAssetAddress=e.dataUsageAssetList.items[a].direccion,e.dataUsageAssetList.items[a].comuna&&(e.selectedAssetState=e.dataUsageAssetList.items[a].comuna),d.show({template:f.STYLE_IONICLOADING_TEMPLATE}),r.getAssetBills(t,a).then(function(a){e.dataUsageAssetBills.items=a.items,e.dataUsageAssetBills.graphlabels=a.graphlabels,e.dataUsageAssetBills.graphdata=a.graphdata,e.dataUsageAssetBills.options=a.options;var t=[];t.push(i.translation.AMOUNT),e.dataUsageAssetBills.graphseries=t,s.update(),d.hide()},function(a){c.error("Error AssetBills: ",a),d.hide(),S.evento(i.translation.PAGE_USAGE_BILLS,i.translation.GA_ERROR_SERVICES_RESPONSE+"-"+i.translation.GET_BILLS_LIST+"-"+a.message+"-"+a.analyticsCode);var t="error";a.code&&a.code.toString()==f.ERROR_INFO_CODE&&(t="info");var o=i.translation.ATTENTION_MODAL_TITLE,n=a.message;u.openModal(t,o,n,e)})}else{c.error("No data bills with that AssetId"),d.hide();var o=i.translation.ATTENTION_MODAL_TITLE,n=i.translation.NO_DATA;u.openModal("info",o,n,e)}};e.dataUsageAssetPayments={},e.dataUsageAssetPayments.items=[],e.dataUsageAssetPayments.graphlabels=[],e.dataUsageAssetPayments.graphdata=[],e.dataUsageAssetPayments.graphseries=[];var P=function(a){if(e.dataUsageAssetList.items.length>0){var t=e.dataUsageAssetList.items[a].numeroSuministro;e.selectedAssetNumber=t,e.selectedAssetNumberDv=e.dataUsageAssetList.items[a].numeroSuministroDv,e.selectedAssetAddress=e.dataUsageAssetList.items[a].direccion,e.dataUsageAssetList.items[a].comuna&&(e.selectedAssetState=e.dataUsageAssetList.items[a].comuna),d.show({template:f.STYLE_IONICLOADING_TEMPLATE}),r.getAssetPayments(t,a).then(function(a){e.dataUsageAssetPayments.items=a.items,e.dataUsageAssetPayments.graphlabels=a.graphlabels,e.dataUsageAssetPayments.graphdata=a.graphdata,e.dataUsageAssetPayments.options=a.options;var t=[];t.push(i.translation.AMOUNT),e.dataUsageAssetPayments.graphseries=t,s.update(),d.hide()},function(a){c.error("Error AssetPayments: ",a),d.hide(),S.evento(i.translation.PAGE_USAGE_PAYMENTS,i.translation.GA_ERROR_SERVICES_RESPONSE+"-"+i.translation.GET_PAYMENTS_LIST+"-"+a.message+"-"+a.analyticsCode);var t="error";a.code&&a.code.toString()==f.ERROR_INFO_CODE&&(t="info");var o=i.translation.ATTENTION_MODAL_TITLE,n=a.message;u.openModal(t,o,n,e)})}else{c.error("No data payments with that AssetId"),d.hide();var o=i.translation.ATTENTION_MODAL_TITLE,n=i.translation.NO_DATA;u.openModal("info",o,n,e)}};e.retryDebt=function(){S.evento(i.translation.PAGE_USAGE+" - "+i.tabActualAnalytics,i.translation.GA_PUSH_RETRY_GET_DEBT_ASSET),R(e.selectedIdex)},e.retryDetail=function(){S.evento(i.translation.PAGE_USAGE+" - "+i.tabActualAnalytics,i.translation.GA_PUSH_RETRY_GET_DETAIL_ASSET),O(e.selectedIdex)},e.downloadBill=function(a,t,o){S.evento(i.translation.PAGE_USAGE+" - "+i.tabActualAnalytics,i.translation.GA_PUSH_DOWNLOAD_BILL_DOCUMENT+(a+1));var n=e.dataUsageAssetList.items.length,s=e.dataUsageAssetBills.items.length;if(n>0&&s>0){var l=e.dataUsageAssetList.items[a].numeroSuministro;d.show({template:f.STYLE_IONICLOADING_TEMPLATE});var m=t,E="";if(T.getLocalStorageItem("USER_DATA")){E=T.getLocalStorageItem("USER_DATA").email}var _=o.split("/"),g=_[1];r.getBillByDate(l,m,E,g).then(function(e){d.hide(),window.open(e.url,"_system")},function(a){c.error("Error Get Bill By Date:: ",a),d.hide(),S.evento(i.translation.PAGE_USAGE_BILLS,i.translation.GA_ERROR_SERVICES_RESPONSE+"-"+i.translation.DOWNLOAD_BILL+"-"+a.message+"-"+a.analyticsCode);var t="error";a.code&&a.code.toString()==f.ERROR_INFO_CODE&&(t="info");var o=i.translation.ATTENTION_MODAL_TITLE,n=a.message;u.openModal(t,o,n,e)})}else{c.error("Imposible to get bill by date with that AssetId"),d.hide();var A=i.translation.ATTENTION_MODAL_TITLE,C=i.translation.NO_DATA;u.openModal("info",A,C,e)}},e.payBill=function(){S.evento(i.translation.PAGE_USAGE+" - "+i.tabActualAnalytics,i.translation.GA_PUSH_PAY_BILL),d.show({template:f.STYLE_IONICLOADING_TEMPLATE}),C.paymentStatusAuth(e.selectedAssetNumber).then(function(t){if("N"===t.paymentInProgress.toUpperCase()){var o=e.dataUsageAssetDebtToShow,n=parseInt(o.monto,10);if(c.debug("valor a pagar: ",n),null!=o.monto&&"0"!=o.monto&&n>0){var s={};s.numeroSuministro=e.selectedAssetNumber,s.numeroSuministroDv=e.selectedAssetNumberDv,s.direccion=e.selectedAssetAddress,s.comuna=e.selectedAssetState,s.items=e.dataUsageAssetDebt.items,s.index=e.selectedIdex,m.setItem("payBillObject",s),d.hide(),a.go("session.payBill")}else{d.hide(),c.debug("Error");var r="info",l=i.translation.ATTENTION_MODAL_TITLE,E=i.translation.NO_ACTIVE_DEBT;u.openModal(r,l,E,e)}}else{d.hide();var r="info",l=i.translation.ATTENTION_MODAL_TITLE,E=i.translation.PAYMENT_IN_PROGRESS;u.openModal(r,l,E,e,function(){e.modal.remove().then(function(){e.modal=null})})}},function(a){d.hide(),S.evento(i.translation.PAGE_USAGE_OVERVIEW,i.translation.GA_ERROR_SERVICES_RESPONSE+"-"+i.translation.PAY_BILL+"-"+a.message+"-"+a.analyticsCode);var t="error";a.code&&a.code.toString()==f.ERROR_INFO_CODE&&(t="info");var o=i.translation.ATTENTION_MODAL_TITLE,n=a.message;u.openModal(t,o,n,e,function(){e.modal.remove().then(function(){e.modal=null})})})},e.pagerClick=function(a){e.activeSlide=a,c.debug("se aplica slide button"),e.selectedIdex=a,c.debug("$scope.selectedIdex slide: ",e.selectedIdex),c.debug("anterior: "+e.selectedIdex),c.debug("actual: "+a),s.slide(a)},e.slideHasChanged=function(a){e.activeSlide=a,e.dataUsageAssetDebtToShow.monto=0,e.actualIndex<a?S.evento(i.translation.PAGE_USAGE+" - "+i.tabActualAnalytics,i.translation.GA_SWIPE_RIGHT):S.evento(i.translation.PAGE_USAGE+" - "+i.tabActualAnalytics,i.translation.GA_SWIPE_LEFT),e.actualIndex=a,c.debug("se aplica slide slide"),e.selectedIdex=a,c.debug("$scope.selectedIdex slide: ",e.selectedIdex),D(),s.slide(a),s.update(),e.changeTab(e.selectedTab)};var h=function(){c.debug("orientation change"),
90==n.orientation||-90==n.orientation?(e.orientaAnt-n.orientation>0?(S.evento(i.translation.PAGE_USAGE+" - "+i.tabActualAnalytics,i.translation.GA_ROTATION_RIGHT),e.orientaAnt=n.orientation):(S.evento(i.translation.PAGE_USAGE+" - "+i.tabActualAnalytics,i.translation.GA_ROTATION_LEFT),e.orientaAnt=n.orientation),c.debug("es orientacion horizontal"),e.isHorizontal=!0):(e.orientaAnt-n.orientation>0?(S.evento(i.translation.PAGE_USAGE+" - "+i.tabActualAnalytics,i.translation.GA_ROTATION_RIGHT),e.orientaAnt=n.orientation):(S.evento(i.translation.PAGE_USAGE+" - "+i.tabActualAnalytics,i.translation.GA_ROTATION_LEFT),e.orientaAnt=n.orientation),c.debug("es orientacion vertical"),e.isHorizontal=!1),i.showRotateIcon=!1,T.getLocalStorageItem("show_rotate_icon")||T.setLocalStorageItem("show_rotate_icon","false"),e.showRotateIcon=!1,c.debug("current state: "+a.current.name),o.reload(),p.scrollTop()};n.addEventListener("orientationchange",h),e.goToInsertReading=function(){S.evento(i.translation.PAGE_USAGE,i.translation.GA_PUSH_INSERT_READING),m.setItem("currentUsageIndex",e.selectedIdex),a.go("session.enterReading")},e.closeModal=function(){c.debug("unlogging"),e.modal.hide()},e.goToSendElectronicDocument=function(){S.evento(i.translation.PAGE_USAGE,i.translation.GA_PUSH_SEND_ELECTRONIC_DOCUMENT),c.debug("goToSendElectronicDocument");var t={};t.numeroSuministro=e.selectedAssetNumber,t.numeroSuministroDv=e.selectedAssetNumberDv,t.direccion=e.selectedAssetAddress,t.comuna=e.selectedAssetState,t.index=e.selectedIdex,m.setItem("sendElectronicDoc",t),a.go("session.sendElectronicDoc")};var D=function(){e.dataUsageAssetDetail={},e.dataUsageAssetPayments={},e.dataUsageAssetPayments.items=[],e.dataUsageAssetPayments.graphlabels=[],e.dataUsageAssetPayments.graphdata=[],e.dataUsageAssetPayments.graphseries=["PAGOS"],e.dataUsageAssetBills={},e.dataUsageAssetBills.items=[],e.dataUsageAssetBills.graphlabels=[],e.dataUsageAssetBills.graphdata=[],e.dataUsageAssetBills.graphseries=["BOLETAS"],e.dataUsageAssetUsage={},e.dataUsageAssetUsage.items=[],e.dataUsageAssetUsage.graphlabels=[],e.dataUsageAssetUsage.graphdata=[],e.dataUsageAssetUsage.graphseries=["CONSUMOS"]};e.$on("$locationChangeSuccess",function(e,a){if(a.indexOf("session/usage")>-1){S.pantalla(i.translation.PAGE_USAGE),p.scrollTop(),c.debug("stateChangeSuccess session/usage");I(),D(),N()}})}]),angular.module("NotificationModule").controller("notificationCtrl",["$scope","$rootScope","$log","NotificationService","AnalyticsService","PopupService","UTILS_CONFIG","$ionicLoading","$timeout","$route","$ionicScrollDelegate",function(e,a,t,o,n,s,r,i,c,l,d){function m(){e.items=[],e.showMessageWithoutNotification=!1,i.show({template:r.STYLE_IONICLOADING_TEMPLATE}),o.getNotificationList().then(function(a){i.hide(),a.length>0?(e.items=a,e.showMessageWithoutNotification=!1):e.showMessageWithoutNotification=!0},function(t){i.hide(),n.evento(a.translation.PAGE_NOTIFICATION,a.translation.GA_ERROR_SERVICES_RESPONSE+"-"+a.translation.GET_NOTIFICATION_LIST+"-"+t.message+"-"+t.analyticsCode),e.items=[];var o=a.translation.ATTENTION_MODAL_TITLE,r=t.message;s.openModal("error",o,r,e,function(){e.modal.remove().then(function(){e.modal=null})})})}e.data={showDelete:!1},e.translation=a.translation,e.UTILS_CONFIG=r,e.doRefresh=function(){t.info("Refreshing"),c(function(){m(),e.$broadcast("scroll.refreshComplete")},0)},e.deleteNotification=function(c){n.evento(a.translation.PAGE_NOTIFICATION,a.translation.GA_PUSH_DELETE_NOTIFICATION),t.info("se eliminara el item con taskId: ",c.taskId),t.info("se procedera a marcar como leido el elemento: ",c.taskId),i.show({template:r.STYLE_IONICLOADING_TEMPLATE});var d=r.NOTIFICATION_UPDATE_TYPE_02;o.updateNotification(c,d).then(function(a){i.hide(),e.items=a,l.reload()},function(t){i.hide(),n.evento(a.translation.PAGE_NOTIFICATION,a.translation.GA_ERROR_SERVICES_RESPONSE+"-"+a.translation.DELETE_NOTIFICATION+"-"+t.message+"-"+t.analyticsCode);var o="error";t.code&&t.code.toString()==r.ERROR_INFO_CODE&&(o="info");var c=a.translation.ATTENTION_MODAL_TITLE,l=t.message;s.openModal(o,c,l,e,function(){e.modal.remove().then(function(){e.modal=null})})})},e.openNotification=function(i){n.evento(a.translation.PAGE_NOTIFICATION,a.translation.GA_PUSH_OPEN_NOTIFICATION),t.info("el id seleccionado es: ",i.taskId),t.info("se procedera a marcar como leido el elemento: ",i.taskId);var c=r.NOTIFICATION_UPDATE_TYPE_01;i.status!=r.NOTIFICATION_STATUS_NOTIFICATION_01&&o.updateNotification(i,c).then(function(a){e.items=a,l.reload()},function(e){t.error("error al marcar como leido el elemento: ",e.message),n.evento(a.translation.PAGE_NOTIFICATION,a.translation.GA_ERROR_SERVICES_RESPONSE+"-"+a.translation.MARK_AS_READ_NOTIFICATION+"-"+e.message+"-"+e.analyticsCode)});var d=i.titulo,m=i.mensaje;s.openModal("info",d,m,e,function(){e.modal.remove().then(function(){e.modal=null})})},e.markAsRead=function(c){n.evento(a.translation.PAGE_NOTIFICATION,a.translation.GA_PUSH_MARK_AS_READ_NOTIFICATION),t.info("se procedera a marcar como leido el elemento: ",c.taskId),i.show({template:r.STYLE_IONICLOADING_TEMPLATE});var d=r.NOTIFICATION_UPDATE_TYPE_01;c.status!=r.NOTIFICATION_STATUS_NOTIFICATION_01?o.updateNotification(c,d).then(function(a){i.hide(),e.items=a,l.reload()},function(t){i.hide(),n.evento(a.translation.PAGE_NOTIFICATION,a.translation.GA_ERROR_SERVICES_RESPONSE+"-"+a.translation.MARK_AS_READ_NOTIFICATION+"-"+t.message+"-"+t.analyticsCode);var o="error";t.code&&t.code.toString()==r.ERROR_INFO_CODE&&(o="info");var c=a.translation.ATTENTION_MODAL_TITLE,l=t.message;s.openModal(o,c,l,e,function(){e.modal.remove().then(function(){e.modal=null})})}):i.hide()},e.sendAnalytics=function(e,a){n.evento(e,a)},e.$on("$locationChangeSuccess",function(e,t){t.indexOf("session/notification")>-1&&(n.pantalla(a.translation.PAGE_NOTIFICATION),d.scrollTop(),m())})}]),angular.module("UsageModule").controller("sendElectronicDocCtrl",["$scope","$state","$rootScope","$log","$ionicLoading","PopupService","$q","AnalyticsService","UtilsService","LocalStorageProvider","UTILS_CONFIG","DataMapService","$ionicScrollDelegate",function(e,a,t,o,n,s,r,i,c,l,d,m,u){e.forms={},e.sendAnalytics=function(e,a){i.evento(e,a)};var E=function(){c.getSubjectList().then(function(a){n.hide(),o.debug(),e.listRelationshipWithOwner=a},function(e){n.hide(),i.evento(t.translation.PAGE_CONTACT_FORM,t.translation.GA_ERROR_SERVICES_RESPONSE+"-"+t.translation.GET_SUBJECT_LIST+"-"+e.message+"-"+e.analyticsCode),o.error(e.message)}),e.isLogged=t.isLogged,e.numeroSuministro="",e.numeroSuministroDv="",e.direccion="",e.comuna="";try{var a=m.getItem("sendElectronicDoc");o.debug("sendElectronicDoc: ",a),a&&(e.numeroSuministro=a.numeroSuministro,e.numeroSuministroDv=a.numeroSuministroDv,e.direccion=a.direccion,a.comuna&&(e.comuna=a.comuna),e.index=a.index)}catch(e){o.debug("Error: ",e)}};e.sendElectronicDocConditions=function(){i.evento(t.translation.PAGE_SEND_ELECTRONIC_DOCUMENT,t.translation.GA_PUSH_OPEN_CONDITIONS);var a=t.translation.HELPER_MODAL_TITLE;s.openModal("edeConditions",a,"",e)},e.closeModal=function(){e.modal.remove().then(function(){e.modal=null})};var _=function(){e.forms.sendElectronicDoc.principalEmail.$viewValue="",e.forms.sendElectronicDoc.relationshipWithOwner.$viewValue="",e.forms.sendElectronicDoc.secondaryEmail.$viewValue="",e.forms.sendElectronicDoc.principalEmail.$render(),e.forms.sendElectronicDoc.relationshipWithOwner.$render(),e.forms.sendElectronicDoc.secondaryEmail.$render(),e.forms.sendElectronicDoc.$setPristine()};e.$on("$locationChangeSuccess",function(e,a){if(a.indexOf("session/sendElectronicDoc")>-1){i.pantalla(t.translation.PAGE_SEND_ELECTRONIC_DOCUMENT),u.scrollTop(),o.debug("stateChangeSuccess session/sendElectronicDoc");_(),E()}})}]),angular.module("FeaturedModule").controller("featuredListCtrl",["$scope","$rootScope","$state","FeaturedService","DataMapService","$log","$ionicModal","$ionicLoading","AnalyticsService","PopupService","UTILS_CONFIG","$ionicScrollDelegate",function(e,a,t,o,n,s,r,i,c,l,d,m){e.featuredList=[];var u=function(){i.show({template:d.STYLE_IONICLOADING_TEMPLATE}),o.getFeaturedItems().then(function(a){e.featuredList=a,i.hide()},function(t){s.error("Error: ",t),i.hide(),c.evento(a.translation.PAGE_FEATURED,a.translation.GA_ERROR_SERVICES_RESPONSE+"-"+a.translation.GET_FEATURED_LIST+"-"+t.message+"-"+t.analyticsCode);var o="error";t.code&&t.code.toString()==d.ERROR_INFO_CODE&&(o="info");var n=a.translation.ATTENTION_MODAL_TITLE,r=t.message;l.openModal(o,n,r,e)})};e.featuredDescription=function(o){c.evento(a.translation.PAGE_FEATURED,a.translation.GA_PUSH_FEATURED+": "+(o+1)),n.setItem("featured_detail",e.featuredList[o]),a.isLogged?t.go("session.featuredDescription"):t.go("guest.featuredDescription")},e.closeModal=function(){e.modal.hide()},e.sendAnalytics=function(e,a){c.evento(e,a)},e.$on("$locationChangeSuccess",function(e,t){(t.indexOf("guest/featuredList")>-1||t.indexOf("session/featuredList")>-1)&&(c.pantalla(a.translation.PAGE_FEATURED),m.scrollTop(),u())})}]),angular.module("FeaturedModule").controller("featuredDescriptionCtrl",["$scope","$state","$window","DataMapService","$log","ENDPOINTS","AnalyticsService","$rootScope","$ionicScrollDelegate",function(e,a,t,o,n,s,r,i,c){function l(){e.featuredDescription={},e.showHtmlImage=!1,e.showHtmlDetail=!1;try{o.getItem("featured_detail",!1)?(e.featuredDescription=o.getItem("featured_detail",!1),n.debug("featuredDescription: ",e.featuredDescription),e.featuredDescription.imagen.match("<")&&(e.featuredDescription.imagen=d(e.featuredDescription.imagen,"\\",'""'),e.featuredDescription.imagen=d(e.featuredDescription.imagen,"amp;",""),e.featuredDescription.imagen=d(e.featuredDescription.imagen,'href="/','href="'+s.ENDPOINTS_BASE_EXTERNAL+"/"),e.featuredDescription.imagen=d(e.featuredDescription.imagen,'src="/','src="'+s.ENDPOINTS_BASE_EXTERNAL+"/"),e.showHtmlImage=!0,n.debug("new image: ",e.featuredDescription.imagen)),e.featuredDescription.detalle.match("<")&&(e.featuredDescription.detalle=d(e.featuredDescription.detalle,"\\",'""'),e.featuredDescription.detalle=d(e.featuredDescription.detalle,"amp;",'""'),e.featuredDescription.detalle=d(e.featuredDescription.detalle,'href="/','href="'+s.ENDPOINTS_BASE_EXTERNAL+"/"),e.featuredDescription.detalle=d(e.featuredDescription.detalle,'src="/','src="'+s.ENDPOINTS_BASE_EXTERNAL+"/"),e.showHtmlDetail=!0,n.debug("new detalle: ",e.featuredDescription.detalle))):(n.error("Error to get branches_detail"),r.evento(i.translation.PAGE_FEATURED_DESCRIPTION,i.translation.GA_SUCCESS_SERVICES_RESPONSE+"-"+i.translation.ERROR_FEATURED_DETAIL))}catch(e){n.error("Error to get branches_detail: ",e),r.evento(i.translation.PAGE_FEATURED_DESCRIPTION,i.translation.GA_SUCCESS_SERVICES_RESPONSE+"-"+i.translation.ERROR_FEATURED_DETAIL)}}function d(e,a,t){return e.replace(new RegExp(m(a),"g"),t)}function m(e){return e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}e.openUrl=function(e,a){r.evento(i.translation.PAGE_FEATURED_DESCRIPTION,i.translation.GA_PUSH_OPEN_EXTERNAL_FEATURED+": "+a),window.open(e,"_system")},e.goFeatured=function(){r.evento(i.translation.PAGE_FEATURED_DESCRIPTION,i.translation.GA_PUSH_BACK_BUTTON),o.getItem("featured_detail",!1)&&o.deleteItem("featured_detail"),i.isLogged?a.go("session.featuredList"):a.go("guest.featuredList")},e.sendAnalytics=function(e,a){r.evento(e,a)},e.$on("$locationChangeSuccess",function(e,a){(a.indexOf("session/featuredDescription")>-1||a.indexOf("guest/featuredDescription")>-1)&&(r.pantalla(i.translation.PAGE_FEATURED_DESCRIPTION),c.scrollTop(),l())})}]),angular.module("CoreModule").controller("preBlackoutCtrl",["$scope","$state","$ionicModal","$ionicLoading","AccessService","DataMapService","$rootScope","$log","LocalStorageProvider","PopupService","$sce","ENDPOINTS","AnalyticsService","UTILS_CONFIG","$ionicScrollDelegate",function(e,a,t,o,n,s,r,i,c,l,d,m,u,E,_){function g(){i.debug("reseteando Pre Blackout"),e.forms.preBlackoutForm.$setPristine();var a=c.getLocalStorageItem("no_session_client_number");a&&!r.isLogged?e.forms.preBlackoutForm.clientNum.$setViewValue(a):e.forms.preBlackoutForm.clientNum.$viewValue="",e.forms.preBlackoutForm.clientNum.$render()}e.buttons={chosen:""},e.forms={},e.sendAnalytics=function(e,a){u.evento(e,a)},e.validateForm=function(){if(r.isReportNotLogged=!1,i.debug("isReportNotLogged: "+r.isReportNotLogged),e.forms.preBlackoutForm.$valid){var t=e.buttons.chosen,d=e.forms.preBlackoutForm.clientNum.$viewValue,m=0;m=d.indexOf("-")>-1?d.indexOf("-"):d.length-1;var _=d.substring(0,m),g=_+"-"+d.substr(d.length-1);switch(o.show({template:E.STYLE_IONICLOADING_TEMPLATE}),t){case"consultButton":u.evento(r.translation.PAGE_PRE_BLACKOUT+" - "+r.translation.GA_STEP_01,r.translation.GA_PUSH_BLACKOUT_REPORT),n.getCommercialData(_).then(function(e){i.debug("no tiene corte"),o.hide(),s.setItem("uniqueAsset","preBlackout");var t={};t.index=0,t.direccion=e.direccion,t.numeroSuministro=e.numeroSuministro,t.numeroSuministroDv=e.numeroSuministro+"-"+e.digitoVerificador,s.setItem("reportBlackoutObject",t),r.isReportNotLogged=!0,i.debug("isReportNotLogged: "+r.isReportNotLogged),r.isLogged||c.setLocalStorageItem("no_session_client_number",g),a.go("guest.blackout")},function(a){i.error("Error: ",a),o.hide(),u.evento(r.translation.PAGE_PRE_BLACKOUT,r.translation.GA_ERROR_SERVICES_RESPONSE+"-"+r.translation.REPORT_EMERGENCY+"-"+a.message+"-"+a.analyticsCode);var t="error";a.code&&a.code.toString()==E.ERROR_INFO_CODE&&(t="info");var n=r.translation.ATTENTION_MODAL_TITLE,s=a.message;l.openModal(t,n,s,e)})}}else i.debug("formulario incorrecto")},e.searchClientId=function(){u.evento(r.translation.PAGE_PRE_BLACKOUT+" - "+r.translation.GA_STEP_01,r.translation.GA_PUSH_SEARCH_CLIENT);var a=r.translation.HELPER_MODAL_TITLE,t=d.trustAsResourceUrl(m.ENDPOINTS_EXTERNAL_SEARCH_CLIENTID);l.openModal("iframe",a,t,e)},e.helpModal=function(){u.evento(r.translation.PAGE_PRE_BLACKOUT+" - "+r.translation.GA_STEP_01,r.translation.GA_PUSH_HELP_CLIENT_NUMBER);var a=r.translation.HELPER_MODAL_TITLE,t=E.IMAGE_ASSET_MODAL_HELP;l.openModal("help",a,t,e)},e.closeModal=function(){e.modal.remove().then(function(){e.modal=null})},e.$on("$locationChangeSuccess",function(e,a){a.indexOf("guest/preBlackout")>-1&&(u.pantalla(r.translation.PAGE_PRE_BLACKOUT),_.scrollTop(),i.debug("llamando a resetForm Pre Blackout"),g())})}]),angular.module("CoreModule").controller("lightingProblemsCtrl",["$scope","$ionicPlatform","$log","LocalStorageProvider","$rootScope","UtilsService","EmergencyService","$ionicModal","$state","$ionicLoading","$cordovaGeolocation","ContactService","AnalyticsService","PopupService","UTILS_CONFIG","$timeout","$ionicScrollDelegate",function(e,a,t,o,n,s,r,c,l,d,m,u,E,_,g,S,A){function T(){if(t.debug("reseteando"),f){if(f.calle){var a=p(f.calle);a?e.forms.lightingForm.street.$setViewValue(a):e.forms.lightingForm.street.$setViewValue("");var n=I(f.calle);n?e.forms.lightingForm.number.$setViewValue(n):e.forms.lightingForm.number.$setViewValue("")}else e.forms.lightingForm.street.$setViewValue("");f.comuna&&null!=f.comuna&&""!=f.comuna?e.selectedState=N(f.comuna.trim()):e.selectedState={}}else e.forms.lightingForm.number.$setViewValue(""),e.forms.lightingForm.street.$setViewValue("");force.isAuthenticated()||(e.forms.lightingForm.departament.$setViewValue(""),e.forms.lightingForm.name.$setViewValue(""),e.forms.lightingForm.lastname.$setViewValue(""),e.forms.lightingForm.email.$setViewValue(""),e.forms.lightingForm.phone.$setViewValue(""),e.forms.lightingForm.cellphone.$setViewValue(""),e.forms.lightingForm.description.$setViewValue(""));var s=o.getLocalStorageItem("no_session_form_data");!force.isAuthenticated()&&s&&(e.forms.lightingForm.street.$setViewValue(s.street),e.forms.lightingForm.number.$setViewValue(s.number),e.forms.lightingForm.departament.$setViewValue(s.department),e.forms.lightingForm.name.$setViewValue(s.name),e.forms.lightingForm.lastname.$setViewValue(s.lastname),e.forms.lightingForm.email.$setViewValue(s.email),e.forms.lightingForm.phone.$setViewValue(s.phone),e.forms.lightingForm.cellphone.$setViewValue(s.cellphone)),e.forms.lightingForm.typeOfProblem.$render(),e.forms.lightingForm.street.$render(),e.forms.lightingForm.number.$render(),e.forms.lightingForm.departament.$render(),e.forms.lightingForm.state.$render(),force.isAuthenticated()||(e.forms.lightingForm.name.$render(),e.forms.lightingForm.lastname.$render(),e.forms.lightingForm.email.$render(),e.forms.lightingForm.phone.$render(),e.forms.lightingForm.cellphone.$render(),e.forms.lightingForm.description.$render()),e.forms.lightingForm.$setPristine()}e.isIos=!1,a.is("ios")&&(e.isIos=!0);var f;e.authenticated,e.listStates=[],e.listProblemTypes=[],e.selectedState={};var C=function(e){var a=e.split(",");return{calle:a[0],comuna:a[1],region:a[2],pais:a[3]}};e.sendAnalytics=function(e,a){E.evento(e,a)},e.alertMe=function(e){alert(e)};var p=function(e){var a=e.split(/(\d+)/);return a[0]?a[0].trim():""},I=function(e){const a=/ (\d+)/;var t=a.exec(e);return t?t[0].trim():""},N=function(a){for(i=0;i<e.listStates.length;i++)if(-1!==e.listStates[i].nombreComuna.toUpperCase().indexOf(a.toUpperCase()))return e.listStates[i];return null};e.closeModal=function(){t.debug("sending to emergency"),e.modal.hide(),force.isAuthenticated()?l.go("session.emergencyMenu"):l.go("guest.emergencyMenu")};var R=function(a){d.hide(),t.debug(a);var o=n.translation.ATTENTION_MODAL_TITLE,s=a.message;_.openModal("info",o,s,e)},O=function(a){d.hide(),t.error(a),E.evento(n.translation.PAGE_LIGHTING_PROBLEMS,n.translation.GA_ERROR_SERVICES_RESPONSE+"-"+n.translation.SET_LIGHTING_PROBLEMS+"-"+a.message+"-"+a.analyticsCode);var o="error";a.code&&a.code.toString()==g.ERROR_INFO_CODE&&(o="info");var s=n.translation.ATTENTION_MODAL_TITLE,r=a.message;_.openModal(o,s,r,e)};e.forms={},e.validateForm=function(){if(e.forms.lightingForm.$valid){E.evento(n.translation.PAGE_LIGHTING_PROBLEMS,n.translation.GA_PUSH_SEND_FORM),t.debug("formulario OK");var a=o.getLocalStorageItem("no_session_form_data");a&&null!=a&&"null"!=a?(a.street=e.forms.lightingForm.street.$viewValue,a.number=e.forms.lightingForm.number.$viewValue,a.department=e.forms.lightingForm.departament.$viewValue,a.state=e.forms.lightingForm.state.$viewValue,e.authenticated||(a.name=e.forms.lightingForm.name.$viewValue,a.lastname=e.forms.lightingForm.lastname.$viewValue,a.email=e.forms.lightingForm.email.$viewValue,a.phone=e.forms.lightingForm.phone.$viewValue,a.cellphone=e.forms.lightingForm.cellphone.$viewValue)):a=e.authenticated?{street:e.forms.lightingForm.street.$viewValue,number:e.forms.lightingForm.number.$viewValue,department:e.forms.lightingForm.departament.$viewValue,state:e.forms.lightingForm.state.$viewValue}:{street:e.forms.lightingForm.street.$viewValue,number:e.forms.lightingForm.number.$viewValue,department:e.forms.lightingForm.departament.$viewValue,state:e.forms.lightingForm.state.$viewValue,name:e.forms.lightingForm.name.$viewValue,lastname:e.forms.lightingForm.lastname.$viewValue,email:e.forms.lightingForm.email.$viewValue,phone:e.forms.lightingForm.phone.$viewValue,cellphone:e.forms.lightingForm.cellphone.$viewValue},o.setLocalStorageItem("no_session_form_data",a),d.show({template:g.STYLE_IONICLOADING_TEMPLATE}),force.isAuthenticated()?r.emergencyLightingProblemAuth(e.forms.lightingForm.typeOfProblem.$modelValue.value,e.forms.lightingForm.street.$modelValue,e.forms.lightingForm.number.$modelValue,e.forms.lightingForm.departament.$modelValue,e.forms.lightingForm.state.$viewValue.codigoComuna,e.forms.lightingForm.description.$modelValue).then(R,O):r.emergencyLightingProblem(e.forms.lightingForm.typeOfProblem.$modelValue.value,e.forms.lightingForm.street.$modelValue,e.forms.lightingForm.number.$modelValue,e.forms.lightingForm.departament.$modelValue,e.forms.lightingForm.state.$viewValue.codigoComuna,e.forms.lightingForm.name.$viewValue,e.forms.lightingForm.lastname.$viewValue,e.forms.lightingForm.email.$viewValue,e.forms.lightingForm.phone.$viewValue,e.forms.lightingForm.cellphone.$viewValue,e.forms.lightingForm.description.$modelValue).then(R,O)}else t.debug("formulario incorrecto")},e.$on("$locationChangeSuccess",function(a,o){(o.indexOf("guest/lightingProblems")>-1||o.indexOf("session/lightingProblems")>-1)&&(E.pantalla(n.translation.PAGE_LIGHTING_PROBLEMS),A.scrollTop(),e.authenticated=force.isAuthenticated(),d.show({template:g.STYLE_IONICLOADING_TEMPLATE}),r.getLightingProblemsList().then(function(a){t.debug(a),e.listProblemTypes=a,d.hide()},function(e){t.error(e),d.hide(),E.evento(n.translation.PAGE_LIGHTING_PROBLEMS,n.translation.GA_ERROR_SERVICES_RESPONSE+"-"+n.translation.GET_LIGHTING_PROBLEMS_LIST+"-"+e.message+"-"+e.analyticsCode)}),d.show({template:g.STYLE_IONICLOADING_TEMPLATE}),s.getStates().then(function(a){e.listStates=a,t.debug("llamando a resetForm Accident Risk");var o={timeout:5e3,maximumAge:3e4,enableHighAccuracy:!0};m.getCurrentPosition(o).then(function(e){var a=e.coords.latitude,o=e.coords.longitude;u.geocodeLatLng(a,o).then(function(e){t.debug(e),f=C(e),d.hide(),T()},function(e){t.error(e),d.hide(),E.evento(n.translation.PAGE_LIGHTING_PROBLEMS,n.translation.GA_ERROR_SERVICES_RESPONSE+"-"+n.translation.GET_GEO_ADDRESS_SERVICES+"-"+e.message+"-"+e.analyticsCode),T()})},function(e){t.error(e),d.hide(),T()})},function(e){d.hide(),E.evento(n.translation.PAGE_LIGHTING_PROBLEMS,n.translation.GA_ERROR_SERVICES_RESPONSE+"-"+n.translation.GET_STATES+"-"+e.message+"-"+e.analyticsCode),T()}))})}]),angular.module("CoreModule").controller("emergencyMenuCtrl",["$scope","$state","$rootScope","$log","AnalyticsService","$ionicScrollDelegate",function(e,a,t,o,n,s){e.goToBlackOut=function(){n.evento(t.translation.PAGE_EMERGENCY,t.translation.GA_PUSH_BLACKOUT),t.tabActualAnalytics="Corte de Luz",o.debug("go blackout"),o.debug("force.isAuthenticated(): "+force.isAuthenticated()),force.isAuthenticated()?a.go("session.blackout"):a.go("guest.preBlackout")},e.goToLightingProblems=function(){n.evento(t.translation.PAGE_EMERGENCY,t.translation.GA_PUSH_LIGHTING_PROBLEMS),t.tabActualAnalytics="Problemas de Alumbrado",o.debug("go lightingProblems"),o.debug("force.isAuthenticated(): "+force.isAuthenticated()),force.isAuthenticated()?a.go("session.lightingProblems"):a.go("guest.lightingProblems")},e.goToAccidentRisk=function(){n.evento(t.translation.PAGE_EMERGENCY,t.translation.GA_PUSH_ACCIDENT_RISK),t.tabActualAnalytics="Riesgo o Accidente",o.debug("go accidentRisk"),o.debug("force.isAuthenticated(): "+force.isAuthenticated()),force.isAuthenticated()?a.go("session.accidentRisk"):a.go("guest.accidentRisk")},e.sendAnalytics=function(e,a){n.evento(e,a)},e.$on("$locationChangeSuccess",function(e,a){(a.indexOf("guest/emergencyMenu")>-1||a.indexOf("session/emergencyMenu")>-1)&&(n.pantalla(t.translation.PAGE_EMERGENCY),s.scrollTop())})}]),angular.module("CoreModule").controller("blackoutCtrl",["$scope","$ionicPlatform","UtilsService","$ionicSlideBoxDelegate","DataMapService","$log","LocalStorageProvider","$rootScope","UsageService","EmergencyService","$ionicModal","$state","$ionicLoading","AnalyticsService","$route","PopupService","UTILS_CONFIG","$ionicScrollDelegate",function(e,a,t,o,n,s,r,i,c,l,d,m,u,E,_,g,S,A){function T(){e.dataBlackout={};var a={value:S.BLACKOUT_TYPE_PROBLEM_CODE_1,label:i.translation.BLACKOUT_TYPE_PROBLEM_LABEL_1},c={value:S.BLACKOUT_TYPE_PROBLEM_CODE_2,label:i.translation.BLACKOUT_TYPE_PROBLEM_LABEL_2};if(e.typesOfProblems1=a,e.typesOfProblems2=c,p=e.typesOfProblems1.value,e.isLogged){s.debug("está logeado");try{n.deleteItem("uniqueAsset"),e.dataBlackout.items=[],t.getAssetList(i.contactId).then(function(a){if(a.length>0)r.getLocalStorageItem("asset_list_is_new_request")&&"true"===r.getLocalStorageItem("asset_list_is_new_request")&&(e.activeSlide=0),o.slide(e.activeSlide),e.dataBlackout.items=a,C=e.dataBlackout.items[0].numeroSuministro,o.update();else{s.error("No data with that contactId"),E.evento(i.translation.PAGE_BLACKOUT,i.translation.GA_ERROR_SERVICES_RESPONSE+"-"+i.translation.NO_DATA);var t=i.translation.ATTENTION_MODAL_TITLE,n=i.translation.NO_DATA;g.openModal("info",t,n,e)}},N)}catch(e){s.error("Error: ",e)}}else{s.debug("no está logeado"),e.activeSlide=0;try{if(n.getItem("uniqueAsset",!1)){e.backHref=n.getItem("uniqueAsset",!1),s.debug("ES UN ELEMENTO UNICO"),e.dataBlackout.items=[];var l=n.getItem("reportBlackoutObject",!1);e.dataBlackout.items.push(l),o.slide(e.activeSlide),C=l.numeroSuministro,s.debug("items: ",e.dataBlackout.items),o.update()}else{s.error("Imposible to find Object: uniqueAsset"),E.evento(i.translation.PAGE_BLACKOUT,i.translation.GA_ERROR_SERVICES_RESPONSE+"-"+i.translation.NOT_POSSIBLE_FIND_OBJECT);var d=i.translation.ATTENTION_MODAL_TITLE,m=i.translation.NOT_POSSIBLE_FIND_OBJECT+": uniqueAsset";g.openModal("info",d,m,e)}}catch(e){s.debug("Error: ",e)}}}function f(){if(s.debug("reseteando BlackOut"),e.forms.blackoutForm){var a=r.getLocalStorageItem("no_session_form_data");a?e.isLogged?s.debug("está autenticado: no se guardará data en LS"):(e.forms.blackoutForm.name.$setViewValue(a.name),e.forms.blackoutForm.lastnames.$setViewValue(a.lastname),e.forms.blackoutForm.email.$setViewValue(a.email),e.forms.blackoutForm.phone.$setViewValue(a.phone),e.forms.blackoutForm.cellphone.$setViewValue(a.cellphone),e.forms.blackoutForm.name.$render(),e.forms.blackoutForm.lastnames.$render(),e.forms.blackoutForm.email.$render(),e.forms.blackoutForm.phone.$render(),e.forms.blackoutForm.cellphone.$render()):e.isLogged?s.debug("está autenticado: no se guardará data en LS"):(e.forms.blackoutForm.name.$setViewValue(""),e.forms.blackoutForm.lastnames.$setViewValue(""),e.forms.blackoutForm.email.$setViewValue(""),e.forms.blackoutForm.phone.$setViewValue(""),e.forms.blackoutForm.cellphone.$setViewValue(""),e.forms.blackoutForm.name.$render(),e.forms.blackoutForm.lastnames.$render(),e.forms.blackoutForm.email.$render(),e.forms.blackoutForm.phone.$render(),e.forms.blackoutForm.cellphone.$render()),e.forms.blackoutForm.description.$viewValue="",e.forms.blackoutForm.description.$render(),e.forms.blackoutForm.$setPristine()}else s.debug("no existe aun el formulario");e.selected1tab=!0,e.selected2tab=!1}e.isIos=!1,a.is("ios")&&(e.isIos=!0),e.actualIndex=0,e.backHref="home",e.isLogged=i.isLogged,e.activeSlide=0,e.sendAnalytics=function(e,a){E.evento(e,a)},e.dataBlackout;var C;e.typesOfProblems1={},e.typesOfProblems2={};var p=0;e.selected1tab=!1,e.selected2tab=!1,e.closeModal=function(){e.modal.hide(),i.isLogged?m.go("session.emergencyMenu"):"preBlackout"===e.backHref?m.go("guest.preBlackout"):m.go("guest.home")};var I=function(a){u.hide(),s.debug(a);var t=i.translation.ATTENTION_MODAL_TITLE,o=a.message;g.openModal("info",t,o,e)},N=function(a){u.hide(),E.evento(i.translation.PAGE_BLACKOUT,i.translation.GA_ERROR_SERVICES_RESPONSE+"-"+i.translation.BLACKOUT+"-"+a.message+"-"+a.analyticsCode),s.error(a);var t="error";a.code&&a.code.toString()==S.ERROR_INFO_CODE&&(t="info");var o=i.translation.ATTENTION_MODAL_TITLE,n=a.message;g.openModal(t,o,n,e)};e.pagerClick=function(e){s.debug("se aplica slide button"),o.slide(e)},e.slideHasChanged=function(a){e.actualIndex<a?E.evento(i.translation.PAGE_BLACKOUT+" - "+i.translation.GA_STEP_02,i.translation.GA_SWIPE_RIGHT):E.evento(i.translation.PAGE_BLACKOUT+" - "+i.translation.GA_STEP_02,i.translation.GA_SWIPE_LEFT),e.actualIndex=a,f(),o.update(),_.reload()},e.forms={},e.validateForm=function(){if(e.forms.blackoutForm.$valid){E.evento(i.translation.PAGE_BLACKOUT,i.translation.GA_PUSH_SEND_FORM),s.debug("formulario OK");var a=r.getLocalStorageItem("no_session_form_data");a?e.isLogged||(a.name=e.forms.blackoutForm.name.$viewValue,a.lastname=e.forms.blackoutForm.lastnames.$viewValue,a.email=e.forms.blackoutForm.email.$viewValue,a.phone=e.forms.blackoutForm.phone.$viewValue,a.cellphone=e.forms.blackoutForm.cellphone.$viewValue):e.isLogged||(a={name:e.forms.blackoutForm.name.$viewValue,lastname:e.forms.blackoutForm.lastnames.$viewValue,email:e.forms.blackoutForm.email.$viewValue,phone:e.forms.blackoutForm.phone.$viewValue,cellphone:e.forms.blackoutForm.cellphone.$viewValue}),r.setLocalStorageItem("no_session_form_data",a),u.show({template:S.STYLE_IONICLOADING_TEMPLATE}),s.debug("selectedTypeProblem: ",p),force.isAuthenticated()?l.emergencyLightCutAuth(C,e.forms.blackoutForm.description.$modelValue,p).then(I,N):l.emergencyLightCut(C,e.forms.blackoutForm.description.$modelValue,p,e.forms.blackoutForm.name.$modelValue,e.forms.blackoutForm.lastnames.$modelValue,e.forms.blackoutForm.email.$modelValue,e.forms.blackoutForm.phone.$modelValue,e.forms.blackoutForm.cellphone.$modelValue).then(I,N)}else s.debug("formulario incorrecto")},e.selectedProblem=function(a){e.selected1tab=!1,e.selected2tab=!1,p=a,a==e.typesOfProblems1.value?(E.evento(i.translation.PAGE_BLACKOUT+" - "+i.translation.GA_STEP_02,i.translation.GA_SELECT_TYPE_OF_INCIDENT+": "+e.typesOfProblems1.label),e.selected1tab=!0):a==e.typesOfProblems2.value?(E.evento(i.translation.PAGE_BLACKOUT+" - "+i.translation.GA_STEP_02,i.translation.GA_SELECT_TYPE_OF_INCIDENT+": "+e.typesOfProblems2.label),e.selected2tab=!0):(E.evento(i.translation.PAGE_BLACKOUT+" - "+i.translation.GA_STEP_02,i.translation.GA_SELECT_TYPE_OF_INCIDENT+": "+e.typesOfProblems1.label),e.selected1tab=!0)},e.$on("$locationChangeSuccess",function(e,a){(a.indexOf("session/blackout")>-1||a.indexOf("guest/blackout")>-1)&&(E.pantalla(i.translation.PAGE_BLACKOUT),A.scrollTop(),s.debug("llamando a resetForm BlackOut"),f(),T())})}]),angular.module("CoreModule").controller("accidentRiskCtrl",["$scope","$ionicPlatform","$rootScope","$log","LocalStorageProvider","EmergencyService","$ionicModal","$state","$ionicLoading","UtilsService","$cordovaGeolocation","ContactService","AnalyticsService","PopupService","UTILS_CONFIG","$ionicScrollDelegate",function(e,a,t,o,n,s,r,c,l,d,m,u,E,_,g,S){function A(){if(o.debug("reseteando Accident Risk"),T){if(T.calle){var a=C(T.calle);a?e.forms.accidentForm.street.$setViewValue(a):e.forms.accidentForm.street.$setViewValue("");var t=p(T.calle);t?e.forms.accidentForm.number.$setViewValue(t):e.forms.accidentForm.number.$setViewValue("")}else e.forms.accidentForm.street.$setViewValue("");T.comuna&&null!=T.comuna&&""!=T.comuna?e.selectedState=I(T.comuna.trim()):e.selectedState={}}else e.forms.accidentForm.number.$setViewValue(""),e.forms.accidentForm.street.$setViewValue("");e.forms.accidentForm.departament.$setViewValue(""),force.isAuthenticated()||(e.forms.accidentForm.departament.$setViewValue(""),e.forms.accidentForm.name.$setViewValue(""),e.forms.accidentForm.lastname.$setViewValue(""),e.forms.accidentForm.email.$setViewValue(""),e.forms.accidentForm.phone.$setViewValue(""),e.forms.accidentForm.cellphone.$setViewValue(""),e.forms.accidentForm.description.$setViewValue(""));var s=n.getLocalStorageItem("no_session_form_data");!force.isAuthenticated()&&s&&(e.forms.accidentForm.street.$setViewValue(s.street),e.forms.accidentForm.number.$setViewValue(s.number),e.forms.accidentForm.departament.$setViewValue(s.department),e.forms.accidentForm.name.$setViewValue(s.name),e.forms.accidentForm.lastname.$setViewValue(s.lastname),e.forms.accidentForm.email.$setViewValue(s.email),e.forms.accidentForm.phone.$setViewValue(s.phone),e.forms.accidentForm.cellphone.$setViewValue(s.cellphone)),e.forms.accidentForm.typeOfProblem.$render(),e.forms.accidentForm.street.$render(),e.forms.accidentForm.number.$render(),e.forms.accidentForm.departament.$render(),e.forms.accidentForm.state.$render(),force.isAuthenticated()||(e.forms.accidentForm.name.$render(),e.forms.accidentForm.lastname.$render(),e.forms.accidentForm.email.$render(),e.forms.accidentForm.phone.$render(),e.forms.accidentForm.cellphone.$render(),e.forms.accidentForm.description.$render()),e.forms.accidentForm.$setPristine()}e.isIos=!1,a.is("ios")&&(e.isIos=!0);var T;e.authenticated,e.listStates=[],e.listProblemTypes=[];var f=function(e){var a=e.split(",");return{calle:a[0],
comuna:a[1],region:a[2],pais:a[3]}};e.sendAnalytics=function(e,a){E.evento(e,a)};var C=function(e){var a=e.split(/(\d+)/);return a[0]?a[0].trim():""},p=function(e){const a=/ (\d+)/;var t=a.exec(e);return t?t[0].trim():""},I=function(a){for(i=0;i<e.listStates.length;i++)if(-1!==e.listStates[i].nombreComuna.toUpperCase().indexOf(a.toUpperCase()))return e.listStates[i];return null};e.closeModal=function(){o.debug("sending to emergency"),e.modal.hide(),force.isAuthenticated()?c.go("session.emergencyMenu"):c.go("guest.emergencyMenu")};var N=function(a){l.hide(),o.debug(a);var n=t.translation.ATTENTION_MODAL_TITLE,s=a.message;_.openModal("info",n,s,e)},R=function(a){l.hide(),o.error(a),E.evento(t.translation.PAGE_ACCIDENT_RISK,t.translation.GA_ERROR_SERVICES_RESPONSE+"-"+t.translation.SET_ACCIDENT_RISK+"-"+a.message+"-"+a.analyticsCode);var n="error";a.code&&a.code.toString()==g.ERROR_INFO_CODE&&(n="info");var s=t.translation.ATTENTION_MODAL_TITLE,r=a.message;_.openModal(n,s,r,e)};e.forms={},e.validateForm=function(){if(e.forms.accidentForm.$valid){E.evento(t.translation.PAGE_ACCIDENT_RISK,t.translation.GA_PUSH_SEND_FORM),o.debug("formulario OK");var a=n.getLocalStorageItem("no_session_form_data");a?(a.street=e.forms.accidentForm.street.$viewValue,a.number=e.forms.accidentForm.number.$viewValue,a.department=e.forms.accidentForm.departament.$viewValue,a.state=e.forms.accidentForm.state.$viewValue,e.authenticated||(a.name=e.forms.accidentForm.name.$viewValue,a.lastname=e.forms.accidentForm.lastname.$viewValue,a.email=e.forms.accidentForm.email.$viewValue,a.phone=e.forms.accidentForm.phone.$viewValue,a.cellphone=e.forms.accidentForm.cellphone.$viewValue)):a=e.authenticated?{street:e.forms.accidentForm.street.$viewValue,number:e.forms.accidentForm.number.$viewValue,department:e.forms.accidentForm.departament.$viewValue,state:e.forms.accidentForm.state.$viewValue}:{street:e.forms.accidentForm.street.$viewValue,number:e.forms.accidentForm.number.$viewValue,department:e.forms.accidentForm.departament.$viewValue,state:e.forms.accidentForm.state.$viewValue,name:e.forms.accidentForm.name.$viewValue,lastname:e.forms.accidentForm.lastname.$viewValue,email:e.forms.accidentForm.email.$viewValue,phone:e.forms.accidentForm.phone.$viewValue,cellphone:e.forms.accidentForm.cellphone.$viewValue},n.setLocalStorageItem("no_session_form_data",a),l.show({template:g.STYLE_IONICLOADING_TEMPLATE}),force.isAuthenticated()?s.emergencyRiskAccidentAuth(e.forms.accidentForm.typeOfProblem.$modelValue.value,e.forms.accidentForm.street.$viewValue,e.forms.accidentForm.number.$viewValue,e.forms.accidentForm.departament.$viewValue,e.forms.accidentForm.state.$viewValue.codigoComuna,e.forms.accidentForm.description.$modelValue).then(N,R):s.emergencyRiskAccident(e.forms.accidentForm.typeOfProblem.$modelValue.value,e.forms.accidentForm.street.$modelValue,e.forms.accidentForm.number.$modelValue,e.forms.accidentForm.departament.$modelValue,e.forms.accidentForm.state.$viewValue.codigoComuna,e.forms.accidentForm.name.$viewValue,e.forms.accidentForm.lastname.$viewValue,e.forms.accidentForm.email.$viewValue,e.forms.accidentForm.phone.$viewValue,e.forms.accidentForm.cellphone.$viewValue,e.forms.accidentForm.description.$modelValue).then(N,R)}else o.debug("formulario incorrecto")},e.$on("$locationChangeSuccess",function(a,n){(n.indexOf("guest/accidentRisk")>-1||n.indexOf("session/accidentRisk")>-1)&&(E.pantalla(t.translation.PAGE_ACCIDENT_RISK),S.scrollTop(),e.authenticated=force.isAuthenticated(),l.show({template:g.STYLE_IONICLOADING_TEMPLATE}),s.getRiskAccidentProblemsList().then(function(a){o.debug(a),e.listProblemTypes=a,l.hide()},function(e){o.error(e),l.hide(),E.evento(t.translation.PAGE_ACCIDENT_RISK,t.translation.GA_ERROR_SERVICES_RESPONSE+"-"+t.translation.GET_ACCIDENT_RISK_LIST+"-"+e.message+"-"+e.analyticsCode)}),l.show({template:g.STYLE_IONICLOADING_TEMPLATE}),d.getStates().then(function(a){e.listStates=a,o.debug("llamando a resetForm Accident Risk");var n={timeout:5e3,maximumAge:3e4,enableHighAccuracy:!0};m.getCurrentPosition(n).then(function(e){var a=e.coords.latitude,n=e.coords.longitude;u.geocodeLatLng(a,n).then(function(e){o.debug(e),T=f(e),l.hide(),A()},function(e){o.error(e),l.hide(),E.evento(t.translation.PAGE_ACCIDENT_RISK,t.translation.GA_ERROR_SERVICES_RESPONSE+"-"+t.translation.GET_GEO_ADDRESS_SERVICES+"-"+e.message+"-"+e.analyticsCode),A()})},function(e){o.error(e),l.hide(),A()})},function(e){l.hide(),E.evento(t.translation.PAGE_ACCIDENT_RISK,t.translation.GA_ERROR_SERVICES_RESPONSE+"-"+t.translation.GET_STATES+"-"+e.message+"-"+e.analyticsCode),A()}))})}]),angular.module("CoreModule").controller("tutorialCtrl",["$scope","$rootScope","$ionicPlatform","$log","AnalyticsService","$state","LocalStorageProvider","$ionicSlideBoxDelegate",function(e,a,t,o,n,s,r,i){e.isIos=!1,t.is("ios")&&(e.isIos=!0),e.antIndex=0,n.pantalla(a.translation.GA_TUTORIAL_SLIDE+" "+(e.antIndex+1)),e.passTuto=function(e,t){n.evento(e,t),r.setLocalStorageItem("pass_tuto","true"),force.isAuthenticated()?(a.isLogged=!0,s.go("session.usage")):(a.isLogged=!1,s.go("guest.home"))},e.pagerClick=function(e){i.slide(e)},e.slideHasChanged=function(t){e.antIndex<t?n.evento(a.translation.GA_TUTORIAL_SLIDE+" "+(e.antIndex+1),a.translation.GA_SWIPE_RIGHT):n.evento(a.translation.GA_TUTORIAL_SLIDE+" "+(e.antIndex+1),a.translation.GA_SWIPE_LEFT),e.antIndex=t,n.pantalla(a.translation.GA_TUTORIAL_SLIDE+" "+(e.antIndex+1)),i.slide(t)}}]),angular.module("CoreModule").controller("profileCtrl",["$scope","$state","$ionicModal","$ionicPlatform","$rootScope","$log","AccessService","$ionicLoading","PopupService","$q","ProfileService","LocalStorageProvider","UTILS_CONFIG","UtilsService","AnalyticsService","DataMapService","ManageAssetService","$ionicScrollDelegate",function(e,a,t,o,n,s,r,i,c,l,d,m,u,E,_,g,S,A){function T(){if(s.debug("reseteando Profile"),m.getLocalStorageItem("USER_DATA")){var a=m.getLocalStorageItem("USER_DATA");"si"===a.activarNotificaciones&&(e.booleanNotifications=!0),e.userFullName=a.nombre+" "+a.apellidoPaterno+" "+a.apellidoMaterno,e.forms.profileForm1.email.$viewValue=a.email,e.forms.profileForm1.cellphone.$viewValue=a.telefonoMovil,e.forms.profileForm1.phone.$viewValue=a.telefonoFijo}else e.forms.profileForm1.email.$viewValue="",e.forms.profileForm1.cellphone.$viewValue="",e.forms.profileForm1.phone.$viewValue="";e.forms.profileForm1.email.$render(),e.forms.profileForm1.cellphone.$render(),e.forms.profileForm1.phone.$render(),e.forms.profileForm1.$setPristine()}function f(){s.debug("reseteando Profile"),e.forms.profileForm3.clientNum.$viewValue="",e.forms.profileForm3.numLastService.$viewValue="",e.forms.profileForm3.relationshipWithAsset.$viewValue="",e.forms.profileForm3.clientNum.$render(),e.forms.profileForm3.numLastService.$render(),e.forms.profileForm3.relationshipWithAsset.$render(),e.forms.profileForm3.$setPristine()}function C(){s.debug("se procederá a obtener relacion de usuario con el suministro a asociar"),e.listRelationshipWithAsset=[];var a={value:u.RELATIONSHIP_WITH_ASSET_CODE_1,label:n.translation.RELATIONSHIP_WITH_ASSET_LABEL_1},t={value:u.RELATIONSHIP_WITH_ASSET_CODE_2,label:n.translation.RELATIONSHIP_WITH_ASSET_LABEL_2};e.listRelationshipWithAsset.push(a),e.listRelationshipWithAsset.push(t),i.show({template:u.STYLE_IONICLOADING_TEMPLATE});try{d.getRelationshipWithAsset().then(function(a){s.debug(a),e.listRelationshipWithAsset=a,i.hide()},function(e){s.error("Error to get Relationship with Asset: ",e),i.hide(),_.evento(n.translation.PAGE_PROFILE,n.translation.GA_ERROR_SERVICES_RESPONSE+"-"+n.translation.GET_RELATIONSHIP_WITH_ASSET+"-"+e.message+"-"+e.analyticsCode)})}catch(e){s.error("Error to get Relationship with Asset: ",e)}}e.isIos=!1,o.is("ios")&&(e.isIos=!0),e.booleanNotifications=!1,window.sc=e,e.forms={},e.xidDevice=n.xidDevice,e.listRelationshipWithAsset=[],e.validateForm1=function(){if(e.forms.profileForm1.$valid){_.evento(n.translation.PAGE_PROFILE,n.translation.GA_PUSH_SAVE_USER_DATA),s.debug("formulario 1 OK");var a=e.forms.profileForm1.checkNotifications.$viewValue,t=e.forms.profileForm1.email.$modelValue,o=e.forms.profileForm1.cellphone.$modelValue,r=e.forms.profileForm1.phone.$modelValue;i.show({template:u.STYLE_IONICLOADING_TEMPLATE}),d.updateUserData(a,t,o,r).then(function(e){var n=m.getLocalStorageItem("USER_DATA");n&&(n.activarNotificaciones=1==a?"si":"no"),n.email=t,n.telefonoFijo=r,n.telefonoMovil=o,m.setLocalStorageItem("USER_DATA",n),p(e)},I)}else s.debug("formulario incorrecto")},e.validateForm2=function(){if(e.forms.profileForm2.$valid)if(s.debug("formulario2 OK"),_.evento(n.translation.PAGE_PROFILE,n.translation.GA_PUSH_CHANGE_YOUR_PASS),e.forms.profileForm2.password.$modelValue&&e.forms.profileForm2.newPassword.$modelValue&&e.forms.profileForm2.password.$modelValue==e.forms.profileForm2.newPassword.$modelValue){var a=e.forms.profileForm2.password.$modelValue,t=e.forms.profileForm2.newPassword.$modelValue;i.show({template:u.STYLE_IONICLOADING_TEMPLATE}),d.changePassword(a,t).then(function(e){if(m.getLocalStorageItem("USER_DATA")){var t=m.getLocalStorageItem("USER_DATA");t.password=a,m.setLocalStorageItem("USER_DATA",t)}p(e)},I)}else s.error("contraseñas distintas");else s.debug("formulario incorrecto")},e.validateForm3=function(){if(e.forms.profileForm3.$valid){_.evento(n.translation.PAGE_PROFILE,n.translation.GA_PUSH_ADD_ASSET),s.debug("formulario3 OK"),i.show({template:u.STYLE_IONICLOADING_TEMPLATE});var t=e.forms.profileForm3.clientNum.$viewValue,o=e.forms.profileForm3.numLastService.$viewValue,r=e.forms.profileForm3.relationshipWithAsset.$viewValue.value;S.addAsset(t,o,r).then(function(e){i.hide(),m.removeLocalStorageIfStartWith("asset_"),a.go("session.usage")},function(a){i.hide(),_.evento(n.translation.PAGE_PROFILE,n.translation.GA_ERROR_SERVICES_RESPONSE+"-"+n.translation.ADD_ASSET+"-"+a.message+"-"+a.analyticsCode),s.error(a);var t="error";a.code&&a.code.toString()==u.ERROR_INFO_CODE&&(t="info");var o=n.translation.ATTENTION_MODAL_TITLE,r=a.message;c.openModal(t,o,r,e,function(){e.modal.hide()})})}else s.debug("formulario incorrecto")};var p=function(a){i.hide(),s.debug(a);var t=n.translation.ATTENTION_MODAL_TITLE,o=a.message;c.openModal("success",t,o,e,function(){e.modal.hide().then(function(){T(),f()})})},I=function(a){i.hide(),_.evento(n.translation.PAGE_PROFILE,n.translation.GA_ERROR_SERVICES_RESPONSE+"-"+n.translation.UPDATE_PROFILE+"-"+a.message+"-"+a.analyticsCode),s.error(a);var t="error";a.code&&a.code.toString()==u.ERROR_INFO_CODE&&(t="info");var o=n.translation.ATTENTION_MODAL_TITLE,r=a.message;c.openModal(t,o,r,e,function(){e.modal.hide().then(function(){})})};e.$on("$locationChangeSuccess",function(e,a){a.indexOf("session/profile")>-1&&(_.pantalla(n.translation.PAGE_PROFILE),A.scrollTop(),s.debug("llamando a resetForm Profile"),C(),T(),f())}),e.logout=function(){s.debug("unlogging");var a=n.translation.LOGOUT_MODAL_TITLE,t=n.translation.LOGOUT_MODAL_CONTENT;c.openModal("logout",a,t,e)},e.clearUserData=function(){E.setXID("",""),E.setBadgeNumber(0),r.getLogout(),a.go("guest.home"),e.modal.remove()},e.closeModal=function(){e.modal.hide()},e.sendAnalytics=function(e,a){_.evento(e,a)}}]),angular.module("CoreModule").controller("footerCtrl",["$scope","$state","$log","AnalyticsService","$rootScope","$ionicLoading","NotificationService",function(e,a,t,o,n,s,r){e.isProfile=!1,e.logoActionButton=function(){o.evento(n.translation.HEADER,n.translation.GA_PUSH_LOGO_ICON),n.isLogged?a.go("session.usage"):a.go("guest.home")},e.goToProfile=function(e,t){o.evento(e,t),n.tabActualAnalytics="Perfil",a.go("session.profile")},e.selectedTab=function(e){switch(t.debug("elemento seleccionado: "+e),e){case 1:o.evento(n.translation.FOOTER,n.translation.GA_PUSH_HOME),t.debug("Selected Case Number is 1"),a.go("guest.home");break;case 2:o.evento(n.translation.FOOTER,n.translation.GA_PUSH_EMERGENCY),n.tabActualAnalytics="Emergencia",t.debug("Selected Case Number is 2"),a.go("guest.emergencyMenu");break;case 3:o.evento(n.translation.FOOTER,n.translation.GA_PUSH_CONTACT),n.tabActualAnalytics="Contacto",t.debug("Selected Case Number is 3"),a.go("guest.contactMenu");break;case 4:o.evento(n.translation.FOOTER,n.translation.GA_PUSH_FEATURED),n.tabActualAnalytics="Destacados",t.debug("Selected Case Number is 4"),a.go("guest.featuredList");break;case 5:o.evento(n.translation.FOOTER,n.translation.GA_PUSH_USAGE),n.tabActualAnalytics="Resumen",t.debug("Selected Case Number is 5"),a.go("session.usage");break;case 6:o.evento(n.translation.FOOTER,n.translation.GA_PUSH_EMERGENCY),n.tabActualAnalytics="Emergencia",t.debug("Selected Case Number is 6"),a.go("session.emergencyMenu");break;case 7:o.evento(n.translation.FOOTER,n.translation.GA_PUSH_CONTACT),n.tabActualAnalytics="Contacto",t.debug("Selected Case Number is 7"),a.go("session.contactMenu");break;case 8:o.evento(n.translation.FOOTER,n.translation.GA_PUSH_NOTIFICATIONS),n.tabActualAnalytics="Notificaciones",t.debug("Selected Case Number is 8"),a.go("session.notification");break;case 9:o.evento(n.translation.FOOTER,n.translation.GA_PUSH_FEATURED),n.tabActualAnalytics="Destacados",t.debug("Selected Case Number is 9"),a.go("session.featuredList");break;default:o.evento(n.translation.FOOTER,n.translation.GA_PUSH_HOME),n.tabActualAnalytics="Inicio",a.go("guest.home")}},e.$on("$locationChangeSuccess",function(a,o){o.indexOf("session/profile")>-1?(t.debug("isprofile=true"),e.isProfile=!0):(t.debug("isprofile=false"),e.isProfile=!1)})}]),angular.module("CoreModule").controller("paymentOptionsCtrl",["$scope","$rootScope","AnalyticsService","$state","$log","$ionicScrollDelegate",function(e,a,t,o,n,s){e.goToMap=function(){t.evento(a.translation.PAGE_BRANCHES_PAYMENT_OPTIONS,a.translation.GA_PUSH_BACK_BUTTON),a.tabActualAnalytics="Sucursales Cercanas",n.debug("go goToMap"),n.debug("$rootScope.isLogged: "+a.isLogged),a.isLogged?o.go("session.branchesMap"):o.go("guest.branchesMap")},e.sendAnalytics=function(e,a){t.evento(e,a)},e.$on("$locationChangeSuccess",function(e,o){(o.indexOf("session/paymentOptions")>-1||o.indexOf("guest/paymentOptions")>-1)&&(t.pantalla(a.translation.PAGE_BRANCHES_PAYMENT_OPTIONS),s.scrollTop())})}]),angular.module("LocationsModule").controller("contactMenuCtrl",["$scope","$state","UtilsService","$rootScope","$log","AnalyticsService","UTILS_CONFIG","ENDPOINTS","$ionicScrollDelegate",function(e,a,t,o,n,s,r,i,c){e.goCall=function(){s.evento(o.translation.PAGE_CONTACT,o.translation.GA_PUSH_TELEPHONE_ATTENTION)},e.goContactForm=function(){s.evento(o.translation.PAGE_CONTACT,o.translation.GA_PUSH_CONTACT_FORM),o.tabActualAnalytics="Contacto - Formulario de Contacto",n.debug("go contact form"),n.debug("$rootScope.isLogged: "+o.isLogged),o.isLogged?a.go("session.contactForm"):a.go("guest.contactForm")},e.goBranchesMap=function(){s.evento(o.translation.PAGE_CONTACT,o.translation.GA_PUSH_BRANCHES),o.tabActualAnalytics="Contacto - Sucursales",n.debug("go branches map"),n.debug("$rootScope.isLogged: "+o.isLogged),o.isLogged?a.go("session.branchesMap"):a.go("guest.branchesMap")},e.openUrl=function(e,a){s.evento(o.translation.PAGE_CONTACT,o.translation.GA_PUSH_OPEN_EXTERNAL_LINKS+": "+a),window.open(e,"_system")},e.phoneNumber=r.CONTACT_PHONE_NUMER,e.facebookUrl=i.ENDPOINTS_FACEBOOK,e.twitterUrl=i.ENDPOINTS_TWITTER,e.sendAnalytics=function(e,a){s.evento(e,a)},e.$on("$locationChangeSuccess",function(e,a){(a.indexOf("guest/contactMenu")>-1||a.indexOf("session/contactMenu")>-1)&&(s.pantalla(o.translation.PAGE_CONTACT),c.scrollTop())})}]),angular.module("ContactModule").controller("contactFormCtrl",["$scope","$ionicPlatform","$state","$ionicSlideBoxDelegate","$ionicLoading","$log","$rootScope","LocalStorageProvider","AnalyticsService","UtilsService","PopupService","ContactService","UTILS_CONFIG","$route","$ionicScrollDelegate",function(e,a,t,o,n,s,r,i,c,l,d,m,u,E,_){function g(){if(e.forms.contactForm){s.debug("reseteando Contact Form");var a=i.getLocalStorageItem("no_session_form_data");if(0==e.isLogged){if(a){e.forms.contactForm.rut.$setViewValue(a.rut),e.forms.contactForm.names.$setViewValue(a.name),e.forms.contactForm.lastName.$setViewValue(a.lastname),e.forms.contactForm.email.$setViewValue(a.email),e.forms.contactForm.phone.$setViewValue(a.phone),e.forms.contactForm.cellphone.$setViewValue(a.cellphone);var t=i.getLocalStorageItem("no_session_client_number");t&&e.forms.contactForm.numClient.$setViewValue(t)}else{e.forms.contactForm.rut.$viewValue="",e.forms.contactForm.names.$viewValue="",e.forms.contactForm.lastName.$viewValue="",e.forms.contactForm.email.$viewValue="",e.forms.contactForm.phone.$viewValue="",e.forms.contactForm.cellphone.$viewValue="";var t=i.getLocalStorageItem("no_session_client_number");t?e.forms.contactForm.numClient.$setViewValue(t):e.forms.contactForm.numClient.$viewValue=""}e.forms.contactForm.rut.$render(),e.forms.contactForm.names.$render(),e.forms.contactForm.lastName.$render(),e.forms.contactForm.email.$render(),e.forms.contactForm.phone.$render(),e.forms.contactForm.cellphone.$render(),e.forms.contactForm.numClient.$render()}e.forms.contactForm.topic.$viewValue="",e.forms.contactForm.topic.$render(),e.forms.contactForm.message.$viewValue="",e.forms.contactForm.message.$render(),e.forms.contactForm.$setPristine()}E.reload()}e.isIos=!1,a.is("ios")&&(e.isIos=!0),e.isLogged=r.isLogged,e.actualIndex=0,e.dataContactForm={},e.activeSlide=0,e.pagerClick=function(e){s.debug("se aplica slide button"),o.slide(e)},e.slideHasChanged=function(a){s.debug("slide ejecutado"),e.actualIndex<a?c.evento(r.translation.PAGE_CONTACT_FORM,r.translation.GA_SWIPE_RIGHT):c.evento(r.translation.PAGE_CONTACT_FORM,r.translation.GA_SWIPE_LEFT),e.actualIndex=a,g(),o.update(),E.reload()},e.sendAnalytics=function(e,a){c.evento(e,a)},e.forms={},e.buttons={chosen:""};var S=function(){n.show({template:u.STYLE_IONICLOADING_TEMPLATE}),l.getSubjectList().then(function(a){n.hide(),s.debug(),e.typeList=a},function(e){n.hide(),c.evento(r.translation.PAGE_CONTACT_FORM,r.translation.GA_ERROR_SERVICES_RESPONSE+"-"+r.translation.GET_SUBJECT_LIST+"-"+e.message+"-"+e.analyticsCode),s.error(e.message)}),e.dataContactForm.items=[],1==e.isLogged&&(n.show({template:u.STYLE_IONICLOADING_TEMPLATE}),l.getAssetList().then(function(a){if(a.length>0)i.getLocalStorageItem("asset_list_is_new_request")&&"true"===i.getLocalStorageItem("asset_list_is_new_request")&&(e.activeSlide=0),o.slide(e.activeSlide),e.dataContactForm.items=a,n.hide(),o.update();else{s.error("No data"),n.hide(),c.evento(r.translation.PAGE_CONTACT_FORM,r.translation.GA_SUCCESS_SERVICES_RESPONSE+"-"+r.translation.NO_DATA);var t=r.translation.ATTENTION_MODAL_TITLE,l=r.translation.NO_DATA;d.openModal("info",t,l,e)}},function(a){s.error("Error to get Asset List: ",a),n.hide(),c.evento(r.translation.PAGE_CONTACT_FORM,r.translation.GA_ERROR_SERVICES_RESPONSE+"-"+r.translation.GET_ASSET_LIST+"-"+a.message+"-"+a.analyticsCode);var t="error";a.code&&a.code.toString()==u.ERROR_INFO_CODE&&(t="info");var o=r.translation.ATTENTION_MODAL_TITLE,i=a.message;d.openModal(t,o,i,e)}))};e.validateForm=function(){if(e.forms.contactForm.$valid){c.evento(r.translation.PAGE_CONTACT_FORM,r.translation.GA_PUSH_SEND_FORM),s.debug("formulario OK");var a,o=e.forms.contactForm.topic.$viewValue.value,l=e.forms.contactForm.message.$viewValue;try{a=i.getLocalStorageItem("no_session_form_data")}catch(e){s.error("Error to get no_session_form_data localstorage ")}if(1==e.isLogged){var E=e.dataContactForm.items[e.actualIndex].numeroSuministro;n.show({template:u.STYLE_IONICLOADING_TEMPLATE}),m.setContactFormAuth(E,o,l).then(function(a){n.hide();var o=r.translation.ATTENTION_MODAL_TITLE,s=a.message;d.openModal("info",o,s,e,function(){t.go("session.contactMenu"),e.modal.hide()})},function(a){n.hide(),c.evento(r.translation.PAGE_CONTACT_FORM,r.translation.GA_ERROR_SERVICES_RESPONSE+"-"+r.translation.SET_CONTACT_FORM+"-"+a.message+"-"+a.analyticsCode);var t="error";a.code&&a.code.toString()==u.ERROR_INFO_CODE&&(t="info");var o=r.translation.ATTENTION_MODAL_TITLE,s=r.translation.ERROR_FIND_GEOCODE+a.message;d.openModal(t,o,s,e,function(){e.modal.hide()})})}else{var E=e.forms.contactForm.numClient.$viewValue,_=e.forms.contactForm.rut.$viewValue,g=e.forms.contactForm.names.$viewValue,S=e.forms.contactForm.lastName.$viewValue,A=e.forms.contactForm.email.$viewValue,T=e.forms.contactForm.phone.$viewValue,f=e.forms.contactForm.cellphone.$viewValue;a?(a.rut=e.forms.contactForm.rut.$viewValue,a.name=e.forms.contactForm.names.$viewValue,a.lastname=e.forms.contactForm.lastName.$viewValue,a.email=e.forms.contactForm.email.$viewValue,a.phone=e.forms.contactForm.phone.$viewValue,a.cellphone=e.forms.contactForm.cellphone.$viewValue):a={rut:e.forms.contactForm.rut.$viewValue,name:e.forms.contactForm.names.$viewValue,lastname:e.forms.contactForm.lastName.$viewValue,email:e.forms.contactForm.email.$viewValue,phone:e.forms.contactForm.phone.$viewValue,cellphone:e.forms.contactForm.cellphone.$viewValue},n.show({template:u.STYLE_IONICLOADING_TEMPLATE}),m.setContactForm(E,o,_,g,S,A,T,f,l).then(function(o){n.hide(),i.setLocalStorageItem("no_session_form_data",a);var s=r.translation.ATTENTION_MODAL_TITLE,c=o.message;d.openModal("info",s,c,e,function(){t.go("guest.contactMenu"),e.modal.hide()})},function(a){n.hide(),c.evento(r.translation.PAGE_CONTACT_FORM,r.translation.GA_ERROR_SERVICES_RESPONSE+"-"+r.translation.SET_CONTACT_FORM+"-"+a.message+"-"+a.analyticsCode);var t="error";a.code&&a.code.toString()==u.ERROR_INFO_CODE&&(t="info");var o=r.translation.ATTENTION_MODAL_TITLE,s=a.message;d.openModal(t,o,s,e,function(){e.modal.hide()})})}}else s.debug("formulario incorrecto")},e.$on("$locationChangeSuccess",function(e,a){(a.indexOf("guest/contactForm")>-1||a.indexOf("session/contactForm")>-1)&&(c.pantalla(r.translation.PAGE_CONTACT_FORM),_.scrollTop(),s.debug("llamando a resetForm Contact Form"),g(),S())})}]),angular.module("CoreModule").controller("branchesMapCtrl",["$scope","$state","$window","$rootScope","UtilsService","$cordovaGeolocation","ContactService","DataMapService","$log","LocalStorageProvider","$route","$ionicLoading","AnalyticsService","PopupService","UTILS_CONFIG","$ionicPlatform","$ionicScrollDelegate",function(e,a,t,o,n,s,r,i,c,l,d,m,u,E,_,g,S){function A(){e.forms.mapForm.search.$setViewValue(""),e.forms.mapForm.search.$modelValue.value="",e.forms.mapForm.search.$render();var a={zoom:parseInt(_.GOOGLE_MAPS_INIT_ZOOM,10),mapTypeId:google.maps.MapTypeId.ROADMAP};e.map=new google.maps.Map(document.getElementById("map"),a);var t={timeout:1e4,enableHighAccuracy:!0};if(g.is("cordova"))cordova&&cordova.plugins&&cordova.plugins.diagnostic&&cordova.plugins.diagnostic.isLocationEnabled(function(a){if(c.info("Location is "+(a?"enabled":"not enabled")),a)try{s.getCurrentPosition(t).then(function(a){var t=new google.maps.LatLng(a.coords.latitude,a.coords.longitude);c.debug("posicion: ",a.coords.latitude,"/",a.coords.longitude),e.map.setCenter(t)},function(e){c.error("Could not get location")})}catch(e){c.error("Could not get location")}else cordova.plugins.diagnostic.switchToLocationSettings()},function(e){c.error("The following error occurred: "+e)});else try{s.getCurrentPosition(t).then(function(a){var t=new google.maps.LatLng(a.coords.latitude,a.coords.longitude);c.debug("posicion: ",a.coords.latitude,"/",a.coords.longitude),e.map.setCenter(t)},function(e){c.error("Could not get location")})}catch(e){c.error("Could not get location")}r.getBranchesItems().then(function(a){e.markersJson=a,e.selectedItem(1)},function(a){u.evento(o.translation.PAGE_BRANCHES_MAP,o.translation.GA_ERROR_SERVICES_RESPONSE+"-"+o.translation.GET_BRANCHES+"-"+a.message+"-"+a.analyticsCode);var t="error";a.code&&a.code.toString()==_.ERROR_INFO_CODE&&(t="info");var n=o.translation.ATTENTION_MODAL_TITLE,s=a.message;E.openModal(t,n,s,e,function(){e.modal.remove()})}),o.tabActualAnalytics="Sucursales Cercanas"}function T(t,n){if(m.show({template:_.STYLE_IONICLOADING_TEMPLATE}),t&&e.map)for(var s=0;s<t.length;s++){var r=t[s],l=new google.maps.Marker({position:new google.maps.LatLng(r.latitud,r.longitud),map:e.map});l.addListener("click",function(e){return function(){u.evento(o.translation.PAGE_BRANCHES_MAP,o.translation.GA_PUSH_MARKER+": "+e.titulo),i.setItem("branches_detail",e),o.isLogged?a.go("session.branchesDescription"):a.go("guest.branchesDescription")}}(r)),n==_.CONTACT_CODE_BRANCHES?e.markersGoogle.branches.push(l):n==_.CONTACT_CODE_PAYMENT_PLACES&&e.markersGoogle.paymentPlaces.push(l)}else c.error("imposible to get markers");n==_.CONTACT_CODE_BRANCHES?e.selectedBar1=!0:n==_.CONTACT_CODE_PAYMENT_PLACES&&(e.selectedBar2=!0),m.hide()}function f(e){if(m.show({template:_.STYLE_IONICLOADING_TEMPLATE}),e&&e.length>0)for(var a=0;a<e.length;a++){var t=e[a];t.setMap(null)}m.hide()}e.forms={},e.goToMap=function(){u.evento(o.translation.PAGE_BRANCHES_MAP,o.translation.GA_PUSH_OPEN_MAP),o.tabActualAnalytics="Sucursales Cercanas",c.debug("go goToMap"),c.debug("$rootScope.isLogged: "+o.isLogged),o.isLogged?a.go("session.branchesMap"):a.go("guest.branchesMap")},e.goToList=function(){u.evento(o.translation.PAGE_BRANCHES_MAP,o.translation.GA_PUSH_OPEN_LIST),o.tabActualAnalytics="Sucursales Cercanas",c.debug("go goToList"),c.debug("$rootScope.isLogged: "+o.isLogged),1==o.isLogged?a.go("session.branchesList"):a.go("guest.branchesList")},e.markersJson={},e.markersGoogle={},e.markersGoogle.branches=[],e.markersGoogle.paymentPlaces=[];var C=_.CONTACT_CODE_BRANCHES,p=_.CONTACT_CODE_PAYMENT_PLACES;e.sendAnalytics=function(e,a){u.evento(e,a)},e.selectedItem=function(t){switch(e.selectedBar1=!1,e.selectedBar2=!1,c.debug("$scope.selectedBar1: "+e.selectedBar1),c.debug("$scope.selectedBar2: "+e.selectedBar2),c.debug("$scope.selectedBar3: "+e.selectedBar3),t){case 1:u.evento(o.translation.PAGE_BRANCHES_MAP,o.translation.GA_PUSH_BRANCHES),o.tabActualAnalytics="Sucursales Cercanas",c.debug("Selected Case Number is 1"),f(e.markersGoogle.branches),f(e.markersGoogle.paymentPlaces),o.isLogged?a.go("session.branchesMap"):a.go("guest.branchesMap"),e.markersJson.branches&&T(e.markersJson.branches,C),d.reload();break;case 2:u.evento(o.translation.PAGE_BRANCHES_MAP,o.translation.GA_PUSH_PLACES_OF_PAYMENT),o.tabActualAnalytics="Sucursales Cercanas",c.debug("Selected Case Number is 2"),f(e.markersGoogle.branches),f(e.markersGoogle.paymentPlaces),o.isLogged?a.go("session.branchesMap"):a.go("guest.branchesMap"),e.markersJson.paymentPlaces&&T(e.markersJson.paymentPlaces,p),d.reload();break;case 3:u.evento(o.translation.PAGE_BRANCHES_MAP,o.translation.GA_PUSH_OTHER_MEANS_OF_PAYMENT),o.tabActualAnalytics="Sucursales Cercanas",c.debug("Selected Case Number is 3"),o.isLogged?a.go("session.paymentOptions"):a.go("guest.paymentOptions"),d.reload();break;default:u.evento(o.translation.PAGE_BRANCHES_MAP,o.translation.GA_PUSH_BRANCHES),e.selectedBar1=!0,o.tabActualAnalytics="Sucursales Cercanas",c.debug("Selected Case Default"),f(e.markersGoogle.branches),f(e.markersGoogle.paymentPlaces),o.isLogged?a.go("session.branchesMap"):a.go("guest.branchesMap"),e.markersJson.branches&&T(e.markersJson.branches,C),d.reload()}},e.searchElementOnMap=function(a){if(u.evento(o.translation.PAGE_BRANCHES_MAP,o.translation.GA_PUSH_SEARCH_BRANCHES),a&&a.length>0){c.debug("address.length: ",a.length),m.show({template:_.STYLE_IONICLOADING_TEMPLATE});(new google.maps.Geocoder).geocode({address:a,componentRestrictions:{country:_.GOOGLE_MAPS_RESTRICTED_COUNTRY}},function(a,t){if("OK"==t)e.map.setCenter(a[0].geometry.location),e.map.setZoom(parseInt(_.GOOGLE_MAPS_SEARCH_ZOOM,10)),m.hide();else{m.hide(),c.error("Geocode was not successful for the following reason: "+t);var n=o.translation.ATTENTION_MODAL_TITLE,s=o.translation.ERROR_FIND_GEOCODE+t;E.openModal("info",n,s,e,function(){e.modal.remove()})}})}else{c.error("Search button empty");var t=o.translation.ATTENTION_MODAL_TITLE,n=o.translation.MUST_NOT_EMPTY;E.openModal("info",t,n,e,function(){e.modal.remove()})}},e.$on("$locationChangeSuccess",function(e,a){(a.indexOf("session/branchesMap")>-1||a.indexOf("guest/branchesMap")>-1)&&(u.pantalla(o.translation.PAGE_BRANCHES_MAP),S.scrollTop(),A())})}]),angular.module("CoreModule").controller("branchesListCtrl",["$scope","$state","$rootScope","$log","LocalStorageProvider","DataMapService","ContactService","$ionicLoading","PopupService","UTILS_CONFIG","AnalyticsService","$ionicScrollDelegate",function(e,a,t,o,n,s,r,i,c,l,d,m){function u(){e.branchesList={},i.show({template:l.STYLE_IONICLOADING_TEMPLATE}),r.getBranchesItems().then(function(a){o.debug(a),e.branchesList=a,i.hide()},function(a){o.error(a),d.evento(t.translation.PAGE_BRANCHES_LIST,t.translation.GA_ERROR_SERVICES_RESPONSE+"-"+t.translation.GET_BRANCHES+"-"+a.message+"-"+a.analyticsCode);var n="error";a.code&&a.code.toString()==l.ERROR_INFO_CODE&&(n="info");var s=t.translation.ATTENTION_MODAL_TITLE,r=a.message;c.openModal(n,s,r,e,function(){e.modal.hide()}),i.hide()})}e.goToMap=function(){d.evento(t.translation.PAGE_BRANCHES_LIST,t.translation.GA_PUSH_OPEN_MAP),o.debug("go goToMap"),o.debug("$rootScope.isLogged: "+t.isLogged),t.isLogged?a.go("session.branchesMap"):a.go("guest.branchesMap")},e.goToList=function(){d.evento(t.translation.PAGE_BRANCHES_LIST,t.translation.GA_PUSH_OPEN_LIST),o.debug("go goToList"),o.debug("$rootScope.isLogged: "+t.isLogged),t.isLogged?a.go("session.branchesList"):a.go("guest.branchesList")},e.viewDescription=function(n){d.evento(t.translation.PAGE_BRANCHES_LIST,t.translation.GA_PUSH_VIEW_DESCRIPTION),e.branchesList.branches&&e.branchesList.branches[n]?(s.setItem("branches_detail",e.branchesList.branches[n]),t.isLogged?a.go("session.branchesDescription"):a.go("guest.branchesDescription")):o.error("Imposible to find element in list")},e.sendAnalytics=function(e,a){d.evento(e,a)},e.$on("$locationChangeSuccess",function(e,a){(a.indexOf("session/branchesList")>-1||a.indexOf("guest/branchesList")>-1)&&(d.pantalla(t.translation.PAGE_BRANCHES_LIST),m.scrollTop(),u())})}]),angular.module("CoreModule").controller("branchesDescriptionCtrl",["$scope","$state","$window","UtilsService","DataMapService","$log","ENDPOINTS","UTILS_CONFIG","AnalyticsService","$rootScope","$ionicScrollDelegate",function(e,a,t,o,n,s,r,i,c,l,d){function m(){e.branchesDescription={},e.showHtmlImage=!1,e.showHtmlPaymentHour=!1,e.showHtmlSpecialHour=!1,e.showHtmlOpeningHour=!1,e.showHtmlDetail=!1;try{if(n.getItem("branches_detail",!1)){if(e.branchesDescription=n.getItem("branches_detail",!1),s.debug("branchesDescription: ",e.branchesDescription),e.branchesDescription.imagen.match("<"))e.branchesDescription.imagen=u(e.branchesDescription.imagen,"\\",'""'),e.branchesDescription.imagen=u(e.branchesDescription.imagen,"amp;",""),e.branchesDescription.imagen=u(e.branchesDescription.imagen,'href="/','href="'+r.ENDPOINTS_BASE_EXTERNAL+"/"),e.branchesDescription.imagen=u(e.branchesDescription.imagen,'src="/','src="'+r.ENDPOINTS_BASE_EXTERNAL+"/"),e.showHtmlImage=!0,s.debug("new image: ",e.branchesDescription.imagen);else if(null===e.branchesDescription.imagen||""===e.branchesDescription.imagen){e.showHtmlImage=!1;var a=t.innerWidth,o=r.ENDPOINTS_GOOGLE_STATICS_MAP+"?center="+e.branchesDescription.latitud+","+e.branchesDescription.longitud+"&zoom="+i.GOOGLE_MAPS_GOOGLE_STATIC_ZOOM+"&size="+a+"x300&maptype="+i.GOOGLE_MAPS_TYPE_MAP+"&format=png&visual_refresh=true&markers="+e.branchesDescription.latitud+","+e.branchesDescription.longitud+"&key="+i.GOOGLE_MAPS_KEY;e.branchesDescription.imagen=o}e.branchesDescription.horario_pago.match("<")&&(e.branchesDescription.horario_pago=u(e.branchesDescription.horario_pago,"\\",'""'),e.branchesDescription.horario_pago=u(e.branchesDescription.horario_pago,"amp;",'""'),e.branchesDescription.horario_pago=u(e.branchesDescription.horario_pago,'href="/','href="'+r.ENDPOINTS_BASE_EXTERNAL+"/"),e.branchesDescription.horario_pago=u(e.branchesDescription.horario_pago,'src="/','src="'+r.ENDPOINTS_BASE_EXTERNAL+"/"),
e.showHtmlPaymentHour=!0,s.debug("new horario_pago: ",e.branchesDescription.horario_pago)),e.branchesDescription.horario_especial.match("<")&&(e.branchesDescription.horario_especial=u(e.branchesDescription.horario_especial,"\\",'""'),e.branchesDescription.horario_especial=u(e.branchesDescription.horario_especial,"amp;",'""'),e.branchesDescription.horario_especial=u(e.branchesDescription.horario_especial,'href="/','href="'+r.ENDPOINTS_BASE_EXTERNAL+"/"),e.branchesDescription.horario_especial=u(e.branchesDescription.horario_especial,'src="/','src="'+r.ENDPOINTS_BASE_EXTERNAL+"/"),e.showHtmlSpecialHour=!0,s.debug("new horario_especial: ",e.branchesDescription.horario_especial)),e.branchesDescription.horario_apertura.match("<")&&(e.branchesDescription.horario_apertura=u(e.branchesDescription.horario_apertura,"\\",'""'),e.branchesDescription.horario_apertura=u(e.branchesDescription.horario_apertura,"amp;",'""'),e.branchesDescription.horario_apertura=u(e.branchesDescription.horario_apertura,'href="/','href="'+r.ENDPOINTS_BASE_EXTERNAL+"/"),e.branchesDescription.horario_apertura=u(e.branchesDescription.horario_apertura,'src="/','src="'+r.ENDPOINTS_BASE_EXTERNAL+"/"),e.showHtmlOpeningHour=!0,s.debug("new horario_apertura: ",e.branchesDescription.horario_apertura)),e.branchesDescription.detalle.match("<")&&(e.branchesDescription.detalle=u(e.branchesDescription.detalle,"\\",'""'),e.branchesDescription.detalle=u(e.branchesDescription.detalle,"amp;",'""'),e.branchesDescription.detalle=u(e.branchesDescription.detalle,'href="/','href="'+r.ENDPOINTS_BASE_EXTERNAL+"/"),e.branchesDescription.detalle=u(e.branchesDescription.detalle,'src="/','src="'+r.ENDPOINTS_BASE_EXTERNAL+"/"),e.showHtmlDetail=!0,s.debug("new detalle: ",e.branchesDescription.detalle))}else s.error("Error to get branches_detail"),c.evento(l.translation.PAGE_BRANCHES_DETAIL,l.translation.GA_SUCCESS_SERVICES_RESPONSE+"-"+l.translation.GET_BRANCHES_DETAIL)}catch(e){s.error("Error to get branches_detail: ",e),c.evento(l.translation.PAGE_BRANCHES_DETAIL,l.translation.GA_SUCCESS_SERVICES_RESPONSE+"-"+l.translation.GET_BRANCHES_DETAIL)}}function u(e,a,t){return e.replace(new RegExp(E(a),"g"),t)}function E(e){return e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}e.goBack=function(){c.evento(l.translation.PAGE_BRANCHES_DESCRIPTION,l.translation.GA_PUSH_BACK_BUTTON),n.getItem("branches_detail",!1)&&(s.debug("se eliminará el objeto detalle"),n.deleteItem("branches_detail")),t.history.back()},e.openNavigator=function(e,a,t){c.evento(l.translation.PAGE_BRANCHES_DESCRIPTION,l.translation.GA_PUSH_OPEN_EXTERNAL_BRANCHES+" - "+t);var o="";ionic.Platform.isIOS()?o="maps://?q="+e+","+a:ionic.Platform.isAndroid()&&(o="geo:0,0?q="+e+","+a+"("+t+")"),window.open(o,"_system")},e.sendAnalytics=function(e,a){c.evento(e,a)},e.$on("$locationChangeSuccess",function(e,a){(a.indexOf("session/branchesDescription")>-1||a.indexOf("guest/branchesDescription")>-1)&&(c.pantalla(l.translation.PAGE_BRANCHES_DESCRIPTION),d.scrollTop(),m())})}]),angular.module("BillsModule").controller("payBillCtrl",["$scope","$state","DataMapService","$log","AnalyticsService","$rootScope","$ionicLoading","BillsService","PopupService","ENDPOINTS","$sce","UTILS_CONFIG","LocalStorageProvider","$ionicScrollDelegate",function(e,a,t,o,n,s,r,i,c,l,d,m,u,E){function _(){e.isLogged=s.isLogged,e.numeroSuministro="",e.numeroSuministroDv="",e.direccion="",e.comuna="",e.items=[];try{var a=t.getItem("payBillObject");o.debug("payBillObjects: ",a),a&&(e.numeroSuministro=a.numeroSuministro,e.numeroSuministroDv=a.numeroSuministroDv,e.direccion=a.direccion,a.comuna&&(e.comuna=a.comuna),e.items=a.items,S=a.index,o.debug("largo array: ",e.items.length),e.items[2]?(e.payBill=a.items[2].monto,e.selectedDebt=a.items[2],e.showThirdElement=!0,e.showSecondElement=!0,e.showFirstElement=!0):e.items[1]?(e.payBill=a.items[1].monto,e.selectedDebt=a.items[1],e.showThirdElement=!1,e.showSecondElement=!0,e.showFirstElement=!0):e.items[0]&&(e.payBill=a.items[0].monto,e.selectedDebt=a.items[0],e.showThirdElement=!1,e.showSecondElement=!1,e.showFirstElement=!0),o.debug("$scope.showThirdElement",e.showThirdElement),o.debug("$scope.showSecondElement",e.showSecondElement),o.debug("$scope.showFirstElement",e.showFirstElement))}catch(e){o.debug("Error: ",e)}}function g(){o.info("reseteando Pay Bill");var a=u.getLocalStorageItem("no_session_form_data");if(!force.isAuthenticated()&&a)e.forms.payBillForm.email.$setViewValue(a.email);else if(force.isAuthenticated()){var t=u.getLocalStorageItem("USER_DATA");t?e.forms.payBillForm.email.$setViewValue(t.email):e.forms.payBillForm.email.$setViewValue("")}else e.forms.payBillForm.email.$setViewValue("");e.forms.payBillForm.email.$render(),e.forms.payBillForm.$setPristine()}e.selectedDebt={},e.translation=s.translation,e.paymentType_1=m.PAYMENT_PAYMENTTYPE_1,e.paymentType_2=m.PAYMENT_PAYMENTTYPE_2,e.paymentType_3=m.PAYMENT_PAYMENTTYPE_3,e.showThirdElement=!1,e.showSecondElement=!1,e.showFirstElement=!1;var S=0;e.forms={},e.validateForm=function(){if(e.forms.payBillForm.$valid){n.evento(s.translation.PAGE_PAYMENT,s.translation.GA_PUSH_PAY_BILL),o.debug("formulario OK");var t=u.getLocalStorageItem("no_session_form_data");t?force.isAuthenticated()||(t.email=e.forms.payBillForm.email.$viewValue):force.isAuthenticated()||(t={email:e.forms.payBillForm.email.$viewValue}),u.setLocalStorageItem("no_session_form_data",t);var E={};if(E.amount=e.selectedDebt.monto,E.paymentType=e.selectedDebt.tipoDeuda,E.email=e.forms.payBillForm.email.$viewValue,e.email=e.forms.payBillForm.email.$viewValue,E.expirationDate=e.selectedDebt.fechaVencimiento,E.issueDate=e.selectedDebt.fechaEmision,E.onClickDate=moment().format("DD/MM/YYYY HH:mm:ss"),E.barcode=e.selectedDebt.codigoBarra,E.rut="11111111-1",E.name="Nombre",e.isLogged&&u.getLocalStorageItem("USER_DATA",!1)){var _=u.getLocalStorageItem("USER_DATA",!1);E.rut=_.rut,E.name=_.nombre}r.show({template:m.STYLE_IONICLOADING_TEMPLATE}),e.selectedTrxId=e.selectedDebt.trxId,i.generateXmlPayment(E).then(function(t){r.hide(),o.debug("conversion exitosa de XML");var n=s.translation.VALIDATION_MODAL_TITLE,i={};i.url=d.trustAsResourceUrl(l.ENDPOINTS_PAYMENT),i.xml=t,c.openModal("payment",n,i,e,function(){e.modal.remove().then(function(){e.modal=null,e.isLogged?a.go("session.usage"):a.go("guest.home")})})},function(t){r.hide(),n.evento(s.translation.PAGE_PAYMENT,s.translation.GA_ERROR_SERVICES_RESPONSE+"-"+s.translation.GENERATE_XML_PAYMENT+"-"+t.message+"-"+t.analyticsCode);var o="error";t.code&&t.code.toString()==m.ERROR_INFO_CODE&&(o="info");var i=s.translation.ATTENTION_MODAL_TITLE,l=t.message;c.openModal(o,i,l,e,function(){e.modal.remove().then(function(){e.modal=null,e.isLogged?a.go("session.usage"):a.go("guest.home")})})})}else o.debug("formulario incorrecto")},e.selectItem=function(a){o.debug("valor de index: ",a),e.selectedDebt=e.items[a]},e.generateTemplateBill=function(t,l){u.getLocalStorageItem("asset_debt_"+S)&&u.getLocalStorageItem("asset_debt_"+S),u.getLocalStorageItem("asset_detail_"+S)&&u.removeLocalStorageItem("asset_detail_"+S);var d=e.selectedTrxId,E="false",_=l.split("?")[1];_=decodeURIComponent(_);for(var g=_.split("&"),A=[],T=0;T<2;T++)A[g[T].split("=")[0]]=g[T].split("=")[1];if(void 0!==A.idTransaccion&&null!==A.idTransaccion){var f=A.idTransaccion,C=CryptoJS.enc.Base64.parse(f);d=CryptoJS.enc.Utf8.stringify(C)}else o.error("Imposible to finde trxid");void 0!==A.exito&&null!==A.exito?E=A.exito.toString():o.error("Imposible to finde success code"),e.modal.remove().then(function(){e.modal=null}),r.show({template:m.STYLE_IONICLOADING_TEMPLATE}),i.generateTemplateBill(d,e.numeroSuministro,e.email,E).then(function(n){r.hide(),o.debug("generacion exitosa de template de la boleta");var i=t,l="",d="";"successPayment"==t?(l=s.translation.ATTENTION_MODAL_TITLE,d={},d.numeroCliente=e.numeroSuministroDv,d.monto=e.selectedDebt.monto,d.direccion=e.direccion,d.comuna=e.comuna,d.numeroTransaccion=n.IdTransaccionComercial,d.canalPago=n.nombreBanco,d.fecha=n.fechaOnClick,d.mensaje=n.mensaje,d.rrss=m.PAYMENT_RRSS_IMAGE):(l=s.translation.ATTENTION_MODAL_TITLE,d=s.translation.INCOMPLETE_PAYMENT),c.openModal(i,l,d,e,function(){e.modal.remove().then(function(){e.modal=null,e.isLogged?a.go("session.usage"):a.go("guest.home")})})},function(t){r.hide(),n.evento(s.translation.PAGE_PAYMENT,s.translation.GA_ERROR_SERVICES_RESPONSE+"-"+s.translation.GENERATE_TEMPLATE_BILL+"-"+t.message+"-"+t.analyticsCode);var o="error";t.code&&t.code.toString()==m.ERROR_INFO_CODE&&(o="info");var i=s.translation.ATTENTION_MODAL_TITLE,l=t.message;c.openModal(o,i,l,e,function(){e.modal.remove().then(function(){e.modal=null,e.isLogged?a.go("session.usage"):a.go("guest.home")})})})},e.sendAnalytics=function(e,a){n.evento(e,a)},e.$on("$locationChangeSuccess",function(e,a){(a.indexOf("guest/payBill")>-1||a.indexOf("session/payBill")>-1)&&(o.debug("llamando a resetForm Pay Bill"),n.pantalla(s.translation.PAGE_PAYMENT),E.scrollTop(),g(),_())})}]),angular.module("BillsModule").controller("enterReadingCtrl",["$scope","$state","$rootScope","$log","$ionicLoading","$ionicModal","DataMapService","LocalStorageProvider","BillsService","PopupService","UTILS_CONFIG","AnalyticsService","$ionicScrollDelegate",function(e,a,t,o,n,s,r,i,c,l,d,m,u){function E(){o.debug("reseteando Enter Reading"),e.forms.enterReadingForm.reading.$viewValue="",e.forms.enterReadingForm.readingDay.$viewValue="",e.forms.enterReadingForm.readingNight.$viewValue="",e.forms.enterReadingForm.readingPeak.$viewValue="",e.forms.enterReadingForm.$setPristine()}function _(){e.assetDetail.tarifa===d.USAGE_TYPE_RATE_1?(e.showFields.day=!1,e.showFields.night=!1,e.showFields.peak=!1,e.showFields.reading=!0):(e.assetDetail.tarifa,d.USAGE_TYPE_RATE_2,e.showFields.reading=!1,e.showFields.day=!0,e.showFields.night=!0,e.showFields.peak=!0)}e.forms={},e.selectedIndex=-1,e.assetDetail={},e.showFields={reading:!0,day:!0,night:!0,peak:!0},e.validateForm=function(){e.forms.enterReadingForm.$valid?(o.debug("formulario OK"),e.enterReading()):o.debug("formulario incorrecto")},e.enterReading=function(){m.evento(t.translation.PAGE_ENTER_READING,t.translation.GA_PUSH_SEND_READING);var a={};a.reading=e.forms.enterReadingForm.reading.$modelValue,a.day=e.forms.enterReadingForm.readingDay.$modelValue,a.night=e.forms.enterReadingForm.readingNight.$modelValue,a.peak=e.forms.enterReadingForm.readingPeak.$modelValue,n.show({template:d.STYLE_IONICLOADING_TEMPLATE}),c.setEnterReading(e.assetDetail.numeroSuministro,a.reading,a.day,a.night,a.peak).then(function(a){if(n.hide(),a.data){o.debug("success: ",a);var s="info",r=t.translation.ATTENTION_MODAL_TITLE,i=a.message;l.openModal(s,r,i,e)}else{o.error("no data"),m.evento(t.translation.PAGE_ENTER_READING,t.translation.GA_SUCCESS_SERVICES_RESPONSE+"-"+t.translation.NO_DATA);var s="info",r=t.translation.ATTENTION_MODAL_TITLE,i=t.translation.NO_DATA;l.openModal(s,r,i,e)}},function(a){n.hide(),m.evento(t.translation.PAGE_ENTER_READING,t.translation.GA_ERROR_SERVICES_RESPONSE+"-"+t.translation.ENTER_READING+"-"+a.message+"-"+a.analyticsCode);var o="error";a.code&&a.code.toString()==d.ERROR_INFO_CODE&&(o="info");var s=t.translation.ATTENTION_MODAL_TITLE,r=a.message;l.openModal(o,s,r,e)})},e.closeModal=function(){e.modal.hide(),a.go("session.usage")},e.goBack=function(){m.evento(t.translation.PAGE_ENTER_READING,t.translation.GA_PUSH_BACK_BUTTON),a.go("session.usage")},e.sendAnalytics=function(e,a){m.evento(e,a)},e.$on("$locationChangeSuccess",function(a,n){n.indexOf("session/enterReading")>-1&&(o.debug("llamando a resetForm Enter Reading"),m.pantalla(t.translation.PAGE_ENTER_READING),u.scrollTop(),e.selectedIndex=r.getItem("currentUsageIndex",!0),e.assetDetail=i.getLocalStorageItem("asset_detail_"+e.selectedIndex),o.debug(e.selectedIndex),o.debug(e.assetDetail.tarifa),_(),E())})}]),angular.module("AccessModule").controller("verificationStepTwoCtrl",["$state","$scope","$log","DataMapService","AccessService","PopupService","$ionicLoading","$rootScope","UTILS_CONFIG","AnalyticsService","$ionicScrollDelegate",function(e,a,t,o,n,s,r,i,c,l,d){function m(){l.evento(i.translation.PAGE_VERIFICATION_PASS,i.translation.GA_PUSH_CHANGE_YOUR_PASS);var t=a.forms.verificationPass.newPass.$modelValue,d=a.forms.verificationPass.repeatNewPass.$modelValue,m=o.getItem("verification_step_1_rut"),u=a.forms.verificationPass.code.$modelValue;r.show({template:c.STYLE_IONICLOADING_TEMPLATE}),n.changePasswordNoAuth(m,t,d,u).then(function(t){s.openModal("info",i.translation.ATTENTION_MODAL_TITLE,i.translation.SUCCESS_PROFILE_CHANGE,a,function(){e.go("guest.login"),a.modal.hide()})},function(e){l.evento(i.translation.PAGE_VERIFICATION_PASS,i.translation.GA_ERROR_SERVICES_RESPONSE+"-"+i.translation.CHANGE_YOUR_PASS+"-"+e.message+"-"+e.analyticsCode),r.hide();var t="error";e.code&&e.code.toString()==c.ERROR_INFO_CODE&&(t="info");var o=i.translation.ATTENTION_MODAL_TITLE,n=e.message;s.openModal(t,o,n,a,function(){a.modal.hide()})})}function u(){t.info("reseteando VerificationPass"),a.forms.verificationPass.newPass.$viewValue="",a.forms.verificationPass.newPass.$render(),a.forms.verificationPass.repeatNewPass.$viewValue="",a.forms.verificationPass.repeatNewPass.$render(),a.forms.verificationPass.code.$viewValue="",a.forms.verificationPass.code.$render(),a.forms.verificationPass.$setPristine()}a.forms={},a.formValidation=function(){a.forms.verificationPass.$valid?(t.debug("datos ok"),m()):t.debug("formulario incorrecto")},a.regenerateCode=function(){l.evento(i.translation.PAGE_VERIFICATION_PASS,i.translation.GA_PUSH_REGENERATE_CODE);var e;try{e=o.getItem("verification_step_1_rut",!1)}catch(e){t.debug("no es posible obtener user_id");var d=i.translation.ATTENTION_MODAL_TITLE,m=i.translation.NOT_POSSIBLE_GET_USER;return void s.openModal("info",d,m,a,function(){a.modal.hide()})}r.show({template:c.STYLE_IONICLOADING_TEMPLATE});var u=e;n.requestPasswordChangeCode(u).then(function(e){r.hide();var t=i.translation.ATTENTION_MODAL_TITLE,o=i.translation.SUCCESS_CODE_SENT;s.openModal("info",t,o,a,function(){a.modal.hide()})},function(e){l.evento(i.translation.PAGE_VERIFICATION_PASS,i.translation.GA_ERROR_SERVICES_RESPONSE+"-"+i.translation.REGENERATE_CODE+"-"+e.message+"-"+e.analyticsCode);var t="error";e.code&&e.code.toString()==c.ERROR_INFO_CODE&&(t="info");var o=i.translation.ATTENTION_MODAL_TITLE,n=e.message;s.openModal(t,o,n,a,function(){a.modal.hide()})})},a.sendAnalytics=function(e,a){l.evento(e,a)},a.$on("$locationChangeSuccess",function(e,a){a.indexOf("guest/verificationStepTwo")>-1&&(l.pantalla(i.translation.PAGE_VERIFICATION_PASS),d.scrollTop(),t.debug("llamando a resetForm verificationStepTwo"),u())})}]),angular.module("AccessModule").controller("verificationStepOneCtrl",["$state","$scope","$log","LocalStorageProvider","DataMapService","$rootScope","PopupService","AccessService","$ionicLoading","UTILS_CONFIG","AnalyticsService","$ionicScrollDelegate",function(e,a,t,o,n,s,r,i,c,l,d,m){function u(){t.debug("reseteando Verification"),a.forms.step1Verification.rut.$viewValue="",a.forms.step1Verification.rut.$render(),a.forms.step1Verification.$setPristine()}a.forms={},a.sendAnalytics=function(e,a){d.evento(e,a)},a.formValidationStep1=function(){if(a.forms.step1Verification.$valid){d.evento(s.translation.PAGE_VERIFICATION,s.translation.GA_PUSH_SEND_CODE),t.debug("datos ok"),c.show({template:l.STYLE_IONICLOADING_TEMPLATE});var o=a.forms.step1Verification.rut.$viewValue,m=0;m=o.indexOf("-")>-1?o.indexOf("-"):o.length-1;var u=o.substring(0,m),E=u+"-"+o.substr(o.length-1);i.requestPasswordChangeCode(E).then(function(t){c.hide();var o=s.translation.ATTENTION_MODAL_TITLE,i=s.translation.SUCCESS_CODE_SENT;r.openModal("info",o,i,a,function(){n.setItem("verification_step_1_rut",E),e.go("guest.verificationStepTwo"),a.modal.hide()})},function(e){d.evento(s.translation.PAGE_VERIFICATION,s.translation.GA_ERROR_SERVICES_RESPONSE+"-"+s.translation.VERIFICATION+"-"+e.message+"-"+e.analyticsCode);var t="error";e.code&&e.code==l.ERROR_INFO_CODE&&(t="info");var o=s.translation.ATTENTION_MODAL_TITLE,n=e.message;r.openModal(t,o,n,a,function(){a.modal.hide()})})}else t.debug("formulario incorrecto")},a.goBack=function(){d.evento(s.translation.PAGE_VERIFICATION,s.translation.GA_PUSH_BACK_BUTTON),e.go("guest.login")},a.$on("$locationChangeSuccess",function(e,a){a.indexOf("guest/verificationStepOne")>-1&&(d.pantalla(s.translation.PAGE_VERIFICATION),m.scrollTop(),t.debug("llamando a resetForm verificationStepOne"),u())})}]),angular.module("AccessModule").controller("validationCtrl",["$state","$scope","$log","AccessService","DataMapService","$rootScope","PopupService","$ionicLoading","UTILS_CONFIG","AnalyticsService","$ionicScrollDelegate",function(e,a,t,o,n,s,r,i,c,l,d){function m(){l.evento(s.translation.PAGE_VALIDATION,s.translation.GA_PUSH_VALIDATE_USER);var d;try{d=n.getItem("new_user_id",!1)}catch(e){t.debug("no es posible obtener user_id");var m=s.translation.ATTENTION_MODAL_TITLE,u=s.translation.NOT_POSSIBLE_GET_USER;return r.openModal("info",m,u,a,function(){a.modal.hide()}),void t.debug("no es posible obtener new:user_id")}i.show({template:c.STYLE_IONICLOADING_TEMPLATE}),o.validateUser(d,a.forms.activateAccount.insertCode.$viewValue).then(function(o){i.hide(),t.debug(o);var n=s.translation.ATTENTION_MODAL_TITLE,c=s.translation.SUCCESS_USER_VALIDATED;r.openModal("info",n,c,a,function(){e.go("guest.login"),a.modal.hide()})},function(e){i.hide(),l.evento(s.translation.PAGE_VALIDATION,s.translation.GA_ERROR_SERVICES_RESPONSE+"-"+s.translation.VALIDATE_USER+"-"+e.message+"-"+e.analyticsCode);var t="error";e.code&&e.code.toString()==c.ERROR_INFO_CODE&&(t="info");var o=s.translation.ATTENTION_MODAL_TITLE,n=e.message;r.openModal(t,o,n,a,function(){a.modal.hide()})})}function u(){t.debug("reseteando Validation"),a.forms.activateAccount.insertCode.$viewValue="",a.forms.activateAccount.insertCode.$render(),a.forms.activateAccount.$setPristine()}a.forms={},a.sendAnalytics=function(e,a){l.evento(e,a)},a.validateForm=function(){a.forms.activateAccount.$valid?(t.debug("formulario ok"),m()):t.debug("formulario incorrecto")},a.regenerateCode=function(){l.evento(s.translation.PAGE_VALIDATION,s.translation.GA_PUSH_REGENERATE_CODE);try{n.getItem("verification_step_1_rut",!1)}catch(o){t.debug("no es posible obtener rut_id");var e=s.translation.ATTENTION_MODAL_TITLE,d=s.translation.NOT_POSSIBLE_GET_USER_RUT;return void r.openModal("info",e,d,a,function(){a.modal.hide()})}i.show({template:c.STYLE_IONICLOADING_TEMPLATE});var m=n.getItem("verification_step_1_rut");o.requestPasswordChangeCode(m).then(function(e){i.hide();var t=s.translation.ATTENTION_MODAL_TITLE,o=s.translation.SUCCESS_CODE_SENT;r.openModal("info",t,o,a,function(){a.modal.hide()})},function(e){l.evento(s.translation.PAGE_VALIDATION,s.translation.GA_ERROR_SERVICES_RESPONSE+"-"+s.translation.REGENERATE_CODE+"-"+e.message+"-"+e.analyticsCode);var t="error";e.code&&e.code.toString()==c.ERROR_INFO_CODE&&(t="info");var o=s.translation.ATTENTION_MODAL_TITLE,n=e.message;r.openModal(t,o,n,a,function(){a.modal.hide()})})},a.$on("$locationChangeSuccess",function(e,a){a.indexOf("guest/validation")>-1&&(l.pantalla(s.translation.PAGE_VALIDATION),d.scrollTop(),t.debug("llamando a resetForm Validation"),u())})}]),angular.module("AccessModule").controller("registerCtrl",["$scope","$log","AccessService","$ionicLoading","DataMapService","$rootScope","PopupService","$state","UTILS_CONFIG","AnalyticsService","$ionicScrollDelegate",function(e,a,t,o,n,s,r,i,c,l,d){function m(){l.evento(s.translation.PAGE_REGISTER,s.translation.GA_PUSH_REGISTER);var a=e.forms.registerForm.rut.$viewValue,d=0;d=a.indexOf("-")>-1?a.indexOf("-"):a.length-1;var m=a.substring(0,d),u=m+"-"+a.substr(a.length-1),E=e.forms.registerForm.numClient.$viewValue,_=0;_=E.indexOf("-")>-1?E.indexOf("-"):E.length-1;var g=E.substring(0,_),S=(E.substr(E.length-1),{rut:u,name:e.forms.registerForm.names.$viewValue,FathersLastName:e.forms.registerForm.lastName.$viewValue,MothersLastName:e.forms.registerForm.motherLastName.$viewValue,HomePhone:e.forms.registerForm.phone.$viewValue,MobilePhone:e.forms.registerForm.cellphone.$viewValue,email:e.forms.registerForm.email.$viewValue,alias:g,numberClient:g,numberTicket:e.forms.registerForm.numLastService.$viewValue,newPassword:e.forms.registerForm.password.$viewValue,verifyNewPassword:e.forms.registerForm.passwordConfirm.$viewValue});o.show({template:c.STYLE_IONICLOADING_TEMPLATE}),t.registerUser(S).then(function(e){o.hide(),n.setItem("new_user_id",e.userId),n.setItem("verification_step_1_rut",S.rut),i.go("guest.validation")},function(a){o.hide(),l.evento(s.translation.PAGE_REGISTER,s.translation.GA_ERROR_SERVICES_RESPONSE+"-"+s.translation.REGISTER+"-"+a.message+"-"+a.analyticsCode);var t="error";a.code&&a.code.toString()==c.ERROR_INFO_CODE&&(t="info");var n=s.translation.ATTENTION_MODAL_TITLE,i=a.message;r.openModal(t,n,i,e,function(){e.modal.hide()})})}function u(){a.debug("reseteando Registro"),e.forms.registerForm.rut.$viewValue="",e.forms.registerForm.rut.$render(),e.forms.registerForm.names.$viewValue="",e.forms.registerForm.names.$render(),e.forms.registerForm.lastName.$viewValue="",e.forms.registerForm.lastName.$render(),e.forms.registerForm.motherLastName.$viewValue="",e.forms.registerForm.motherLastName.$render(),e.forms.registerForm.phone.$viewValue="",e.forms.registerForm.phone.$render(),e.forms.registerForm.cellphone.$viewValue="",e.forms.registerForm.cellphone.$render(),e.forms.registerForm.email.$viewValue="",e.forms.registerForm.email.$render(),e.forms.registerForm.numClient.$viewValue="",e.forms.registerForm.numClient.$render(),e.forms.registerForm.numLastService.$viewValue="",e.forms.registerForm.numLastService.$render(),e.forms.registerForm.password.$viewValue="",e.forms.registerForm.password.$render(),e.forms.registerForm.passwordConfirm.$viewValue="",e.forms.registerForm.passwordConfirm.$render(),e.forms.registerForm.$setPristine()}e.forms={},e.validateForm=function(){e.forms.registerForm.$valid?(a.debug("datos correctos"),m()):a.debug("formulario incorrecto")},e.sendAnalytics=function(e,a){l.evento(e,a)},e.$on("$locationChangeSuccess",function(e,t){t.indexOf("guest/register")>-1&&(l.pantalla(s.translation.PAGE_REGISTER),d.scrollTop(),a.debug("llamando a resetForm Registro"),u())})}]),angular.module("AccessModule").controller("loginCtrl",["$scope","$state","$ionicPlatform","$rootScope","$log","AccessService","$rootScope","AnalyticsService","PopupService","$ionicLoading","UTILS_CONFIG","UtilsService","NotificationService","$sce","ENDPOINTS","$ionicScrollDelegate",function(e,a,t,o,n,s,o,r,i,c,l,d,m,u,E,_){function g(){n.debug("reseteando login"),e.forms.loginForm?(e.forms.loginForm.rut.$viewValue="",e.forms.loginForm.password.$viewValue="",e.forms.loginForm.rut.$render(),e.forms.loginForm.password.$render(),e.forms.loginForm.$setPristine()):n.debug("no existe formulario aun")}e.forms={},e.xidDevice=o.xidDevice,e.sendAnalytics=function(e,a){r.evento(e,a)},e.validateForm=function(){if(r.evento(o.translation.PAGE_LOGIN,o.translation.GA_PUSH_ENTER),e.forms.loginForm.$valid){n.debug("datos correctos");var u=e.forms.loginForm.rut.$viewValue,E=0;E=u.indexOf("-")>-1?u.indexOf("-"):u.length-1;var _=u.substring(0,E),g=_+"-"+u.substr(u.length-1),S=e.forms.loginForm.password.$viewValue;c.show({template:l.STYLE_IONICLOADING_TEMPLATE});var A="";A=t.is("ios")?"IOS":t.is("android")?"ANDROID":"WEB",g=g.toUpperCase(),s.getLoginServices(g,S,A).then(function(s){n.debug("response login: ",s),c.hide(),o.isLogged=!0;var r="";t.is("ios")?r="ios":t.is("android")&&(r="android"),d.setXID(e.xidDevice,r),m.getNotificationList(),a.go("session.usage")},function(a){r.evento(o.translation.PAGE_LOGIN,o.translation.GA_ERROR_SERVICES_RESPONSE+"-"+o.translation.LOGIN+"-"+a.message+"-"+a.analyticsCode),n.error(a),c.hide();var t="error";a.code&&a.code.toString()==l.ERROR_INFO_CODE&&(t="info");var s=o.translation.ATTENTION_MODAL_TITLE,d=a.message;i.openModal(t,s,d,e)})}else n.debug("formulario incorrecto")},e.closeModal=function(){e.modal.hide()},e.recoveryPassNeol=function(){r.evento(o.translation.PAGE_LOGIN,o.translation.GA_PUSH_PASSWORD_RECOVERY);var a=o.translation.HELPER_MODAL_TITLE,t=u.trustAsResourceUrl(E.ENDPOINTS_EXTERNAL_RECOVERY_PASS_NEOL);c.show({template:l.STYLE_IONICLOADING_TEMPLATE}),i.openModal("iframe",a,t,e)},e.goBack=function(){r.evento(o.translation.PAGE_LOGIN,o.translation.GA_PUSH_BACK_BUTTON),a.go("guest.home")},e.$on("$locationChangeSuccess",function(e,a){a.indexOf("guest/login")>-1&&(n.debug("llamando a resetForm Login"),r.pantalla(o.translation.PAGE_LOGIN),_.scrollTop(),g())})}]),angular.module("AccessModule").controller("homeCtrl",["$scope","$state","$ionicLoading","AccessService","DataMapService","$rootScope","$log","LocalStorageProvider","ENDPOINTS","$sce","PopupService","AnalyticsService","UTILS_CONFIG","BillsService","$ionicScrollDelegate",function(e,a,t,o,n,s,r,i,c,l,d,m,u,E,g){function S(){r.debug("reseteando Home");var a=i.getLocalStorageItem("no_session_client_number");e.forms.homeForm?(a&&!s.isLogged?e.forms.homeForm.clientNum.$setViewValue(a):e.forms.homeForm.clientNum.$viewValue="",e.forms.homeForm.$setPristine(),e.forms.homeForm.clientNum.$render()):r.debug("no existe formulario aun")}s.isReportNotLogged=!1,e.buttons={chosen:""},e.sendAnalytics=function(e,a){m.evento(e,a)},e.forms={},e.validateForm=function(){if(e.forms.homeForm.$valid){var c=e.buttons.chosen;r.debug("item: ",c);var l=e.forms.homeForm.clientNum.$viewValue,g=0;g=l.indexOf("-")>-1?l.indexOf("-"):l.length-1;var S=l.substring(0,g),A=S+"-"+l.substr(l.length-1);switch(t.show({template:u.STYLE_IONICLOADING_TEMPLATE}),c){case"payButton":m.evento(s.translation.PAGE_HOME,s.translation.GA_PUSH_PAY_BILL),E.paymentStatus(S).then(function(c){if("N"===c.paymentInProgress.toUpperCase())o.getDebtData(S).then(function(o){var c={},l={};l=_.find(o,function(e){return e.tipoDeuda===u.PAYMENT_PAYMENTTYPE_1}),_.isEmpty(l)||(c=l),l=_.find(o,function(e){return e.tipoDeuda===u.PAYMENT_PAYMENTTYPE_2}),_.isEmpty(l)||(c=l),l=_.find(o,function(e){return e.tipoDeuda===u.PAYMENT_PAYMENTTYPE_3}),_.isEmpty(l)||(c=l);var m=parseInt(c.monto,10);if(r.debug("valor a pagar: ",m),null!=c.monto&&"0"!=c.monto&&m>0){t.hide();var E={};E.numeroSuministro=S,E.numeroSuministroDv=A,E.direccion=c.direccion,E.comuna="",c.comuna&&(E.comuna=c.comuna),E.items=o,E.index=0,n.setItem("payBillObject",E),s.isLogged||i.setLocalStorageItem("no_session_client_number",A),a.go("guest.payBill")}else{r.debug("Error: ammount is null or 0"),t.hide();var g=s.translation.ATTENTION_MODAL_TITLE,T=s.translation.NO_ACTIVE_DEBT;d.openModal("info",g,T,e)}},function(a){m.evento(s.translation.PAGE_HOME,s.translation.GA_ERROR_SERVICES_RESPONSE+"-"+s.translation.GET_DEBT+"-"+a.message+"-"+a.analyticsCode),r.error("Error: ",a),t.hide();var o="error";a.code&&a.code.toString()==u.ERROR_INFO_CODE&&(o="info");var n=s.translation.ATTENTION_MODAL_TITLE,i=a.message;d.openModal(o,n,i,e)});else{var l=s.translation.ATTENTION_MODAL_TITLE,E=s.translation.PAYMENT_IN_PROGRESS;d.openModal("info",l,E,e,function(){e.modal.remove().then(function(){e.modal=null})})}},function(a){m.evento(s.translation.PAGE_HOME,s.translation.GA_ERROR_SERVICES_RESPONSE+"-"+s.translation.PAYMENT_IN_PROGRESS+"-"+a.message+"-"+a.analyticsCode);var t="error";a.code&&a.code.toString()==u.ERROR_INFO_CODE&&(t="info");var o=s.translation.ATTENTION_MODAL_TITLE,n=a.message;d.openModal(t,o,n,e,function(){e.modal.remove().then(function(){e.modal=null})})});break;case"reportButton":m.evento(s.translation.PAGE_HOME,s.translation.GA_PUSH_BLACKOUT_REPORT),o.getCommercialData(S).then(function(e){r.debug("no tiene corte"),t.hide(),n.setItem("uniqueAsset","home");var o={};o.index=0,o.direccion=e.direccion,o.comuna="",e.comuna&&(o.comuna=e.comuna),o.numeroSuministro=e.numeroSuministro,o.numeroSuministroDv=e.numeroSuministro+"-"+e.digitoVerificador,n.setItem("reportBlackoutObject",o),s.isReportNotLogged=!0,r.debug("isReportNotLogged: "+s.isReportNotLogged),s.isLogged||i.setLocalStorageItem("no_session_client_number",A),a.go("guest.blackout")},function(a){m.evento(s.translation.PAGE_HOME,s.translation.GA_ERROR_SERVICES_RESPONSE+"-"+s.translation.REPORT_EMERGENCY+"-"+a.message+"-"+a.analyticsCode),r.error("Error: ",a),t.hide();var o="error";a.code&&a.code.toString()==u.ERROR_INFO_CODE&&(o="info");var n=s.translation.ATTENTION_MODAL_TITLE,i=a.message;d.openModal(o,n,i,e)})}}else r.debug("formulario incorrecto")},e.searchClientId=function(){m.evento(s.translation.PAGE_HOME,s.translation.GA_PUSH_SEARCH_CLIENT);var a=s.translation.HELPER_MODAL_TITLE,o=l.trustAsResourceUrl(c.ENDPOINTS_EXTERNAL_SEARCH_CLIENTID);t.show({template:u.STYLE_IONICLOADING_TEMPLATE}),d.openModal("iframe",a,o,e)},e.helpModal=function(){m.evento(s.translation.PAGE_HOME,s.translation.GA_PUSH_HELP_CLIENT_NUMBER);var a=s.translation.HELPER_MODAL_TITLE,t=u.IMAGE_ASSET_MODAL_HELP;d.openModal("help",a,t,e)},e.closeModal=function(){e.modal.remove().then(function(){e.modal=null})},e.login=function(){m.evento(s.translation.PAGE_HOME,s.translation.GA_PUSH_LOGIN),a.go("guest.login")},e.registerNeol=function(){m.evento(s.translation.PAGE_HOME,s.translation.GA_PUSH_REGISTER);var a=s.translation.HELPER_MODAL_TITLE,o=l.trustAsResourceUrl(c.ENDPOINTS_EXTERNAL_REGISTER_NEOL);t.show({template:u.STYLE_IONICLOADING_TEMPLATE}),d.openModal("iframe",a,o,e)},e.$on("$locationChangeSuccess",function(e,a){a.indexOf("guest/home")>-1&&(m.pantalla(s.translation.PAGE_HOME),g.scrollTop(),r.debug("llamando a resetForm Home"),S())})}]),angular.module("appenel").value("UTILS_CONFIG",{PAYMENT_TEMPLATE:"<Pagar><banco></banco><tipoPago></tipoPago><monto></monto><fechaVencimiento></fechaVencimiento><fechaEmision></fechaEmision><fechaOnClick></fechaOnClick><codigoBarra></codigoBarra><empresa></empresa><nombre></nombre><rut></rut><mail></mail></Pagar>",PAYMENT_ID_BANK:"4",PAYMENT_ENTERPRISE:"1",PAYMENT_PAYMENTTYPE_1:"DV",PAYMENT_PAYMENTTYPE_2:"UD",PAYMENT_PAYMENTTYPE_3:"DA",PAYMENT_RRSS_IMAGE:'<img src="img/dummy/rrss.png" alt="help" class="width-full-size"/>',CONTACT_PHONE_NUMER:"6006960000",CONTACT_CODE_BRANCHES:"01",CONTACT_CODE_PAYMENT_PLACES:"02",BLACKOUT_TYPE_PROBLEM_CODE_1:"3S0389",BLACKOUT_TYPE_PROBLEM_CODE_2:"5D0289",RELATIONSHIP_WITH_ASSET_CODE_1:"1",RELATIONSHIP_WITH_ASSET_CODE_2:"2",USAGE_TYPE_RATE_1:"BT1",USAGE_TYPE_RATE_2:"THR",USAGE_TYPE_RATE_TYPE_CODE_1:"ACTS",USAGE_TYPE_RATE_TYPE_CODE_2:"ACTI",USAGE_TYPE_RATE_TYPE_CODE_3:"ACLL",USAGE_TYPE_RATE_TYPE_CODE_4:"ACVA",USAGE_TYPE_RATE_TYPE_CODE_5:"ACHP",USAGE_TYPE_RATE_TYPE_CODE_6:"DMFP",USAGE_TYPE_RATE_TYPE_CODE_7:"DMHP",USAGE_TYPE_RATE_TYPE_CODE_8:"NMET",USAGE_TYPE_RATE_TYPE_CODE_9:"REAC",STYLE_IONICLOADING_TEMPLATE:'<img src="img/logos/enel_loading.gif" width="40" class="spinner"/>',STYLE_LOADING_SPINNER:'<ion-spinner icon="spiral" class="spinner-energized"></ion-spinner>',IMAGE_ASSET_MODAL_HELP:'<img src="img/help/enel_help.png" alt="help" class="width-full-size" />',ENABLE_ENCRYPTION_LOCALSTORAGE:!0,SECRET_KEY_ENCRYPTION:"Enel2017-*",TESTFAIRY_SECRET_KEY:"5bd10c0da3a67fda56ea3218175f260b96f49d0b",SUCCESS_CODE:"200",ERROR_GENERAL_CODE:"400",ERROR_INFO_CODE:"402",ERROR_SESSION_ID_CODE:"",ERROR_NO_CONTROLED_CODE:"-1",GOOGLE_MAPS_RESTRICTED_COUNTRY:"CL",GOOGLE_MAPS_KEY:"AIzaSyC7HeHcqS0r6p7vbGvSeb9-y4Pycwi0YpI",GOOGLE_MAPS_TYPE_MAP:"roadmap",GOOGLE_MAPS_INIT_ZOOM:"11",GOOGLE_MAPS_SEARCH_ZOOM:"15",GOOGLE_MAPS_GOOGLE_STATIC_ZOOM:"18",NOTIFICATION_ICON_IMAGE:'<img src="img/logos/logo_e.png" alt="notification-image" width="40" class="notification-image" />',NOTIFICATION_UPDATE_TYPE_01:"read",NOTIFICATION_UPDATE_TYPE_02:"delete",NOTIFICATION_STATUS_NOTIFICATION_01:"Completed",NOTIFICATION_STATUS_NOTIFICATION_02:"Rejected",NOTIFICATION_STATUS_NOTIFICATION_03:"Realizado"}),angular.module("appenel").value("SALESFORCE_CONFIG",{appId:"3MVG93MGy9V8hF9NNz4lFSyFA._i3WssncyfrM_RLGx936vLCL1WRYYuIZS8tK8eYhaqEy0sFq.uBm.xSlo7q",apiVersion:"v33.0",
loginURL:"",useProxy:!0,useCordova:!1,oauthCallbackURL:"",proxyURL:"",accessToken:"",oauthPlugin:!1,networkPlugin:!1}),angular.module("appenel").value("ENDPOINTS",{SETUP:{TIMEOUT:6e4,TIMEOUT_SESSION:6e4,APP_NAME:"",API_KEY:"",CLIENT_SECRET:"",PREPAID_ACCESS_TOKEN:"",COLIVING_ACCESS_TOKEN:""},ENDPOINTS_SALESFORCE:"https://enelsud.force.com/Appenel",ENDPOINTS_BASE_EXTERNAL:"https://enelsudsite.secure.force.com",ENDPOINTS_GET_CONTACT_ID:"/services/apexrest/GetContactIdAuth/",ENDPOINTS_ASSESTS_LIST:"/services/apexrest/GetSupplyAuth/",ENDPOINTS_ASSET_DETAIL:"/services/apexrest/DetailSupply/",ENDPOINTS_ASSET_DEBT:"/services/apexrest/GetDebtAuth/",ENDPOINTS_GET_BILLS:"/services/apexrest/GetTicketAuth/",ENDPOINTS_GET_PAYMENTS:"/services/apexrest/GetPaymentAuth/",ENDPOINTS_ENTER_READING:"/services/apexrest/EnterReadingAuth/",ENDPOINTS_EMERGENCY_LIGHTING_PROBLEM:"/services/apexrest/EmergencyLightingProblemAuth/",ENDPOINTS_EMERGENCY_BLACKOUT:"/services/apexrest/EmergencyLightCutAuth/",ENDPOINTS_EMERGENCY_RISK_ACCIDENT:"/services/apexrest/EmergencyRiskAccidentAuth/",ENDPOINTS_CONSUMPTION:"/services/apexrest/ConsumptionAuth/",ENDPOINTS_SETCONTACT:"/services/apexrest/SetContactAuth/",ENDPOINTS_EDIT_USER:"/services/apexrest/EditUserAuth/",ENDPOINTS_PASSWORD_CHANGE:"/services/apexrest/ChangeOwnPasswordsAuth/",ENDPOINTS_ASSET_PROOF_OF_DEBT:"/services/apexrest/ProofOfDebtAuth/",ENDPOINTS_ASSET_PAYMENT_STATUS:"/services/apexrest/PaymentStatusAuth/",ENDPOINTS_GET_BILL_BY_DATE:"/services/apexrest/CopyReceiptAuth/",ENDPOINTS_NOTIFICATION_LIST:"/services/apexrest/GetNotifications/",ENDPOINTS_UPDATE_NOTIFICATION:"/services/apexrest/UpdateNotifications/",ENDPOINTS_REGISTER_XID_DEVICE:"/services/apexrest/SetXID/",ENDPOINTS_ADD_ASSET:"/services/apexrest/SupplyAssociacionAuth/",ENDPOINTS_GET_USER_SESSION:"/services/apexrest/GetSessionInfoNeol/",ENDPOINTS_BRACNHES:"/services/apexrest/GetBranches/",ENDPOINTS_FEATURED:"/services/apexrest/GetFeaturedBranches/",ENDPOINTS_COMMERCIAL_DATA:"/services/apexrest/GetBusinessData/",ENDPOINTS_DEBT_DATA:"/services/apexrest/GetDebt/",ENDPOINTS_GET_STATES:"/services/apexrest/GetCommunes/",ENDPOINTS_GET_ASSET_DEBT:"/services/apexrest/GetDebt/",ENDPOINTS_EXTERNAL_EMERGENCY_LIGHTING_PROBLEM:"/services/apexrest/EmergencyLightingProblem/",ENDPOINTS_EXTERNAL_EMERGENCY_RISK_ACCIDENT:"/services/apexrest/EmergencyRiskAccident/",ENDPOINTS_EXTERNAL_EMERGENCY_BLACKOUT:"/services/apexrest/EmergencyLightCut/",ENDPOINTS_EXTERNAL_SETCONTACT:"/services/apexrest/SetContact/",ENDPOINTS_EXTERNAL_SUBJECT:"/services/apexrest/SubjectsType/",ENDPOINTS_BLACKOUT_PROBLEMS_LIST:"/services/apexrest/ProblemsTypeLightCut/",ENDPOINTS_LIGHTING_PROBLEMS_LIST:"/services/apexrest/ProblemsTypeStreetLighting/",ENDPOINTS_RISK_ACCIDENT_PROBLEMS_LIST:"/services/apexrest/ProblemsTypeEmergencyRisk/",ENDPOINTS_EXTERNAL_CHANGE_PASS:"/services/apexrest/ChangeOwnPasswords/",ENDPOINTS_EXTERNAL_CODE_REQUEST:"/services/apexrest/Recoverykey/",ENDPOINTS_EXTERNAL_REGISTRY_USER:"/services/apexrest/RegistryUser/",ENDPOINTS_EXTERNAL_ACTIVATE_ACCOUNT:"/services/apexrest/ActivateAccount/",ENDPOINTS_EXTERNAL_ASSET_PROOF_OF_DEBT:"/services/apexrest/ProofOfDebt/",ENDPOINTS_EXTERNAL_ASSET_PAYMENT_STATUS:"/services/apexrest/PaymentStatus/",ENDPOINTS_EXTERNAL_RELATIONSHIP_WITH_ASSET:"/services/apexrest/GetTypeRelationShip/",ENDPOINTS_EXTERNAL_SEARCH_CLIENTID:"https://www.enel-digital.cl/numero-cliente",ENDPOINTS_EXTERNAL_REGISTER_NEOL:"https://www.eneldistribucion.cl/residencial/registro-de-usuario",ENDPOINTS_EXTERNAL_RECOVERY_PASS_NEOL:"https://www.eneldistribucion.cl/Hogares/rememberPass.html",ENDPOINTS_PAYMENT:"https://webpay3g.enel.com/bdp/TraductorPage.aspx",ENDPOINTS_PAYMENT_SUCCESS:"TraductorSalidaPage.aspx?exito=true",ENDPOINTS_PAYMENT_ERROR:"TraductorSalidaPage.aspx?exito=false",ENDPOINTS_ANALYTICS:"https://www.google-analytics.com/collect",ENDPOINTS_GOOGLE_STATICS_MAP:"https://maps.googleapis.com/maps/api/staticmap",ENDPOINTS_FACEBOOK:"https://www.facebook.com/EnelChile",ENDPOINTS_TWITTER:"https://twitter.com/EnelClientesCL"}),angular.module("appenel").value("ANALYTICS_CONFIG",{ID_ANALYTICS:"UA-64690741-2",APP_NAME:"ENEL-CHILE",APP_ID:"ENEL-CHILE"}),angular.module("appenel").config(["$stateProvider","$urlRouterProvider",function(e,a){e.state("tutorial",{url:"/tutorial",templateUrl:"views/Core/tutorial.html",controller:"tutorialCtrl"}).state("guest",{url:"/guest",templateUrl:"views/Core/Footers/guestFooter.html",abstract:!0,controller:"footerCtrl"}).state("guest.home",{url:"/home",views:{"tab-home":{templateUrl:"views/Access/home.html",controller:"homeCtrl"}}}).state("guest.login",{url:"/login",cache:!1,views:{"tab-home":{templateUrl:"views/Access/login.html",controller:"loginCtrl"}}}).state("guest.register",{url:"/register",views:{"tab-home":{templateUrl:"views/Access/register.html",controller:"registerCtrl"}}}).state("guest.validation",{url:"/validation",views:{"tab-home":{templateUrl:"views/Access/validation.html",controller:"validationCtrl"}}}).state("guest.verificationStepOne",{url:"/verificationStepOne",views:{"tab-home":{templateUrl:"views/Access/verificationStepOne.html",controller:"verificationStepOneCtrl"}}}).state("guest.verificationStepTwo",{url:"/verificationStepTwo",views:{"tab-home":{templateUrl:"views/Access/verificationStepTwo.html",controller:"verificationStepTwoCtrl"}}}).state("guest.payBill",{url:"/payBill",views:{"tab-home":{templateUrl:"views/Bills/payBill.html",controller:"payBillCtrl"}}}).state("guest.emergencyMenu",{url:"/emergencyMenu",views:{"tab-emergency":{templateUrl:"views/Emergency/emergencyMenu.html",controller:"emergencyMenuCtrl"}}}).state("guest.lightingProblems",{url:"/lightingProblems",views:{"tab-emergency":{templateUrl:"views/Emergency/lightingProblems.html",controller:"lightingProblemsCtrl"}}}).state("guest.blackout",{url:"/blackout",views:{"tab-emergency":{templateUrl:"views/Emergency/blackout.html",controller:"blackoutCtrl"}}}).state("guest.preBlackout",{url:"/preBlackout",views:{"tab-emergency":{templateUrl:"views/Emergency/preBlackout.html",controller:"preBlackoutCtrl"}}}).state("guest.accidentRisk",{url:"/accidentRisk",views:{"tab-emergency":{templateUrl:"views/Emergency/accidentRisk.html",controller:"accidentRiskCtrl"}}}).state("guest.contactMenu",{url:"/contactMenu",views:{"tab-contact":{templateUrl:"views/Contact/contactMenu.html",controller:"contactMenuCtrl"}}}).state("guest.contactForm",{url:"/contactForm",views:{"tab-contact":{templateUrl:"views/Contact/contactForm.html",controller:"contactFormCtrl"}}}).state("guest.branchesMap",{url:"/branchesMap",views:{"tab-contact":{templateUrl:"views/Contact/branchesMap.html",controller:"branchesMapCtrl"}}}).state("guest.branchesList",{url:"/branchesList",views:{"tab-contact":{templateUrl:"views/Contact/branchesList.html",controller:"branchesListCtrl"}}}).state("guest.branchesDescription",{url:"/branchesDescription",views:{"tab-contact":{templateUrl:"views/Contact/branchesDescription.html",controller:"branchesDescriptionCtrl"}}}).state("guest.paymentOptions",{url:"/paymentOptions",views:{"tab-contact":{templateUrl:"views/Contact/paymentOptions.html",controller:"paymentOptionsCtrl"}}}).state("guest.featuredList",{url:"/featuredList",views:{"tab-featured":{templateUrl:"views/Featured/featuredList.html",controller:"featuredListCtrl"}}}).state("guest.featuredDescription",{url:"/featuredDescription",views:{"tab-featured":{templateUrl:"views/Featured/featuredDescription.html",controller:"featuredDescriptionCtrl"}}}).state("session",{url:"/session",abstract:!0,templateUrl:"views/Core/Footers/sessionFooter.html",controller:"footerCtrl"}).state("session.usage",{url:"/usage",views:{"tab-usage":{templateUrl:"views/Usage/mainContainer.html",controller:"usageCtrl"}}}).state("session.enterReading",{url:"/enterReading",views:{"tab-usage":{templateUrl:"views/Bills/enterReading.html",controller:"enterReadingCtrl"}}}).state("session.payBill",{url:"/payBill",views:{"tab-usage":{templateUrl:"views/Bills/payBill.html",controller:"payBillCtrl"}}}).state("session.sendElectronicDoc",{url:"/sendElectronicDoc",views:{"tab-usage":{templateUrl:"views/ManageAssets/sendElectronicDoc.html",controller:"sendElectronicDocCtrl"}}}).state("session.emergencyMenu",{url:"/emergencyMenu",views:{"tab-emergency":{templateUrl:"views/Emergency/emergencyMenu.html",controller:"emergencyMenuCtrl"}}}).state("session.lightingProblems",{url:"/lightingProblems",views:{"tab-emergency":{templateUrl:"views/Emergency/lightingProblems.html",controller:"lightingProblemsCtrl"}}}).state("session.blackout",{url:"/blackout",views:{"tab-emergency":{templateUrl:"views/Emergency/blackout.html",controller:"blackoutCtrl"}}}).state("session.accidentRisk",{url:"/accidentRisk",views:{"tab-emergency":{templateUrl:"views/Emergency/accidentRisk.html",controller:"accidentRiskCtrl"}}}).state("session.contactMenu",{url:"/contactMenu",views:{"tab-contact":{templateUrl:"views/Contact/contactMenu.html",controller:"contactMenuCtrl"}}}).state("session.contactForm",{url:"/contactForm",views:{"tab-contact":{templateUrl:"views/Contact/contactForm.html",controller:"contactFormCtrl"}}}).state("session.branchesMap",{url:"/branchesMap",views:{"tab-contact":{templateUrl:"views/Contact/branchesMap.html",controller:"branchesMapCtrl"}}}).state("session.branchesList",{url:"/branchesList",views:{"tab-contact":{templateUrl:"views/Contact/branchesList.html",controller:"branchesListCtrl"}}}).state("session.branchesDescription",{url:"/branchesDescription",views:{"tab-contact":{templateUrl:"views/Contact/branchesDescription.html",controller:"branchesDescriptionCtrl"}}}).state("session.paymentOptions",{url:"/paymentOptions",views:{"tab-contact":{templateUrl:"views/Contact/paymentOptions.html",controller:"paymentOptionsCtrl"}}}).state("session.notification",{url:"/notification",views:{"tab-notification":{templateUrl:"views/Notification/notificationList.html",controller:"notificationCtrl"}}}).state("session.featuredList",{url:"/featuredList",views:{"tab-featured":{templateUrl:"views/Featured/featuredList.html",controller:"featuredListCtrl"}}}).state("session.featuredDescription",{url:"/featuredDescription",views:{"tab-featured":{templateUrl:"views/Featured/featuredDescription.html",controller:"featuredDescriptionCtrl"}}}).state("session.profile",{url:"/profile",views:{profile:{templateUrl:"views/Core/profile.html",controller:"profileCtrl"}}})}]),angular.module("appenel").config(["$provide",function(e){e.decorator("$interval",["$delegate","$rootScope",function(e,a,t){var o=function(){var t=arguments,o=Function.prototype.bind.call(e),n=o.apply(e,t);a.$on("$App.pause",function(){e.cancel(n)}),a.$on("$App.resume",function(){o=Function.prototype.bind.call(e),n=o.apply(e,t)})};return o.cancel=e.cancel,o}])}]).config(["$provide",function(e){e.decorator("numberFilter",["$delegate","$locale",function(e){return function(a,t){var o=parseFloat(a,t);return _.isNaN(o)?_.isString(a)?a:void 0:e(a,t)}}])}]).config(["$provide",function(e){e.decorator("dateFilter",["$delegate",function(e){return function(e,a,t){var o=moment().utcOffset();if(t||(o=moment().utcOffset())<=0&&(o*=-1),"string"==typeof e&&e.indexOf("/")>=0){var n=moment(e.replace(/\//g,"-"),"DD/MM/YYYY").utcOffset(o).format(a);return"Invalid Date"!=n?n:e}var s=moment(new Date(e)).utcOffset(o).format(a);return"Invalid Date"!=moment(s).utcOffset(o)&&"Invalid Date"==(s=new Date(e))?e:moment(s).utcOffset(o).format(a)}}])}]).config(["$provide",function(e){e.decorator("$log",["$delegate",function(e){return e.info=function(){},e.debug=function(){},e.error=function(){},e.warn=function(){},e.log=function(){},e.error=function(){},e.trace=function(){},e.fatal=function(){},e.group=function(e){},e.groupCollapsed=function(e){},e.groupEnd=function(){},e}])}]).config(["$logProvider",function(e){e.debugEnabled(!1)}]).config(["$ionicConfigProvider",function(e){e.tabs.position("bottom")}]).config(["ChartJsProvider",function(e){e.setOptions({chartColors:["#0555fa","#cecece","#ff4687"],maintainAspectRatio:!1})}]).config(["notificationsConfigProvider",function(e){e.setAutoHide(!0),e.setHideDelay(5e3),e.setAcceptHTML(!0),e.setAutoHideAnimation("fadeOutNotifications"),e.setAutoHideAnimationDelay(1200)}]),angular.module("appenel").run(["$rootScope","$log","$ionicPlatform","$state","$window","SALESFORCE_CONFIG","translation_es","LocalStorageProvider","ContactService","UTILS_CONFIG","ENDPOINTS","$cordovaPush","notifications","NotificationService","UtilsService",function(e,a,t,o,n,s,r,i,c,l,d,m,u,E,_){e.translation=r,e.isLogged=!1,a.debug("$rootScope.isLogged: "+e.isLogged),e.isMovilDevice=!1,e.showRotateIcon=!0,e.xidDevice="",e.appVersion="1.0",_.manageLocalStorageWhenRunApp(),s.loginURL=d.ENDPOINTS_SALESFORCE,s.proxyURL=d.ENDPOINTS_SALESFORCE,i.getLocalStorageItem("SALESFORCE_CONFIG")?force.init(i.getLocalStorageItem("SALESFORCE_CONFIG")):force.init(s),t.ready(function(){function s(e){document.body.classList.add("keyboard-open-android")}function r(e){document.body.classList.remove("keyboard-open-android")}try{TestFairy.begin(l.TESTFAIRY_SECRET_KEY),a.debug("TestFairy initialized. API Key::",l.TESTFAIRY_SECRET_KEY)}catch(e){a.debug("TestFairy is not defined for this Platform")}window.cordova&&window.cordova.plugins&&window.cordova.plugins.Keyboard&&(cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!1),cordova.plugins.Keyboard.disableScroll(!1),t.is("android")&&(window.addEventListener("native.keyboardshow",s),window.addEventListener("native.keyboardhide",r))),n.StatusBar&&StatusBar.styleDefault(),navigator.geolocation.getCurrentPosition(function(e){a.debug("position adquired")}),i.getLocalStorageItem("branches")||c.getBranchesItems().then(function(e){}),n.cordova&&cordova.getAppVersion.getVersionNumber().then(function(t){a.debug("version: ",t),e.appVersion=t,_.manageLocalStorageWhenUpdateApp(t)});try{e.push=PushNotification.init({android:{senderID:"384369609407",icon:"notification_push"},browser:{pushServiceURL:"http://push.api.phonegap.com/v1/push"},ios:{senderID:"384369609407",gcmSandbox:!0,alert:"true",badge:"true",sound:"true"}}),e.push.on("registration",function(o){if(a.debug("registrationId: "+o.registrationId),e.xidDevice=o.registrationId,force.isAuthenticated()){var n="";t.is("ios")?n="ios":t.is("android")&&(n="android"),_.setXID(e.xidDevice,n)}}),e.push.on("notification",function(a){E.getNotificationList(),u.closeAll(),e.$apply(),u.showSuccess({message:'<div class="row padding-top-10" ui-sref="session.notification"><div class="col-20 position-rel">'+l.NOTIFICATION_ICON_IMAGE+'</div><div class="col-80 position-rel"><h4 class="notification-title">'+a.title+'</h4><p class="notification-message">'+a.message+"</p></div></div>"}),e.$apply()}),e.push.on("error",function(e){a.error(e.message)}),_.setBadgeNumber(0)}catch(e){a.error("Error al set PushID: ",e)}a.debug("autenticated: ",force.isAuthenticated()),i.getLocalStorageItem("pass_tuto")?force.isAuthenticated()?(e.isLogged=!0,E.getNotificationList(),i.getLocalStorageItem("push_notification")?(i.removeLocalStorageItem("push_notification"),o.go("session.notification")):o.go("session.usage")):(e.isLogged=!1,o.go("guest.home")):o.go("tutorial")}),t.on("pause",function(t){a.debug("Pause Fired"),_.manageLocalStorageWhenPauseApp(),force.isAuthenticated()&&(e.isLogged=!0)}),t.on("resume",function(t){if(a.debug("Resume Fired"),force.isAuthenticated()){if(e.isLogged=!0,s.loginURL=d.ENDPOINTS_SALESFORCE,s.proxyURL=d.ENDPOINTS_SALESFORCE,i.getLocalStorageItem("USER_DATA",!1)){var n=i.getLocalStorageItem("USER_DATA",!1);s.accessToken=n.sessionId,i.setLocalStorageItem("SALESFORCE_CONFIG",s)}force.init(s),i.getLocalStorageItem("push_notification")&&(i.removeLocalStorageItem("push_notification"),o.go("session.notification"))}}),t.registerBackButtonAction(function(e){e.preventDefault()},100)}]);